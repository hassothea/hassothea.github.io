<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.358">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sothea HAS">

<title> GradientCobra Python Library</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="kernelsmoother_files/libs/clipboard/clipboard.min.js"></script>
<script src="kernelsmoother_files/libs/quarto-html/quarto.js"></script>
<script src="kernelsmoother_files/libs/quarto-html/popper.min.js"></script>
<script src="kernelsmoother_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="kernelsmoother_files/libs/quarto-html/anchor.min.js"></script>
<link href="kernelsmoother_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="kernelsmoother_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="kernelsmoother_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="kernelsmoother_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="kernelsmoother_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.27.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><img src="gradientcobra_logo.svg" class="img-fluid" style="width:1.38889in"> GradientCobra Python Library</h1>
            <p class="subtitle lead"><strong>Class <a href="https://link.springer.com/chapter/10.1007/978-0-387-84858-7_6">KernelSmoother</a></strong></p>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p><a href="https://hassothea.github.io/">Sothea HAS</a> </p>
                      </div>
          </div>
                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-kernel-smoothing-method" id="toc-introduction-to-kernel-smoothing-method" class="nav-link active" data-scroll-target="#introduction-to-kernel-smoothing-method">Introduction to Kernel Smoothing method</a></li>
  <li><a href="#kernelsmoother-method" id="toc-kernelsmoother-method" class="nav-link" data-scroll-target="#kernelsmoother-method">KernelSmoother method</a>
  <ul class="collapse">
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#returns" id="toc-returns" class="nav-link" data-scroll-target="#returns">Returns:</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods:</a></li>
  </ul></li>
  <li><a href="#installation-of-the-library-from-pypi" id="toc-installation-of-the-library-from-pypi" class="nav-link" data-scroll-target="#installation-of-the-library-from-pypi">Installation of the library from <code>pypi</code></a></li>
  <li><a href="#implementation-of-the-method" id="toc-implementation-of-the-method" class="nav-link" data-scroll-target="#implementation-of-the-method">Implementation of the method</a>
  <ul class="collapse">
  <li><a href="#importing-some-packages" id="toc-importing-some-packages" class="nav-link" data-scroll-target="#importing-some-packages">Importing some packages</a></li>
  <li><a href="#kernelsmoother-on-simulated-data" id="toc-kernelsmoother-on-simulated-data" class="nav-link" data-scroll-target="#kernelsmoother-on-simulated-data"><code>KernelSmoother</code> on simulated data</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a>
  <ul class="collapse">
  <li><a href="#read-also" id="toc-read-also" class="nav-link" data-scroll-target="#read-also">Read also:</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  

<section id="introduction-to-kernel-smoothing-method" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-kernel-smoothing-method">Introduction to <a href="https://link.springer.com/chapter/10.1007/978-0-387-84858-7_6">Kernel Smoothing</a> method</h2>
<p><code>Kernel Smoother</code> is a nonparametric method for estimations and predictions (<a href="https://link.springer.com/chapter/10.1007/978-0-387-84858-7_6">T. Hastie, 2009</a>).</p>
<p>Given observations <span class="math inline">\(\{(x_i,y_i),\dots, (x_n,y_n)\}\)</span>. The prediction by kernel smoothing method is defined by</p>
<p><span class="math display">\[\hat{y}(x)=\sum_{i=1}^nW_i(x)y_i=\sum_{i=1}^n\frac{K_h(\|x-x_i\|)}{\sum_{j=1}^nK_h(\|x-x_j\|)}y_i\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(K:\mathbb{R}_+\to\mathbb{R}_+\)</span> is a regular kernel function that converts the “closeness” between predicted features of observation <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x\)</span> into the associated weight for the aggregation. For any smoothing parameter <span class="math inline">\(h&gt;0\)</span>, <span class="math inline">\(K_h(t)=K(t/h)\)</span>.</li>
</ul>
<p>Constructing a kernel smoothing method is equivalent to estimating an appropriate smoothing parameter <span class="math inline">\(h\)</span> that minimizes the so-called <span class="math inline">\(\kappa\)</span>-fold cross validation error:</p>
<p><span class="math display">\[\phi(h)=\frac{1}{\kappa}\sum_{j=1}^{\kappa}\sum_{(x_i,y_i)\in F_j}\ell(\hat{y}_{-F_j}(x_i),y_i)\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\ell\)</span> is any regression loss function. By default, <span class="math inline">\(\ell(y_1,y_2)=(y_1-y_2)^2\)</span>.</li>
<li><span class="math inline">\((F_j)_{j=1,2,\dots,\kappa}\)</span> are the <span class="math inline">\(\kappa\)</span> folds of the second of the training data used for aggregation.</li>
<li><span class="math inline">\(\hat{y}_{-F_j}(x)\)</span> is the prediction of <span class="math inline">\(x\)</span> by aggregating predicted features on all folds <span class="math inline">\((F_k)_{k}\)</span> except for <span class="math inline">\(F_j\)</span>.</li>
</ul>
<hr>
</section>
<section id="kernelsmoother-method" class="level2">
<h2 class="anchored" data-anchor-id="kernelsmoother-method">KernelSmoother method</h2>
<p><code>class</code> <strong>KernelSmoother</strong>(<em>random_state = None, learning_rate = 0.01, bandwidth_list = None, speed = ‘constant’, opt_method = “grad”, max_iter = int(300), opt_params = None, kernel = ‘radial’, kernel_exponent = 1.0, show_progress = True, loss_function = None, loss_weight = None, norm_constant = None</em>):</p>
<p><code>KernelSmoother</code> is a <code>subclass</code> of <a href="https://hassothea.github.io/files/CodesPhD/GradientCOBRA.html"><code>GradientCOBRA</code></a>. T=In <code>KernelSmoother</code>, the input data <span class="math inline">\(X\)</span> are treated as predicted features and aggregated directly using super class method.</p>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">Parameters</h3>
<hr>
<ul>
<li><p><code>random_state</code>: (default is <code>None</code>) for setting the random state of all the random generators in the class. This allows the method to produce the same result when the same <code>random_state</code> is used.</p></li>
<li><p><code>learning_rate</code>: (default is <code>0.1</code>) the learning rate in gradient descent algorithm for estimating the optimal bandwidth.</p></li>
<li><p><code>bandwidth_list</code>: a list of bandwidth parameters for grid search algorithm (<code>default = np.linspace(0.00001, 10, 300)</code>).</p></li>
<li><p><code>speed</code>: (default is <code>constant</code>) for adjusting the speed of the learning rate. It is helpful when the cost function is flat around the optimal value, changing the learning speed might help the algorithm to converge faster. It should be an element of <em>[‘constant’, ‘linear’, ‘log’, ‘sqrt_root’, ‘quad’, ‘exp’]</em>.</p></li>
<li><p><code>opt_method</code>: (default is “<code>grad</code>”) is an optimization algorithm for estimating the bandwidth parameter. It should be either “<code>grid</code>” (grid search) or “<code>grad</code>” (gradient descent for non-compactly supported kernels).</p></li>
<li><p><code>max_iter</code>: (default = 100) maximum iteration of gradient descent algorithm.</p></li>
<li><p><code>opt_params</code>: (default is <code>None</code>) is a dictionary of additional parameters for the optimization algorithm (both grid search and gradient descent). Its should contain some of the following keys:</p>
<ul>
<li>‘<em>epsilon</em>’: stopping criterion for gradient descent algorithm (<code>default =</code> <span class="math inline">\(10^{-6}\)</span>).</li>
<li>‘<em>n_tries</em>’: the number of tries for selecting initial position of gradient descent algorithm (<code>default = 10</code>)</li>
<li>‘<em>start</em>’: the initial value of the bandwidth parameter (<code>default = None</code>)</li>
<li>‘<em>n_cv</em>’: number of cross-validation folds (<code>default = 10</code>)</li>
<li>‘precision’ : the precision to estimate the gradient for gradient descent algorithm (<code>default =</code> <span class="math inline">\(10^{-10}\)</span>).</li>
</ul></li>
<li><p><code>kernel</code>: (default is <code>'radial'</code>) the kernel function used for the aggregation. It should be an element of the list <em>[‘exponential’, ‘gaussian’, ‘radial’, ‘cauchy’, ‘reverse_cosh’,‘epanechnikov’,‘biweight’, ‘triweight’, ‘triangular’, ‘cobra’, ‘naive’]</em>. Some options such as <code>'gaussian'</code> and <code>'radial'</code> lead to the same radial kernel function. For <code>'cobra'</code> or <code>'naive'</code>.</p></li>
<li><p><code>kernel_exponent</code>: (default is <code>1.0</code>) is an exponential <span class="math inline">\(\alpha\)</span> of the exponential and radial kernel function i.e., <span class="math inline">\(K(x) = \exp(|x|^{2\alpha})\)</span>. By default, <code>alpha = 1.0</code>.</p></li>
<li><p><code>show_progress</code>: (default is <code>True</code>) a boolean defining whether or not to show the progress of the optimization algorithm for both grid search and gradient descent.</p></li>
<li><p><code>loss_function</code>: (default is <code>None</code>) a function or string defining the cost function to be optimized for estimating the optimal bandwidth parameter. By defalut, the K-Fold cross-validation MSE is used. Otherwise, it must be either:</p>
<ul>
<li>a function of two argumetns (y_true, y_pred) or</li>
<li>a string element of the list <em>[‘mse’, ‘mae’, ‘mape’, ‘weighted_mse’]</em>. If it is <code>weighted_mse</code>, one can define the weight for each training point using <code>loss_weight</code> argument below.
<ul>
<li><code>loss_weight</code>: (default is <code>None</code>) a list of size <span class="math inline">\(n\)</span> (number of training observations) defining the weight for each individual data point for the loss function. If it is <code>None</code> and the <code>loss_function = weighted_mse</code>, then a normalized weight <span class="math inline">\(W(i) = 1/\text{PDF}(i)\)</span> is assigned to the individual <span class="math inline">\(i\)</span> of the training data.</li>
</ul></li>
</ul></li>
<li><p><code>norm_constant</code>: (default is <code>None</code>) a normalized constant used to scale the features in optimization algorithm. By defalut, they are</p></li>
</ul>
</section>
<section id="returns" class="level3">
<h3 class="anchored" data-anchor-id="returns">Returns:</h3>
<hr>
<ul>
<li><code>self</code> : returns an instance of self containing the optimal estimated bandwidth and other results of the algorithm.</li>
</ul>
</section>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">Methods:</h3>
<p>All methods are inherited from <a href="https://hassothea.github.io/files/CodesPhD/GradientCOBRA.html"><code>GradientCOBRA</code></a> class.</p>
<hr>
</section>
</section>
<section id="installation-of-the-library-from-pypi" class="level2">
<h2 class="anchored" data-anchor-id="installation-of-the-library-from-pypi">Installation of the library from <code>pypi</code></h2>
<p><a href="https://pypi.org/project/gradientcobra/">gradientcobra</a> can be installed from <a href="https://pypi.org/">pypi</a> using <code>pip</code>:</p>
<blockquote class="blockquote">
<p><code>pip install gradientcobra</code></p>
</blockquote>
<hr>
</section>
<section id="implementation-of-the-method" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-the-method">Implementation of the method</h2>
<section id="importing-some-packages" class="level3">
<h3 class="anchored" data-anchor-id="importing-some-packages">Importing some packages</h3>
<div id="b0e32145" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Metric of error</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, mean_absolute_percentage_error</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting figures</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Import class KernelSmoother from the gradientcobra library</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gradientcobra.gradientcobra <span class="im">import</span> KernelSmoother</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kernelsmoother-on-simulated-data" class="level3">
<h3 class="anchored" data-anchor-id="kernelsmoother-on-simulated-data"><code>KernelSmoother</code> on simulated data</h3>
<p>We simulate a regression data with <span class="math inline">\(1000\)</span> observations and <span class="math inline">\(10\)</span> inputs variables.</p>
<div id="c2064ed3" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For simulating dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_regression</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>X1, y1 <span class="op">=</span> make_regression(n_samples<span class="op">=</span><span class="dv">1000</span>, n_features<span class="op">=</span><span class="dv">10</span>, noise<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s randomly split the simulated data into <span class="math inline">\(80\%-20\%\)</span> training-testing data.</p>
<div id="a2e335b4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>X_train1, X_test1, y_train1, y_test1 <span class="op">=</span> train_test_split(X1, y1, test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'shape: x_train = </span><span class="sc">{}</span><span class="st"> , x_train = </span><span class="sc">{}</span><span class="st"> , y_train = </span><span class="sc">{}</span><span class="st"> , y_test = </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    X_train1.shape, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    X_test1.shape, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    y_train1.shape, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    y_test1.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: x_train = (800, 10) , x_train = (200, 10) , y_train = (800,) , y_test = (200,)</code></pre>
</div>
</div>
<section id="bullet-kernelsmoother-with-default-parameters" class="level4">
<h4 class="anchored" data-anchor-id="bullet-kernelsmoother-with-default-parameters"><span class="math inline">\(\bullet\)</span> <code>KernelSmoother</code> with default parameters</h4>
<p>We create <code>KernelSmoother</code> object called <code>ker1</code> using <code>KernelSmoother</code> class with the default parameters, then fit it to the training data.</p>
<div id="e6f4614d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ker1 <span class="op">=</span> KernelSmoother()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ker1_fit <span class="op">=</span> ker1.fit(X_train1, y_train1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: -2111.973 / stop criter: 1.000 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   3%|▎         | 3/100 [00:00&lt;00:04, 24.19it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   3%|▎         | 3/100 [00:00&lt;00:04, 24.19it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -2111.973 / stop criter: 1056.003 :   3%|▎         | 3/100 [00:00&lt;00:04, 24.19it/s]* GD progress: iter: 5 / bw: 3.100 / grad: -2295.237 / stop criter: 1055.987 :   3%|▎         | 3/100 [00:00&lt;00:04, 24.19it/s]* GD progress: iter: 5 / bw: 3.100 / grad: -2295.237 / stop criter: 1055.987 :   3%|▎         | 3/100 [00:00&lt;00:04, 24.19it/s]* GD progress: iter: 6 / bw: 3.209 / grad: -1538.365 / stop criter: 1147.618 :   3%|▎         | 3/100 [00:00&lt;00:04, 24.19it/s]* GD progress: iter: 6 / bw: 3.209 / grad: -1538.365 / stop criter: 1147.618 :   3%|▎         | 3/100 [00:00&lt;00:04, 24.19it/s]* GD progress: iter: 6 / bw: 3.209 / grad: -1538.365 / stop criter: 1147.618 :   6%|▌         | 6/100 [00:00&lt;00:03, 24.00it/s]* GD progress: iter: 7 / bw: 3.282 / grad: -1924.174 / stop criter: 769.182 :   6%|▌         | 6/100 [00:00&lt;00:03, 24.00it/s] * GD progress: iter: 7 / bw: 3.282 / grad: -1924.174 / stop criter: 769.182 :   6%|▌         | 6/100 [00:00&lt;00:03, 24.00it/s]* GD progress: iter: 8 / bw: 3.373 / grad: -1436.175 / stop criter: 962.087 :   6%|▌         | 6/100 [00:00&lt;00:03, 24.00it/s]* GD progress: iter: 8 / bw: 3.373 / grad: -1436.175 / stop criter: 962.087 :   6%|▌         | 6/100 [00:00&lt;00:03, 24.00it/s]* GD progress: iter: 9 / bw: 3.441 / grad: -2102.048 / stop criter: 718.087 :   6%|▌         | 6/100 [00:00&lt;00:03, 24.00it/s]* GD progress: iter: 9 / bw: 3.441 / grad: -2102.048 / stop criter: 718.087 :   6%|▌         | 6/100 [00:00&lt;00:03, 24.00it/s]* GD progress: iter: 9 / bw: 3.441 / grad: -2102.048 / stop criter: 718.087 :   9%|▉         | 9/100 [00:00&lt;00:03, 23.65it/s]* GD progress: iter: 10 / bw: 3.540 / grad: -862.992 / stop criter: 1051.024 :   9%|▉         | 9/100 [00:00&lt;00:03, 23.65it/s]* GD progress: iter: 10 / bw: 3.540 / grad: -862.992 / stop criter: 1051.024 :   9%|▉         | 9/100 [00:00&lt;00:03, 23.65it/s]* GD progress: iter: 11 / bw: 3.581 / grad: -1462.479 / stop criter: 431.496 :   9%|▉         | 9/100 [00:00&lt;00:03, 23.65it/s]* GD progress: iter: 11 / bw: 3.581 / grad: -1462.479 / stop criter: 431.496 :   9%|▉         | 9/100 [00:00&lt;00:03, 23.65it/s]* GD progress: iter: 12 / bw: 3.650 / grad: -1401.256 / stop criter: 731.240 :   9%|▉         | 9/100 [00:00&lt;00:03, 23.65it/s]* GD progress: iter: 12 / bw: 3.650 / grad: -1401.256 / stop criter: 731.240 :   9%|▉         | 9/100 [00:00&lt;00:03, 23.65it/s]* GD progress: iter: 12 / bw: 3.650 / grad: -1401.256 / stop criter: 731.240 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.07it/s]* GD progress: iter: 13 / bw: 3.717 / grad: -979.888 / stop criter: 700.628 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.07it/s] * GD progress: iter: 13 / bw: 3.717 / grad: -979.888 / stop criter: 700.628 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.07it/s]* GD progress: iter: 14 / bw: 3.763 / grad: -876.893 / stop criter: 489.944 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.07it/s]* GD progress: iter: 14 / bw: 3.763 / grad: -876.893 / stop criter: 489.944 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.07it/s]* GD progress: iter: 15 / bw: 3.805 / grad: -542.185 / stop criter: 438.447 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.07it/s]* GD progress: iter: 15 / bw: 3.805 / grad: -542.185 / stop criter: 438.447 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.07it/s]* GD progress: iter: 15 / bw: 3.805 / grad: -542.185 / stop criter: 438.447 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.70it/s]* GD progress: iter: 16 / bw: 3.830 / grad: -1295.461 / stop criter: 271.093 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.70it/s]* GD progress: iter: 16 / bw: 3.830 / grad: -1295.461 / stop criter: 271.093 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.70it/s]* GD progress: iter: 17 / bw: 3.892 / grad: -1049.581 / stop criter: 647.731 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.70it/s]* GD progress: iter: 17 / bw: 3.892 / grad: -1049.581 / stop criter: 647.731 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.70it/s]* GD progress: iter: 18 / bw: 3.941 / grad: -445.348 / stop criter: 524.790 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.70it/s] * GD progress: iter: 18 / bw: 3.941 / grad: -445.348 / stop criter: 524.790 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.70it/s]* GD progress: iter: 18 / bw: 3.941 / grad: -445.348 / stop criter: 524.790 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.65it/s]* GD progress: iter: 19 / bw: 3.962 / grad: -691.839 / stop criter: 222.674 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.65it/s]* GD progress: iter: 19 / bw: 3.962 / grad: -691.839 / stop criter: 222.674 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.65it/s]* GD progress: iter: 20 / bw: 3.995 / grad: -959.074 / stop criter: 345.919 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.65it/s]* GD progress: iter: 20 / bw: 3.995 / grad: -959.074 / stop criter: 345.919 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.65it/s]* GD progress: iter: 21 / bw: 4.040 / grad: -451.220 / stop criter: 479.537 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.65it/s]* GD progress: iter: 21 / bw: 4.040 / grad: -451.220 / stop criter: 479.537 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.65it/s]* GD progress: iter: 21 / bw: 4.040 / grad: -451.220 / stop criter: 479.537 :  21%|██        | 21/100 [00:00&lt;00:03, 24.21it/s]* GD progress: iter: 22 / bw: 4.062 / grad: -942.451 / stop criter: 225.610 :  21%|██        | 21/100 [00:00&lt;00:03, 24.21it/s]* GD progress: iter: 22 / bw: 4.062 / grad: -942.451 / stop criter: 225.610 :  21%|██        | 21/100 [00:00&lt;00:03, 24.21it/s]* GD progress: iter: 23 / bw: 4.106 / grad: -504.026 / stop criter: 471.225 :  21%|██        | 21/100 [00:00&lt;00:03, 24.21it/s]* GD progress: iter: 23 / bw: 4.106 / grad: -504.026 / stop criter: 471.225 :  21%|██        | 21/100 [00:00&lt;00:03, 24.21it/s]* GD progress: iter: 24 / bw: 4.130 / grad: -720.430 / stop criter: 252.013 :  21%|██        | 21/100 [00:01&lt;00:03, 24.21it/s]* GD progress: iter: 24 / bw: 4.130 / grad: -720.430 / stop criter: 252.013 :  21%|██        | 21/100 [00:01&lt;00:03, 24.21it/s]* GD progress: iter: 24 / bw: 4.130 / grad: -720.430 / stop criter: 252.013 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.62it/s]* GD progress: iter: 25 / bw: 4.164 / grad: -1081.438 / stop criter: 360.215 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.62it/s]* GD progress: iter: 25 / bw: 4.164 / grad: -1081.438 / stop criter: 360.215 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.62it/s]* GD progress: iter: 26 / bw: 4.216 / grad: -940.762 / stop criter: 540.719 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.62it/s] * GD progress: iter: 26 / bw: 4.216 / grad: -940.762 / stop criter: 540.719 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.62it/s]* GD progress: iter: 27 / bw: 4.260 / grad: -213.947 / stop criter: 470.381 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.62it/s]* GD progress: iter: 27 / bw: 4.260 / grad: -213.947 / stop criter: 470.381 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.62it/s]* GD progress: iter: 27 / bw: 4.260 / grad: -213.947 / stop criter: 470.381 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.35it/s]* GD progress: iter: 28 / bw: 4.270 / grad: -537.103 / stop criter: 106.974 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.35it/s]* GD progress: iter: 28 / bw: 4.270 / grad: -537.103 / stop criter: 106.974 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.35it/s]* GD progress: iter: 29 / bw: 4.296 / grad: -333.538 / stop criter: 268.551 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.35it/s]* GD progress: iter: 29 / bw: 4.296 / grad: -333.538 / stop criter: 268.551 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.35it/s]* GD progress: iter: 30 / bw: 4.312 / grad: -410.188 / stop criter: 166.769 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.35it/s]* GD progress: iter: 30 / bw: 4.312 / grad: -410.188 / stop criter: 166.769 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.35it/s]* GD progress: iter: 30 / bw: 4.312 / grad: -410.188 / stop criter: 166.769 :  30%|███       | 30/100 [00:01&lt;00:02, 23.48it/s]* GD progress: iter: 31 / bw: 4.331 / grad: 81.299 / stop criter: 205.094 :  30%|███       | 30/100 [00:01&lt;00:02, 23.48it/s]  * GD progress: iter: 31 / bw: 4.331 / grad: 81.299 / stop criter: 205.094 :  30%|███       | 30/100 [00:01&lt;00:02, 23.48it/s]* GD progress: iter: 32 / bw: 4.327 / grad: -1170.799 / stop criter: 40.649 :  30%|███       | 30/100 [00:01&lt;00:02, 23.48it/s]* GD progress: iter: 32 / bw: 4.327 / grad: -1170.799 / stop criter: 40.649 :  30%|███       | 30/100 [00:01&lt;00:02, 23.48it/s]* GD progress: iter: 33 / bw: 4.371 / grad: -158.903 / stop criter: 585.399 :  30%|███       | 30/100 [00:01&lt;00:02, 23.48it/s]* GD progress: iter: 33 / bw: 4.371 / grad: -158.903 / stop criter: 585.399 :  30%|███       | 30/100 [00:01&lt;00:02, 23.48it/s]* GD progress: iter: 33 / bw: 4.371 / grad: -158.903 / stop criter: 585.399 :  33%|███▎      | 33/100 [00:01&lt;00:02, 23.95it/s]* GD progress: iter: 34 / bw: 4.376 / grad: -606.371 / stop criter: 79.452 :  33%|███▎      | 33/100 [00:01&lt;00:02, 23.95it/s] * GD progress: iter: 34 / bw: 4.376 / grad: -606.371 / stop criter: 79.452 :  33%|███▎      | 33/100 [00:01&lt;00:02, 23.95it/s]* GD progress: iter: 35 / bw: 4.395 / grad: -283.651 / stop criter: 303.185 :  33%|███▎      | 33/100 [00:01&lt;00:02, 23.95it/s]* GD progress: iter: 35 / bw: 4.395 / grad: -283.651 / stop criter: 303.185 :  33%|███▎      | 33/100 [00:01&lt;00:02, 23.95it/s]* GD progress: iter: 36 / bw: 4.403 / grad: -292.693 / stop criter: 141.825 :  33%|███▎      | 33/100 [00:01&lt;00:02, 23.95it/s]* GD progress: iter: 36 / bw: 4.403 / grad: -292.693 / stop criter: 141.825 :  33%|███▎      | 33/100 [00:01&lt;00:02, 23.95it/s]* GD progress: iter: 36 / bw: 4.403 / grad: -292.693 / stop criter: 141.825 :  36%|███▌      | 36/100 [00:01&lt;00:02, 24.68it/s]* GD progress: iter: 37 / bw: 4.412 / grad: -422.030 / stop criter: 146.347 :  36%|███▌      | 36/100 [00:01&lt;00:02, 24.68it/s]* GD progress: iter: 37 / bw: 4.412 / grad: -422.030 / stop criter: 146.347 :  36%|███▌      | 36/100 [00:01&lt;00:02, 24.68it/s]* GD progress: iter: 38 / bw: 4.425 / grad: -450.561 / stop criter: 211.015 :  36%|███▌      | 36/100 [00:01&lt;00:02, 24.68it/s]* GD progress: iter: 38 / bw: 4.425 / grad: -450.561 / stop criter: 211.015 :  36%|███▌      | 36/100 [00:01&lt;00:02, 24.68it/s]* GD progress: iter: 39 / bw: 4.439 / grad: -582.211 / stop criter: 225.281 :  36%|███▌      | 36/100 [00:01&lt;00:02, 24.68it/s]* GD progress: iter: 39 / bw: 4.439 / grad: -582.211 / stop criter: 225.281 :  36%|███▌      | 36/100 [00:01&lt;00:02, 24.68it/s]* GD progress: iter: 39 / bw: 4.439 / grad: -582.211 / stop criter: 225.281 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.42it/s]* GD progress: iter: 40 / bw: 4.456 / grad: -196.310 / stop criter: 291.106 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.42it/s]* GD progress: iter: 40 / bw: 4.456 / grad: -196.310 / stop criter: 291.106 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.42it/s]* GD progress: iter: 41 / bw: 4.462 / grad: -597.857 / stop criter: 98.155 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.42it/s] * GD progress: iter: 41 / bw: 4.462 / grad: -597.857 / stop criter: 98.155 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.42it/s]* GD progress: iter: 42 / bw: 4.480 / grad: -363.161 / stop criter: 298.928 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.42it/s]* GD progress: iter: 42 / bw: 4.480 / grad: -363.161 / stop criter: 298.928 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.42it/s]* GD progress: iter: 42 / bw: 4.480 / grad: -363.161 / stop criter: 298.928 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.63it/s]* GD progress: iter: 43 / bw: 4.491 / grad: -460.556 / stop criter: 181.581 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.63it/s]* GD progress: iter: 43 / bw: 4.491 / grad: -460.556 / stop criter: 181.581 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.63it/s]* GD progress: iter: 44 / bw: 4.505 / grad: -640.973 / stop criter: 230.278 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.63it/s]* GD progress: iter: 44 / bw: 4.505 / grad: -640.973 / stop criter: 230.278 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.63it/s]* GD progress: iter: 45 / bw: 4.525 / grad: -661.460 / stop criter: 320.486 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.63it/s]* GD progress: iter: 45 / bw: 4.525 / grad: -661.460 / stop criter: 320.486 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.63it/s]* GD progress: iter: 45 / bw: 4.525 / grad: -661.460 / stop criter: 320.486 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.50it/s]* GD progress: iter: 46 / bw: 4.545 / grad: -102.595 / stop criter: 330.730 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.50it/s]* GD progress: iter: 46 / bw: 4.545 / grad: -102.595 / stop criter: 330.730 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.50it/s]* GD progress: iter: 47 / bw: 4.548 / grad: -584.129 / stop criter: 51.298 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.50it/s] * GD progress: iter: 47 / bw: 4.548 / grad: -584.129 / stop criter: 51.298 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.50it/s]* GD progress: iter: 48 / bw: 4.566 / grad: -256.846 / stop criter: 292.064 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.50it/s]* GD progress: iter: 48 / bw: 4.566 / grad: -256.846 / stop criter: 292.064 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.50it/s]* GD progress: iter: 48 / bw: 4.566 / grad: -256.846 / stop criter: 292.064 :  48%|████▊     | 48/100 [00:01&lt;00:02, 24.33it/s]* GD progress: iter: 49 / bw: 4.573 / grad: -397.852 / stop criter: 128.423 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.33it/s]* GD progress: iter: 49 / bw: 4.573 / grad: -397.852 / stop criter: 128.423 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.33it/s]* GD progress: iter: 50 / bw: 4.585 / grad: -576.847 / stop criter: 198.926 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.33it/s]* GD progress: iter: 50 / bw: 4.585 / grad: -576.847 / stop criter: 198.926 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.33it/s]* GD progress: iter: 51 / bw: 4.603 / grad: -386.893 / stop criter: 288.424 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.33it/s]* GD progress: iter: 51 / bw: 4.603 / grad: -386.893 / stop criter: 288.424 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.33it/s]* GD progress: iter: 51 / bw: 4.603 / grad: -386.893 / stop criter: 288.424 :  51%|█████     | 51/100 [00:02&lt;00:02, 24.30it/s]* GD progress: iter: 52 / bw: 4.615 / grad: -793.621 / stop criter: 193.446 :  51%|█████     | 51/100 [00:02&lt;00:02, 24.30it/s]* GD progress: iter: 52 / bw: 4.615 / grad: -793.621 / stop criter: 193.446 :  51%|█████     | 51/100 [00:02&lt;00:02, 24.30it/s]* GD progress: iter: 53 / bw: 4.639 / grad: 84.003 / stop criter: 396.811 :  51%|█████     | 51/100 [00:02&lt;00:02, 24.30it/s]  * GD progress: iter: 53 / bw: 4.639 / grad: 84.003 / stop criter: 396.811 :  51%|█████     | 51/100 [00:02&lt;00:02, 24.30it/s]* GD progress: iter: 54 / bw: 4.636 / grad: -545.465 / stop criter: 42.002 :  51%|█████     | 51/100 [00:02&lt;00:02, 24.30it/s]* GD progress: iter: 54 / bw: 4.636 / grad: -545.465 / stop criter: 42.002 :  51%|█████     | 51/100 [00:02&lt;00:02, 24.30it/s]* GD progress: iter: 54 / bw: 4.636 / grad: -545.465 / stop criter: 42.002 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 24.26it/s]* GD progress: iter: 55 / bw: 4.649 / grad: -671.164 / stop criter: 272.732 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 24.26it/s]* GD progress: iter: 55 / bw: 4.649 / grad: -671.164 / stop criter: 272.732 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 24.26it/s]* GD progress: iter: 56 / bw: 4.662 / grad: -87.760 / stop criter: 335.582 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 24.26it/s] * GD progress: iter: 56 / bw: 4.662 / grad: -87.760 / stop criter: 335.582 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 24.26it/s]* GD progress: iter: 57 / bw: 4.664 / grad: -710.030 / stop criter: 43.880 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 24.26it/s]* GD progress: iter: 57 / bw: 4.664 / grad: -710.030 / stop criter: 43.880 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 24.26it/s]* GD progress: iter: 57 / bw: 4.664 / grad: -710.030 / stop criter: 43.880 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 23.96it/s]* GD progress: iter: 58 / bw: 4.678 / grad: -787.786 / stop criter: 355.015 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 23.96it/s]* GD progress: iter: 58 / bw: 4.678 / grad: -787.786 / stop criter: 355.015 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 23.96it/s]* GD progress: iter: 59 / bw: 4.693 / grad: 118.787 / stop criter: 393.893 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 23.96it/s] * GD progress: iter: 59 / bw: 4.693 / grad: 118.787 / stop criter: 393.893 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 23.96it/s]* GD progress: iter: 60 / bw: 4.691 / grad: -332.757 / stop criter: 59.394 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 23.96it/s]* GD progress: iter: 60 / bw: 4.691 / grad: -332.757 / stop criter: 59.394 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 23.96it/s]* GD progress: iter: 60 / bw: 4.691 / grad: -332.757 / stop criter: 59.394 :  60%|██████    | 60/100 [00:02&lt;00:01, 24.08it/s]* GD progress: iter: 61 / bw: 4.696 / grad: -207.704 / stop criter: 166.378 :  60%|██████    | 60/100 [00:02&lt;00:01, 24.08it/s]* GD progress: iter: 61 / bw: 4.696 / grad: -207.704 / stop criter: 166.378 :  60%|██████    | 60/100 [00:02&lt;00:01, 24.08it/s]* GD progress: iter: 62 / bw: 4.699 / grad: 237.943 / stop criter: 103.852 :  60%|██████    | 60/100 [00:02&lt;00:01, 24.08it/s] * GD progress: iter: 62 / bw: 4.699 / grad: 237.943 / stop criter: 103.852 :  60%|██████    | 60/100 [00:02&lt;00:01, 24.08it/s]* GD progress: iter: 63 / bw: 4.696 / grad: -580.749 / stop criter: 118.971 :  60%|██████    | 60/100 [00:02&lt;00:01, 24.08it/s]* GD progress: iter: 63 / bw: 4.696 / grad: -580.749 / stop criter: 118.971 :  60%|██████    | 60/100 [00:02&lt;00:01, 24.08it/s]* GD progress: iter: 63 / bw: 4.696 / grad: -580.749 / stop criter: 118.971 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 23.61it/s]* GD progress: iter: 64 / bw: 4.701 / grad: -142.136 / stop criter: 290.374 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 23.61it/s]* GD progress: iter: 64 / bw: 4.701 / grad: -142.136 / stop criter: 290.374 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 23.61it/s]* GD progress: iter: 65 / bw: 4.702 / grad: -186.171 / stop criter: 71.068 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 23.61it/s] * GD progress: iter: 65 / bw: 4.702 / grad: -186.171 / stop criter: 71.068 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 23.61it/s]* GD progress: iter: 66 / bw: 4.704 / grad: -480.497 / stop criter: 93.086 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 23.61it/s]* GD progress: iter: 66 / bw: 4.704 / grad: -480.497 / stop criter: 93.086 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 23.61it/s]* GD progress: iter: 66 / bw: 4.704 / grad: -480.497 / stop criter: 93.086 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 23.85it/s]* GD progress: iter: 67 / bw: 4.708 / grad: 51.641 / stop criter: 240.248 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 23.85it/s] * GD progress: iter: 67 / bw: 4.708 / grad: 51.641 / stop criter: 240.248 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 23.85it/s]* GD progress: iter: 68 / bw: 4.707 / grad: -48.291 / stop criter: 25.820 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 23.85it/s]* GD progress: iter: 68 / bw: 4.707 / grad: -48.291 / stop criter: 25.820 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 23.85it/s]* GD progress: iter: 69 / bw: 4.708 / grad: 315.635 / stop criter: 24.145 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 23.85it/s]* GD progress: iter: 69 / bw: 4.708 / grad: 315.635 / stop criter: 24.145 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 23.85it/s]* GD progress: iter: 69 / bw: 4.708 / grad: 315.635 / stop criter: 24.145 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 22.91it/s]* GD progress: iter: 70 / bw: 4.706 / grad: -505.067 / stop criter: 157.817 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 22.91it/s]* GD progress: iter: 70 / bw: 4.706 / grad: -505.067 / stop criter: 157.817 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 22.91it/s]* GD progress: iter: 71 / bw: 4.708 / grad: -152.554 / stop criter: 252.533 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 22.91it/s]* GD progress: iter: 71 / bw: 4.708 / grad: -152.554 / stop criter: 252.533 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 22.91it/s]* GD progress: iter: 72 / bw: 4.709 / grad: -219.627 / stop criter: 76.277 :  69%|██████▉   | 69/100 [00:03&lt;00:01, 22.91it/s] * GD progress: iter: 72 / bw: 4.709 / grad: -219.627 / stop criter: 76.277 :  69%|██████▉   | 69/100 [00:03&lt;00:01, 22.91it/s]* GD progress: iter: 72 / bw: 4.709 / grad: -219.627 / stop criter: 76.277 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 22.86it/s]* GD progress: iter: 73 / bw: 4.709 / grad: -54.615 / stop criter: 109.814 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 22.86it/s]* GD progress: iter: 73 / bw: 4.709 / grad: -54.615 / stop criter: 109.814 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 22.86it/s]* GD progress: iter: 74 / bw: 4.709 / grad: -413.265 / stop criter: 27.307 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 22.86it/s]* GD progress: iter: 74 / bw: 4.709 / grad: -413.265 / stop criter: 27.307 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 22.86it/s]* GD progress: iter: 75 / bw: 4.711 / grad: -580.232 / stop criter: 206.632 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 22.86it/s]* GD progress: iter: 75 / bw: 4.711 / grad: -580.232 / stop criter: 206.632 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 22.86it/s]* GD progress: iter: 75 / bw: 4.711 / grad: -580.232 / stop criter: 206.632 :  75%|███████▌  | 75/100 [00:03&lt;00:01, 21.93it/s]* GD progress: iter: 76 / bw: 4.713 / grad: -197.465 / stop criter: 290.116 :  75%|███████▌  | 75/100 [00:03&lt;00:01, 21.93it/s]* GD progress: iter: 76 / bw: 4.713 / grad: -197.465 / stop criter: 290.116 :  75%|███████▌  | 75/100 [00:03&lt;00:01, 21.93it/s]* GD progress: iter: 77 / bw: 4.713 / grad: -243.088 / stop criter: 98.733 :  75%|███████▌  | 75/100 [00:03&lt;00:01, 21.93it/s] * GD progress: iter: 77 / bw: 4.713 / grad: -243.088 / stop criter: 98.733 :  75%|███████▌  | 75/100 [00:03&lt;00:01, 21.93it/s]* GD progress: iter: 78 / bw: 4.714 / grad: -314.464 / stop criter: 121.544 :  75%|███████▌  | 75/100 [00:03&lt;00:01, 21.93it/s]* GD progress: iter: 78 / bw: 4.714 / grad: -314.464 / stop criter: 121.544 :  75%|███████▌  | 75/100 [00:03&lt;00:01, 21.93it/s]* GD progress: iter: 78 / bw: 4.714 / grad: -314.464 / stop criter: 121.544 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 22.49it/s]* GD progress: iter: 79 / bw: 4.715 / grad: -12.962 / stop criter: 157.232 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 22.49it/s] * GD progress: iter: 79 / bw: 4.715 / grad: -12.962 / stop criter: 157.232 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 22.49it/s]* GD progress: iter: 80 / bw: 4.715 / grad: -792.287 / stop criter: 6.481 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 22.49it/s] * GD progress: iter: 80 / bw: 4.715 / grad: -792.287 / stop criter: 6.481 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 22.49it/s]* GD progress: iter: 81 / bw: 4.718 / grad: 56.347 / stop criter: 396.143 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 22.49it/s]* GD progress: iter: 81 / bw: 4.718 / grad: 56.347 / stop criter: 396.143 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 22.49it/s]* GD progress: iter: 81 / bw: 4.718 / grad: 56.347 / stop criter: 396.143 :  81%|████████  | 81/100 [00:03&lt;00:00, 22.53it/s]* GD progress: iter: 82 / bw: 4.718 / grad: -841.254 / stop criter: 28.173 :  81%|████████  | 81/100 [00:03&lt;00:00, 22.53it/s]* GD progress: iter: 82 / bw: 4.718 / grad: -841.254 / stop criter: 28.173 :  81%|████████  | 81/100 [00:03&lt;00:00, 22.53it/s]* GD progress: iter: 83 / bw: 4.720 / grad: -80.193 / stop criter: 420.627 :  81%|████████  | 81/100 [00:03&lt;00:00, 22.53it/s]* GD progress: iter: 83 / bw: 4.720 / grad: -80.193 / stop criter: 420.627 :  81%|████████  | 81/100 [00:03&lt;00:00, 22.53it/s]* GD progress: iter: 84 / bw: 4.720 / grad: -902.163 / stop criter: 40.097 :  81%|████████  | 81/100 [00:03&lt;00:00, 22.53it/s]* GD progress: iter: 84 / bw: 4.720 / grad: -902.163 / stop criter: 40.097 :  81%|████████  | 81/100 [00:03&lt;00:00, 22.53it/s]* GD progress: iter: 84 / bw: 4.720 / grad: -902.163 / stop criter: 40.097 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 23.36it/s]* GD progress: iter: 85 / bw: 4.722 / grad: -849.776 / stop criter: 451.082 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 23.36it/s]* GD progress: iter: 85 / bw: 4.722 / grad: -849.776 / stop criter: 451.082 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 23.36it/s]* GD progress: iter: 86 / bw: 4.724 / grad: 215.540 / stop criter: 424.888 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 23.36it/s] * GD progress: iter: 86 / bw: 4.724 / grad: 215.540 / stop criter: 424.888 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 23.36it/s]* GD progress: iter: 87 / bw: 4.723 / grad: 41.853 / stop criter: 107.770 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 23.36it/s] * GD progress: iter: 87 / bw: 4.723 / grad: 41.853 / stop criter: 107.770 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 23.36it/s]* GD progress: iter: 87 / bw: 4.723 / grad: 41.853 / stop criter: 107.770 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 23.73it/s]* GD progress: iter: 88 / bw: 4.723 / grad: -818.824 / stop criter: 20.927 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 23.73it/s]* GD progress: iter: 88 / bw: 4.723 / grad: -818.824 / stop criter: 20.927 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 23.73it/s]* GD progress: iter: 89 / bw: 4.724 / grad: 179.618 / stop criter: 409.412 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 23.73it/s]* GD progress: iter: 89 / bw: 4.724 / grad: 179.618 / stop criter: 409.412 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 23.73it/s]* GD progress: iter: 90 / bw: 4.724 / grad: 8.709 / stop criter: 89.809 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 23.73it/s]   * GD progress: iter: 90 / bw: 4.724 / grad: 8.709 / stop criter: 89.809 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 23.73it/s]* GD progress: iter: 90 / bw: 4.724 / grad: 8.709 / stop criter: 89.809 :  90%|█████████ | 90/100 [00:03&lt;00:00, 23.12it/s]* GD progress: iter: 91 / bw: 4.724 / grad: -649.856 / stop criter: 4.355 :  90%|█████████ | 90/100 [00:03&lt;00:00, 23.12it/s]* GD progress: iter: 91 / bw: 4.724 / grad: -649.856 / stop criter: 4.355 :  90%|█████████ | 90/100 [00:03&lt;00:00, 23.12it/s]* GD progress: iter: 92 / bw: 4.725 / grad: 513.285 / stop criter: 324.928 :  90%|█████████ | 90/100 [00:03&lt;00:00, 23.12it/s]* GD progress: iter: 92 / bw: 4.725 / grad: 513.285 / stop criter: 324.928 :  90%|█████████ | 90/100 [00:03&lt;00:00, 23.12it/s]* GD progress: iter: 93 / bw: 4.724 / grad: -162.623 / stop criter: 256.643 :  90%|█████████ | 90/100 [00:03&lt;00:00, 23.12it/s]* GD progress: iter: 93 / bw: 4.724 / grad: -162.623 / stop criter: 256.643 :  90%|█████████ | 90/100 [00:03&lt;00:00, 23.12it/s]* GD progress: iter: 93 / bw: 4.724 / grad: -162.623 / stop criter: 256.643 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.40it/s]* GD progress: iter: 94 / bw: 4.725 / grad: -508.950 / stop criter: 81.311 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.40it/s] * GD progress: iter: 94 / bw: 4.725 / grad: -508.950 / stop criter: 81.311 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.40it/s]* GD progress: iter: 95 / bw: 4.725 / grad: 55.532 / stop criter: 254.475 :  93%|█████████▎| 93/100 [00:04&lt;00:00, 23.40it/s] * GD progress: iter: 95 / bw: 4.725 / grad: 55.532 / stop criter: 254.475 :  93%|█████████▎| 93/100 [00:04&lt;00:00, 23.40it/s]* GD progress: iter: 96 / bw: 4.725 / grad: -496.199 / stop criter: 27.766 :  93%|█████████▎| 93/100 [00:04&lt;00:00, 23.40it/s]* GD progress: iter: 96 / bw: 4.725 / grad: -496.199 / stop criter: 27.766 :  93%|█████████▎| 93/100 [00:04&lt;00:00, 23.40it/s]* GD progress: iter: 96 / bw: 4.725 / grad: -496.199 / stop criter: 27.766 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.45it/s]* GD progress: iter: 97 / bw: 4.725 / grad: -557.374 / stop criter: 248.099 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.45it/s]* GD progress: iter: 97 / bw: 4.725 / grad: -557.374 / stop criter: 248.099 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.45it/s]* GD progress: iter: 98 / bw: 4.725 / grad: 415.654 / stop criter: 278.687 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.45it/s] * GD progress: iter: 98 / bw: 4.725 / grad: 415.654 / stop criter: 278.687 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.45it/s]* GD progress: iter: 99 / bw: 4.725 / grad: 444.627 / stop criter: 207.827 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.45it/s]* GD progress: iter: 99 / bw: 4.725 / grad: 444.627 / stop criter: 207.827 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.45it/s]* GD progress: iter: 99 / bw: 4.725 / grad: 444.627 / stop criter: 207.827 :  99%|█████████▉| 99/100 [00:04&lt;00:00, 23.81it/s]* GD progress: iter: 100 / bw: 4.725 / grad: -646.316 / stop criter: 222.314 :  99%|█████████▉| 99/100 [00:04&lt;00:00, 23.81it/s]* GD progress: iter: 100 / bw: 4.725 / grad: -646.316 / stop criter: 222.314 :  99%|█████████▉| 99/100 [00:04&lt;00:00, 23.81it/s]* GD progress: iter: 100 / bw: 4.725 / grad: -646.316 / stop criter: 222.314 : 100%|██████████| 100/100 [00:04&lt;00:00, 23.72it/s]</code></pre>
</div>
</div>
<p>The estimated optimal bandwidth is given by <code>ker1.optimization_outputs['opt_bandwidth']</code>.</p>
<div id="92a4c30e" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(ker1_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :4.724965669889799</code></pre>
</div>
</div>
<p>We can look at the learning curve of the algorithm using <code>draw_learning_curve()</code> method.</p>
<div id="143e869d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ker1_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="10bddf7a-a9f6-4fd9-9884-cbf0895788d4" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("10bddf7a-a9f6-4fd9-9884-cbf0895788d4")) {                    Plotly.newPlot(                        "10bddf7a-a9f6-4fd9-9884-cbf0895788d4",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[3.1,3.1,3.1,3.1,3.1,3.20867736296523,3.2815175285449736,3.372625423062508,3.440626984484892,3.5401570178103716,3.581018915438624,3.650265967699644,3.7166141415334324,3.763010950007164,3.8045310390361107,3.8302030160019007,3.89154191416404,3.941238595989029,3.9623254316476952,3.9950833531455254,4.040494643146101,4.061859501122396,4.106483679151833,4.130348864929333,4.164460553508956,4.215665669936262,4.260209895391625,4.270340097668223,4.295771423247028,4.311564124332052,4.330986144576903,4.327136733952444,4.371485736952747,4.376301046450655,4.394676149213662,4.40327174226323,4.412141340188095,4.42493030418436,4.438583844942073,4.456226836116521,4.46217570305607,4.480292800674235,4.4912978194605335,4.5052542388847066,4.524677898015,4.54472238678792,4.5478313752278545,4.565532466762801,4.57331578723845,4.585372047778085,4.602852488553744,4.614576655570921,4.638626089026054,4.6360805075881935,4.649304068167975,4.662320739672135,4.66402277159794,4.677793227138261,4.693071699131964,4.690767917951446,4.695930754358801,4.698508837334115,4.695555423498796,4.701322153552632,4.702451265226804,4.703930184234081,4.707747182003694,4.707336955204932,4.707643846635309,4.706039136804321,4.708093372625314,4.70858975375512,4.709304377693586,4.709482082657032,4.710826765571083,4.712714727108128,4.713357241082986,4.71414820130521,4.715171407102976,4.715213581717283,4.717791527942236,4.717608186425328,4.719798007142345,4.71996500469496,4.721843701171964,4.723613303576601,4.723164455642289,4.723094729932627,4.7244588487784345,4.724219461143745,4.724210175518153,4.72490305604475,4.724465241470624,4.724576210883964,4.724854045420751,4.724823730686918,4.725040429812697,4.725235162102151,4.725089943083788,4.724965669889799],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,99],"y":[4.724965669889799,4.724965669889799],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.9449931339779598,2.13866867163433,3.3323442092907003,4.52601974694707,5.71969528460344,6.91337082225981,8.10704635991618,9.30072189757255,10.49439743522892,11.68807297288529,12.88174851054166,14.07542404819803,15.269099585854402,16.462775123510774,17.656450661167142,18.85012619882351,20.04380173647988,21.237477274136253,22.43115281179262,23.624828349448993],"y":[21556.28916041846,12516.765221621068,9021.69551347252,7872.37544746948,7710.586657989319,7950.861326080999,8338.458052163649,8760.241346748033,9167.137002456404,9540.423538037669,9875.594043187639,10174.257975394368,10440.210850045232,10677.67797709624,10890.609318656689,11082.455517257,11256.141524217584,11414.117481945617,11558.427109458524,11690.779088206475],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[4.724965669889799],"y":[7798.943903153134],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,4.724965669889799,4.724965669889799],"y":[7798.943903153134,7798.943903153134,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('10bddf7a-a9f6-4fd9-9884-cbf0895788d4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We evaluate the performance of the method on the testing data using MSE and MAPE.</p>
<div id="cb2d16d5" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_percentage_error</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span> ker1_fit.predict(X_test1)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test1, y_pred1))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test1, y_pred1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9402852827615601
8851.377117243073</code></pre>
</div>
</div>
<p>Let’s look at <code>qq-plot</code> of the predictions and the actual response values using <code>draw_learning_curve()</code> method.</p>
<div id="6473277c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ker1_fit.draw_learning_curve(y_test<span class="op">=</span>y_test1, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="8a64dcbc-c991-4643-9333-e1d065968441" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8a64dcbc-c991-4643-9333-e1d065968441")) {                    Plotly.newPlot(                        "8a64dcbc-c991-4643-9333-e1d065968441",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[-86.1230356569171,-76.93078537959221,50.97474276908403,-185.58742012852815,83.16863638863477,-90.52688616312805,106.7414296390276,-83.1668711353292,-90.68700076798308,251.77196635182227,82.46483891991656,138.7099565385106,-785.4985041773948,205.74737281090256,234.08733796134422,99.65445079178966,257.4073600197746,252.0744019100761,282.58366070896284,4.075662544635111,-1.4383377942086182,-77.99553286591986,195.40876245764292,-63.42861805776095,269.7671537124295,-79.63212090078956,7.623249928279979,-172.83566865220624,167.86803350976308,161.31814641350516,1.012696138396318,36.986808507635416,-86.66244946596873,188.21454162011491,-137.07730934117913,335.8629621906082,224.83892912074322,6.689562122057109,-56.40732548978641,256.90086260365547,119.16806186528244,-311.90313492050774,449.719405212038,-5.273418005534807,-682.2517726208913,257.53033801668647,-180.23474761140454,118.92791866285725,57.43877974169241,250.0382388237785,360.15236717559213,24.509499368569035,-240.17406008366015,-80.20711763142226,-117.39315858495162,167.3043482764136,156.88258368709012,503.38808891969575,-2.359944729674296,219.8502470670091,-364.7598965642611,4.679460860474425,-75.22486064859983,109.12028879842379,299.504836784831,-88.4025403000081,-267.29952417235904,34.56784689889023,77.52139720545289,241.71647648043455,50.4138940997371,-387.1266540821292,-330.6772358640141,-197.3753755715616,-62.68381156460539,-93.42259899990464,-356.64061101249047,230.58833397161487,101.96400200258333,53.300829613243415,143.5263907608617,-177.42532862225417,-27.662593611877814,-81.56145585437032,-127.16184323037972,-45.90432935176605,-500.3525641874223,132.1089195718619,12.026788181797016,-433.08197686175987,-168.77035117178357,53.76999260917576,56.013706606124856,322.31170613925116,100.21661071726592,-157.63184805348664,101.98200107858416,-75.09278133091411,283.0624585133832,304.0276830645346,-59.31586771196313,333.13149960451835,-95.74708869034697,8.290931158444915,203.47491215608417,114.56466032321784,333.8626841254291,357.80969970716876,-84.61741093321766,-381.7510297976623,18.55876463310474,58.0457815525275,-58.22106616080463,252.97671489700187,269.4211393726558,34.27588990746599,14.472912832578388,679.8215808158232,-224.09264153113,11.058254500037204,-52.45737342696991,254.60530898583946,-440.56886982785585,-90.19439849446908,-107.45231767645645,-453.56988739048666,-239.43368223562734,-5.864023829616331,-240.32733204895217,-108.97223267966469,-212.90949863731777,-70.99687844198822,113.15803408160996,186.19729205548438,54.55914076446016,74.19403312187146,281.1020991635118,-310.09699390663775,-174.7178714544378,-64.7108110667626,-253.6002052436947,186.74228860367998,218.08338904303375,-146.39803399782969,-199.30899629964262,37.6328469504373,-309.32604315485764,-69.91078606235617,-66.96698503915368,-21.881637458920157,-424.73748378123884,-39.836585771011386,101.2918249980767,-88.95821250796081,130.29777634958518,-12.892766172371633,294.986552741984,23.48029481056667,35.863454330816126,-288.05434276897984,411.42999517675463,165.95675067824746,-35.76580712665841,-133.66082315095554,-41.92721601941911,-186.20202260875996,-164.98290488745837,-128.5264909339381,165.5152806193353,253.8546912064182,-185.03048205979212,-338.0828394521503,-21.95067349933645,115.3028516429631,-157.12591594393618,27.53388232663615,-151.12858547039318,371.8339037545842,75.96798996233677,135.27701128861685,-19.19976774939901,-104.05648243195407,50.956246878921895,-2.6905747234882806,-216.16518343683305,24.18998533475998,-36.93788910844318,417.86886834432136,-180.25822794638316,-90.28551854014144,6.943188886615214,116.11089629545486,-198.3982822728782,162.97177270500052,392.6214383422561,-120.76983081402558,-21.068089597542173,-375.3870256227878,68.69428524824858,365.59160496084303],"xaxis":"x","y":[-86.1230356569171,-76.93078537959221,50.97474276908403,-185.58742012852815,83.16863638863477,-90.52688616312805,106.7414296390276,-83.1668711353292,-90.68700076798308,251.77196635182227,82.46483891991656,138.7099565385106,-785.4985041773948,205.74737281090256,234.08733796134422,99.65445079178966,257.4073600197746,252.0744019100761,282.58366070896284,4.075662544635111,-1.4383377942086182,-77.99553286591986,195.40876245764292,-63.42861805776095,269.7671537124295,-79.63212090078956,7.623249928279979,-172.83566865220624,167.86803350976308,161.31814641350516,1.012696138396318,36.986808507635416,-86.66244946596873,188.21454162011491,-137.07730934117913,335.8629621906082,224.83892912074322,6.689562122057109,-56.40732548978641,256.90086260365547,119.16806186528244,-311.90313492050774,449.719405212038,-5.273418005534807,-682.2517726208913,257.53033801668647,-180.23474761140454,118.92791866285725,57.43877974169241,250.0382388237785,360.15236717559213,24.509499368569035,-240.17406008366015,-80.20711763142226,-117.39315858495162,167.3043482764136,156.88258368709012,503.38808891969575,-2.359944729674296,219.8502470670091,-364.7598965642611,4.679460860474425,-75.22486064859983,109.12028879842379,299.504836784831,-88.4025403000081,-267.29952417235904,34.56784689889023,77.52139720545289,241.71647648043455,50.4138940997371,-387.1266540821292,-330.6772358640141,-197.3753755715616,-62.68381156460539,-93.42259899990464,-356.64061101249047,230.58833397161487,101.96400200258333,53.300829613243415,143.5263907608617,-177.42532862225417,-27.662593611877814,-81.56145585437032,-127.16184323037972,-45.90432935176605,-500.3525641874223,132.1089195718619,12.026788181797016,-433.08197686175987,-168.77035117178357,53.76999260917576,56.013706606124856,322.31170613925116,100.21661071726592,-157.63184805348664,101.98200107858416,-75.09278133091411,283.0624585133832,304.0276830645346,-59.31586771196313,333.13149960451835,-95.74708869034697,8.290931158444915,203.47491215608417,114.56466032321784,333.8626841254291,357.80969970716876,-84.61741093321766,-381.7510297976623,18.55876463310474,58.0457815525275,-58.22106616080463,252.97671489700187,269.4211393726558,34.27588990746599,14.472912832578388,679.8215808158232,-224.09264153113,11.058254500037204,-52.45737342696991,254.60530898583946,-440.56886982785585,-90.19439849446908,-107.45231767645645,-453.56988739048666,-239.43368223562734,-5.864023829616331,-240.32733204895217,-108.97223267966469,-212.90949863731777,-70.99687844198822,113.15803408160996,186.19729205548438,54.55914076446016,74.19403312187146,281.1020991635118,-310.09699390663775,-174.7178714544378,-64.7108110667626,-253.6002052436947,186.74228860367998,218.08338904303375,-146.39803399782969,-199.30899629964262,37.6328469504373,-309.32604315485764,-69.91078606235617,-66.96698503915368,-21.881637458920157,-424.73748378123884,-39.836585771011386,101.2918249980767,-88.95821250796081,130.29777634958518,-12.892766172371633,294.986552741984,23.48029481056667,35.863454330816126,-288.05434276897984,411.42999517675463,165.95675067824746,-35.76580712665841,-133.66082315095554,-41.92721601941911,-186.20202260875996,-164.98290488745837,-128.5264909339381,165.5152806193353,253.8546912064182,-185.03048205979212,-338.0828394521503,-21.95067349933645,115.3028516429631,-157.12591594393618,27.53388232663615,-151.12858547039318,371.8339037545842,75.96798996233677,135.27701128861685,-19.19976774939901,-104.05648243195407,50.956246878921895,-2.6905747234882806,-216.16518343683305,24.18998533475998,-36.93788910844318,417.86886834432136,-180.25822794638316,-90.28551854014144,6.943188886615214,116.11089629545486,-198.3982822728782,162.97177270500052,392.6214383422561,-120.76983081402558,-21.068089597542173,-375.3870256227878,68.69428524824858,365.59160496084303],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-55.52325773876946,-66.38377269849697,69.13505434709889,-102.99010866410106,97.92159244463201,-62.27659634435509,2.677878724883379,-34.36822741531897,-51.95704967766301,147.2396320259362,23.611616791541813,83.56371625690763,-414.86653283570945,108.06127230251398,142.3789134713411,62.51018857858591,160.8420829141199,117.1684686904501,182.78909688450736,36.04027419275393,55.656141440129495,-79.68506404512357,135.55409517879704,-51.65924860952267,173.11625510885113,22.586758932720432,24.321723565357367,-102.69370618258112,101.4149299181501,121.92427044111605,-7.4915950903503905,5.627254790042781,-18.85063090049805,113.74200160128402,-67.09069488395195,220.55317389219607,140.0303131364172,19.356247347664638,-24.92199926114547,150.58620851107946,104.06928097952698,-182.65280555698112,249.9922982025623,-11.51370672959014,-335.3691240139309,245.55704400119558,-124.3181490767694,57.576158958306245,-24.91653932829319,160.69651677643267,201.64254438970337,13.533599582674594,-210.92512217186433,-22.654935463806208,-112.76374601361387,105.12709674444959,81.40306961879075,250.91750087176035,-16.918052029899822,123.87064220365201,-264.98539037795905,-8.480170660696587,-17.272171136732528,3.5998298456079048,240.7936831697424,-67.49081264800839,-132.43036169346738,-16.4076089791504,58.83109228606541,137.312614907359,20.940944524384708,-239.58205244020056,-211.05392308397896,-93.64511668189039,113.99327596018512,-135.291680234406,-216.8659047216709,153.10618054501853,58.46771540307067,-22.033964099532994,142.53699978163488,-146.94536379225437,-10.984799036988747,-41.57914878975498,-92.709624155499,-67.92579258368646,-323.32570020424737,45.46874159307572,-1.352654428809813,-246.29040169867613,-72.7133400868219,-11.224531022544777,14.382901117674665,220.65555168955834,93.92741812056059,-102.15820848233456,39.973219690289405,-74.19779720903956,167.1211996426179,205.8011139279825,-86.99917134195414,237.14030455650624,-91.31301427124069,11.221685554545374,85.27963907691314,116.92165911418304,164.95886070357864,240.51863713771047,-2.664387537690463,-268.2604543089083,-23.891489612569043,-6.276260776443168,-29.788823576438237,153.05225311378354,142.90949714101265,-32.70028463648042,-8.216509899073959,350.85630591420016,-160.47085373579523,1.5888052280028522,-29.077364794714995,137.88700337622922,-290.7093784860288,-82.83155572469646,-38.38265127750763,-193.18344535012216,-153.29094918119068,-10.790299818237948,-165.68327282729973,-60.18829220984791,-88.88907534748107,-85.8734368137945,93.42932955174192,131.67731362280873,-2.5693476922759375,22.3626907517188,269.9227251988955,-216.7357520457584,-136.84838045574705,-48.01870885460221,-117.20765790486594,134.10313398552506,110.85536430793168,-60.18822643804878,-132.1357453808672,74.68924569459297,-214.91696608715512,-35.21237982358767,-105.99268277963611,-23.463544770899862,-318.0235944395508,-76.28313464770122,67.0066162813253,-37.611486742405816,79.14335765783024,-58.141574073101,243.09824020821614,36.99313239329774,23.33068923979653,-262.6623715188369,232.2274257129003,57.92848264794333,-121.74304359707193,-64.44122019951763,-42.18526217179174,-117.38686743750372,-137.4429675495816,-54.87624273367248,126.35573324945295,128.97451126417027,-134.82631597685193,-207.55282960138217,14.496821022594814,57.46321749597558,-37.84429691128468,0.06588447195113194,-63.37450739934099,160.32680787121225,33.79193396891482,-7.3540213468286675,-44.808721719905485,-30.21329968888549,41.83372643416596,-28.814771463472443,-146.27357219693653,80.28472890188225,-25.843083167307842,167.38413546600572,-89.97888871291092,-22.15594902071187,-22.94229073438749,70.74201614785885,-102.56133705196658,118.24504681371103,243.37111824422107,-67.45564131975772,-45.61562653031731,-295.1106897224099,20.23458631015844,258.3383304611062],"xaxis":"x","y":[-86.1230356569171,-76.93078537959221,50.97474276908403,-185.58742012852815,83.16863638863477,-90.52688616312805,106.7414296390276,-83.1668711353292,-90.68700076798308,251.77196635182227,82.46483891991656,138.7099565385106,-785.4985041773948,205.74737281090256,234.08733796134422,99.65445079178966,257.4073600197746,252.0744019100761,282.58366070896284,4.075662544635111,-1.4383377942086182,-77.99553286591986,195.40876245764292,-63.42861805776095,269.7671537124295,-79.63212090078956,7.623249928279979,-172.83566865220624,167.86803350976308,161.31814641350516,1.012696138396318,36.986808507635416,-86.66244946596873,188.21454162011491,-137.07730934117913,335.8629621906082,224.83892912074322,6.689562122057109,-56.40732548978641,256.90086260365547,119.16806186528244,-311.90313492050774,449.719405212038,-5.273418005534807,-682.2517726208913,257.53033801668647,-180.23474761140454,118.92791866285725,57.43877974169241,250.0382388237785,360.15236717559213,24.509499368569035,-240.17406008366015,-80.20711763142226,-117.39315858495162,167.3043482764136,156.88258368709012,503.38808891969575,-2.359944729674296,219.8502470670091,-364.7598965642611,4.679460860474425,-75.22486064859983,109.12028879842379,299.504836784831,-88.4025403000081,-267.29952417235904,34.56784689889023,77.52139720545289,241.71647648043455,50.4138940997371,-387.1266540821292,-330.6772358640141,-197.3753755715616,-62.68381156460539,-93.42259899990464,-356.64061101249047,230.58833397161487,101.96400200258333,53.300829613243415,143.5263907608617,-177.42532862225417,-27.662593611877814,-81.56145585437032,-127.16184323037972,-45.90432935176605,-500.3525641874223,132.1089195718619,12.026788181797016,-433.08197686175987,-168.77035117178357,53.76999260917576,56.013706606124856,322.31170613925116,100.21661071726592,-157.63184805348664,101.98200107858416,-75.09278133091411,283.0624585133832,304.0276830645346,-59.31586771196313,333.13149960451835,-95.74708869034697,8.290931158444915,203.47491215608417,114.56466032321784,333.8626841254291,357.80969970716876,-84.61741093321766,-381.7510297976623,18.55876463310474,58.0457815525275,-58.22106616080463,252.97671489700187,269.4211393726558,34.27588990746599,14.472912832578388,679.8215808158232,-224.09264153113,11.058254500037204,-52.45737342696991,254.60530898583946,-440.56886982785585,-90.19439849446908,-107.45231767645645,-453.56988739048666,-239.43368223562734,-5.864023829616331,-240.32733204895217,-108.97223267966469,-212.90949863731777,-70.99687844198822,113.15803408160996,186.19729205548438,54.55914076446016,74.19403312187146,281.1020991635118,-310.09699390663775,-174.7178714544378,-64.7108110667626,-253.6002052436947,186.74228860367998,218.08338904303375,-146.39803399782969,-199.30899629964262,37.6328469504373,-309.32604315485764,-69.91078606235617,-66.96698503915368,-21.881637458920157,-424.73748378123884,-39.836585771011386,101.2918249980767,-88.95821250796081,130.29777634958518,-12.892766172371633,294.986552741984,23.48029481056667,35.863454330816126,-288.05434276897984,411.42999517675463,165.95675067824746,-35.76580712665841,-133.66082315095554,-41.92721601941911,-186.20202260875996,-164.98290488745837,-128.5264909339381,165.5152806193353,253.8546912064182,-185.03048205979212,-338.0828394521503,-21.95067349933645,115.3028516429631,-157.12591594393618,27.53388232663615,-151.12858547039318,371.8339037545842,75.96798996233677,135.27701128861685,-19.19976774939901,-104.05648243195407,50.956246878921895,-2.6905747234882806,-216.16518343683305,24.18998533475998,-36.93788910844318,417.86886834432136,-180.25822794638316,-90.28551854014144,6.943188886615214,116.11089629545486,-198.3982822728782,162.97177270500052,392.6214383422561,-120.76983081402558,-21.068089597542173,-375.3870256227878,68.69428524824858,365.59160496084303],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8a64dcbc-c991-4643-9333-e1d065968441');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<hr>
</section>
<section id="bullet-kernelsmoother-with-non-default-parameters" class="level4">
<h4 class="anchored" data-anchor-id="bullet-kernelsmoother-with-non-default-parameters"><span class="math inline">\(\bullet\)</span> <code>KernelSmoother</code> with non-default parameters</h4>
<p>We create another object <code>gc2</code> with non-default parameters, then fit it to the same training data as in the previous example.</p>
<div id="d0320203" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ker2 <span class="op">=</span> KernelSmoother(learning_rate<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                    opt_method<span class="op">=</span><span class="st">'grad'</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                    max_iter<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                    kernel<span class="op">=</span><span class="st">"exponential"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ker2_fit <span class="op">=</span> ker2.fit(X_train1, y_train1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: -2089.122 / stop criter: 1.000 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   0%|          | 0/100 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   3%|▎         | 3/100 [00:00&lt;00:03, 25.44it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   3%|▎         | 3/100 [00:00&lt;00:03, 25.44it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -2089.122 / stop criter: 1044.578 :   3%|▎         | 3/100 [00:00&lt;00:03, 25.44it/s]* GD progress: iter: 5 / bw: 3.100 / grad: -1896.859 / stop criter: 1044.561 :   3%|▎         | 3/100 [00:00&lt;00:03, 25.44it/s]* GD progress: iter: 5 / bw: 3.100 / grad: -1896.859 / stop criter: 1044.561 :   3%|▎         | 3/100 [00:00&lt;00:03, 25.44it/s]* GD progress: iter: 6 / bw: 3.191 / grad: -1624.536 / stop criter: 948.430 :   3%|▎         | 3/100 [00:00&lt;00:03, 25.44it/s] * GD progress: iter: 6 / bw: 3.191 / grad: -1624.536 / stop criter: 948.430 :   3%|▎         | 3/100 [00:00&lt;00:03, 25.44it/s]* GD progress: iter: 6 / bw: 3.191 / grad: -1624.536 / stop criter: 948.430 :   6%|▌         | 6/100 [00:00&lt;00:03, 23.67it/s]* GD progress: iter: 7 / bw: 3.269 / grad: -2521.952 / stop criter: 812.268 :   6%|▌         | 6/100 [00:00&lt;00:03, 23.67it/s]* GD progress: iter: 7 / bw: 3.269 / grad: -2521.952 / stop criter: 812.268 :   6%|▌         | 6/100 [00:00&lt;00:03, 23.67it/s]* GD progress: iter: 8 / bw: 3.389 / grad: -1482.310 / stop criter: 1260.976 :   6%|▌         | 6/100 [00:00&lt;00:03, 23.67it/s]* GD progress: iter: 8 / bw: 3.389 / grad: -1482.310 / stop criter: 1260.976 :   6%|▌         | 6/100 [00:00&lt;00:03, 23.67it/s]* GD progress: iter: 9 / bw: 3.460 / grad: -727.584 / stop criter: 741.155 :   6%|▌         | 6/100 [00:00&lt;00:03, 23.67it/s]  * GD progress: iter: 9 / bw: 3.460 / grad: -727.584 / stop criter: 741.155 :   6%|▌         | 6/100 [00:00&lt;00:03, 23.67it/s]* GD progress: iter: 9 / bw: 3.460 / grad: -727.584 / stop criter: 741.155 :   9%|▉         | 9/100 [00:00&lt;00:03, 24.63it/s]* GD progress: iter: 10 / bw: 3.495 / grad: -1612.071 / stop criter: 363.792 :   9%|▉         | 9/100 [00:00&lt;00:03, 24.63it/s]* GD progress: iter: 10 / bw: 3.495 / grad: -1612.071 / stop criter: 363.792 :   9%|▉         | 9/100 [00:00&lt;00:03, 24.63it/s]* GD progress: iter: 11 / bw: 3.572 / grad: -877.867 / stop criter: 806.036 :   9%|▉         | 9/100 [00:00&lt;00:03, 24.63it/s] * GD progress: iter: 11 / bw: 3.572 / grad: -877.867 / stop criter: 806.036 :   9%|▉         | 9/100 [00:00&lt;00:03, 24.63it/s]* GD progress: iter: 12 / bw: 3.614 / grad: -1679.170 / stop criter: 438.934 :   9%|▉         | 9/100 [00:00&lt;00:03, 24.63it/s]* GD progress: iter: 12 / bw: 3.614 / grad: -1679.170 / stop criter: 438.934 :   9%|▉         | 9/100 [00:00&lt;00:03, 24.63it/s]* GD progress: iter: 12 / bw: 3.614 / grad: -1679.170 / stop criter: 438.934 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.61it/s]* GD progress: iter: 13 / bw: 3.695 / grad: -1420.300 / stop criter: 839.585 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.61it/s]* GD progress: iter: 13 / bw: 3.695 / grad: -1420.300 / stop criter: 839.585 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.61it/s]* GD progress: iter: 14 / bw: 3.763 / grad: -1206.424 / stop criter: 710.150 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.61it/s]* GD progress: iter: 14 / bw: 3.763 / grad: -1206.424 / stop criter: 710.150 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.61it/s]* GD progress: iter: 15 / bw: 3.820 / grad: -600.493 / stop criter: 603.212 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.61it/s] * GD progress: iter: 15 / bw: 3.820 / grad: -600.493 / stop criter: 603.212 :  12%|█▏        | 12/100 [00:00&lt;00:03, 24.61it/s]* GD progress: iter: 15 / bw: 3.820 / grad: -600.493 / stop criter: 603.212 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.50it/s]* GD progress: iter: 16 / bw: 3.849 / grad: -1157.549 / stop criter: 300.247 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.50it/s]* GD progress: iter: 16 / bw: 3.849 / grad: -1157.549 / stop criter: 300.247 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.50it/s]* GD progress: iter: 17 / bw: 3.905 / grad: -1388.533 / stop criter: 578.774 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.50it/s]* GD progress: iter: 17 / bw: 3.905 / grad: -1388.533 / stop criter: 578.774 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.50it/s]* GD progress: iter: 18 / bw: 3.971 / grad: -1049.001 / stop criter: 694.266 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.50it/s]* GD progress: iter: 18 / bw: 3.971 / grad: -1049.001 / stop criter: 694.266 :  15%|█▌        | 15/100 [00:00&lt;00:03, 24.50it/s]* GD progress: iter: 18 / bw: 3.971 / grad: -1049.001 / stop criter: 694.266 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.91it/s]* GD progress: iter: 19 / bw: 4.021 / grad: -711.979 / stop criter: 524.500 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.91it/s] * GD progress: iter: 19 / bw: 4.021 / grad: -711.979 / stop criter: 524.500 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.91it/s]* GD progress: iter: 20 / bw: 4.055 / grad: -906.172 / stop criter: 355.990 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.91it/s]* GD progress: iter: 20 / bw: 4.055 / grad: -906.172 / stop criter: 355.990 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.91it/s]* GD progress: iter: 21 / bw: 4.099 / grad: -1367.946 / stop criter: 453.086 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.91it/s]* GD progress: iter: 21 / bw: 4.099 / grad: -1367.946 / stop criter: 453.086 :  18%|█▊        | 18/100 [00:00&lt;00:03, 24.91it/s]* GD progress: iter: 21 / bw: 4.099 / grad: -1367.946 / stop criter: 453.086 :  21%|██        | 21/100 [00:00&lt;00:03, 24.77it/s]* GD progress: iter: 22 / bw: 4.164 / grad: -241.177 / stop criter: 683.973 :  21%|██        | 21/100 [00:00&lt;00:03, 24.77it/s] * GD progress: iter: 22 / bw: 4.164 / grad: -241.177 / stop criter: 683.973 :  21%|██        | 21/100 [00:00&lt;00:03, 24.77it/s]* GD progress: iter: 23 / bw: 4.176 / grad: -324.894 / stop criter: 120.589 :  21%|██        | 21/100 [00:00&lt;00:03, 24.77it/s]* GD progress: iter: 23 / bw: 4.176 / grad: -324.894 / stop criter: 120.589 :  21%|██        | 21/100 [00:00&lt;00:03, 24.77it/s]* GD progress: iter: 24 / bw: 4.191 / grad: -732.385 / stop criter: 162.447 :  21%|██        | 21/100 [00:00&lt;00:03, 24.77it/s]* GD progress: iter: 24 / bw: 4.191 / grad: -732.385 / stop criter: 162.447 :  21%|██        | 21/100 [00:00&lt;00:03, 24.77it/s]* GD progress: iter: 24 / bw: 4.191 / grad: -732.385 / stop criter: 162.447 :  24%|██▍       | 24/100 [00:00&lt;00:03, 23.94it/s]* GD progress: iter: 25 / bw: 4.226 / grad: -780.101 / stop criter: 366.192 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.94it/s]* GD progress: iter: 25 / bw: 4.226 / grad: -780.101 / stop criter: 366.192 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.94it/s]* GD progress: iter: 26 / bw: 4.264 / grad: -618.192 / stop criter: 390.051 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.94it/s]* GD progress: iter: 26 / bw: 4.264 / grad: -618.192 / stop criter: 390.051 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.94it/s]* GD progress: iter: 27 / bw: 4.293 / grad: -1550.916 / stop criter: 309.096 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.94it/s]* GD progress: iter: 27 / bw: 4.293 / grad: -1550.916 / stop criter: 309.096 :  24%|██▍       | 24/100 [00:01&lt;00:03, 23.94it/s]* GD progress: iter: 27 / bw: 4.293 / grad: -1550.916 / stop criter: 309.096 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.88it/s]* GD progress: iter: 28 / bw: 4.367 / grad: -859.468 / stop criter: 775.458 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.88it/s] * GD progress: iter: 28 / bw: 4.367 / grad: -859.468 / stop criter: 775.458 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.88it/s]* GD progress: iter: 29 / bw: 4.409 / grad: -326.073 / stop criter: 429.734 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.88it/s]* GD progress: iter: 29 / bw: 4.409 / grad: -326.073 / stop criter: 429.734 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.88it/s]* GD progress: iter: 30 / bw: 4.424 / grad: -552.966 / stop criter: 163.037 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.88it/s]* GD progress: iter: 30 / bw: 4.424 / grad: -552.966 / stop criter: 163.037 :  27%|██▋       | 27/100 [00:01&lt;00:03, 23.88it/s]* GD progress: iter: 30 / bw: 4.424 / grad: -552.966 / stop criter: 163.037 :  30%|███       | 30/100 [00:01&lt;00:02, 23.68it/s]* GD progress: iter: 31 / bw: 4.451 / grad: -982.015 / stop criter: 276.483 :  30%|███       | 30/100 [00:01&lt;00:02, 23.68it/s]* GD progress: iter: 31 / bw: 4.451 / grad: -982.015 / stop criter: 276.483 :  30%|███       | 30/100 [00:01&lt;00:02, 23.68it/s]* GD progress: iter: 32 / bw: 4.498 / grad: -243.416 / stop criter: 491.007 :  30%|███       | 30/100 [00:01&lt;00:02, 23.68it/s]* GD progress: iter: 32 / bw: 4.498 / grad: -243.416 / stop criter: 491.007 :  30%|███       | 30/100 [00:01&lt;00:02, 23.68it/s]* GD progress: iter: 33 / bw: 4.509 / grad: -156.129 / stop criter: 121.708 :  30%|███       | 30/100 [00:01&lt;00:02, 23.68it/s]* GD progress: iter: 33 / bw: 4.509 / grad: -156.129 / stop criter: 121.708 :  30%|███       | 30/100 [00:01&lt;00:02, 23.68it/s]* GD progress: iter: 33 / bw: 4.509 / grad: -156.129 / stop criter: 121.708 :  33%|███▎      | 33/100 [00:01&lt;00:02, 24.19it/s]* GD progress: iter: 34 / bw: 4.517 / grad: -613.919 / stop criter: 78.064 :  33%|███▎      | 33/100 [00:01&lt;00:02, 24.19it/s] * GD progress: iter: 34 / bw: 4.517 / grad: -613.919 / stop criter: 78.064 :  33%|███▎      | 33/100 [00:01&lt;00:02, 24.19it/s]* GD progress: iter: 35 / bw: 4.546 / grad: -433.838 / stop criter: 306.960 :  33%|███▎      | 33/100 [00:01&lt;00:02, 24.19it/s]* GD progress: iter: 35 / bw: 4.546 / grad: -433.838 / stop criter: 306.960 :  33%|███▎      | 33/100 [00:01&lt;00:02, 24.19it/s]* GD progress: iter: 36 / bw: 4.567 / grad: -251.765 / stop criter: 216.919 :  33%|███▎      | 33/100 [00:01&lt;00:02, 24.19it/s]* GD progress: iter: 36 / bw: 4.567 / grad: -251.765 / stop criter: 216.919 :  33%|███▎      | 33/100 [00:01&lt;00:02, 24.19it/s]* GD progress: iter: 36 / bw: 4.567 / grad: -251.765 / stop criter: 216.919 :  36%|███▌      | 36/100 [00:01&lt;00:02, 25.01it/s]* GD progress: iter: 37 / bw: 4.579 / grad: -452.257 / stop criter: 125.883 :  36%|███▌      | 36/100 [00:01&lt;00:02, 25.01it/s]* GD progress: iter: 37 / bw: 4.579 / grad: -452.257 / stop criter: 125.883 :  36%|███▌      | 36/100 [00:01&lt;00:02, 25.01it/s]* GD progress: iter: 38 / bw: 4.601 / grad: -511.650 / stop criter: 226.129 :  36%|███▌      | 36/100 [00:01&lt;00:02, 25.01it/s]* GD progress: iter: 38 / bw: 4.601 / grad: -511.650 / stop criter: 226.129 :  36%|███▌      | 36/100 [00:01&lt;00:02, 25.01it/s]* GD progress: iter: 39 / bw: 4.625 / grad: -424.007 / stop criter: 255.825 :  36%|███▌      | 36/100 [00:01&lt;00:02, 25.01it/s]* GD progress: iter: 39 / bw: 4.625 / grad: -424.007 / stop criter: 255.825 :  36%|███▌      | 36/100 [00:01&lt;00:02, 25.01it/s]* GD progress: iter: 39 / bw: 4.625 / grad: -424.007 / stop criter: 255.825 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.09it/s]* GD progress: iter: 40 / bw: 4.645 / grad: -661.376 / stop criter: 212.003 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.09it/s]* GD progress: iter: 40 / bw: 4.645 / grad: -661.376 / stop criter: 212.003 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.09it/s]* GD progress: iter: 41 / bw: 4.677 / grad: -492.005 / stop criter: 330.688 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.09it/s]* GD progress: iter: 41 / bw: 4.677 / grad: -492.005 / stop criter: 330.688 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.09it/s]* GD progress: iter: 42 / bw: 4.701 / grad: -182.216 / stop criter: 246.003 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.09it/s]* GD progress: iter: 42 / bw: 4.701 / grad: -182.216 / stop criter: 246.003 :  39%|███▉      | 39/100 [00:01&lt;00:02, 24.09it/s]* GD progress: iter: 42 / bw: 4.701 / grad: -182.216 / stop criter: 246.003 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.81it/s]* GD progress: iter: 43 / bw: 4.709 / grad: -161.136 / stop criter: 91.108 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.81it/s] * GD progress: iter: 43 / bw: 4.709 / grad: -161.136 / stop criter: 91.108 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.81it/s]* GD progress: iter: 44 / bw: 4.717 / grad: -218.155 / stop criter: 80.568 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.81it/s]* GD progress: iter: 44 / bw: 4.717 / grad: -218.155 / stop criter: 80.568 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.81it/s]* GD progress: iter: 45 / bw: 4.728 / grad: -305.745 / stop criter: 109.077 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.81it/s]* GD progress: iter: 45 / bw: 4.728 / grad: -305.745 / stop criter: 109.077 :  42%|████▏     | 42/100 [00:01&lt;00:02, 24.81it/s]* GD progress: iter: 45 / bw: 4.728 / grad: -305.745 / stop criter: 109.077 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.39it/s]* GD progress: iter: 46 / bw: 4.742 / grad: -1017.882 / stop criter: 152.873 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.39it/s]* GD progress: iter: 46 / bw: 4.742 / grad: -1017.882 / stop criter: 152.873 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.39it/s]* GD progress: iter: 47 / bw: 4.791 / grad: -143.602 / stop criter: 508.941 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.39it/s] * GD progress: iter: 47 / bw: 4.791 / grad: -143.602 / stop criter: 508.941 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.39it/s]* GD progress: iter: 48 / bw: 4.798 / grad: 375.882 / stop criter: 71.801 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.39it/s]  * GD progress: iter: 48 / bw: 4.798 / grad: 375.882 / stop criter: 71.801 :  45%|████▌     | 45/100 [00:01&lt;00:02, 24.39it/s]* GD progress: iter: 48 / bw: 4.798 / grad: 375.882 / stop criter: 71.801 :  48%|████▊     | 48/100 [00:01&lt;00:02, 24.92it/s]* GD progress: iter: 49 / bw: 4.780 / grad: -362.551 / stop criter: 187.941 :  48%|████▊     | 48/100 [00:01&lt;00:02, 24.92it/s]* GD progress: iter: 49 / bw: 4.780 / grad: -362.551 / stop criter: 187.941 :  48%|████▊     | 48/100 [00:01&lt;00:02, 24.92it/s]* GD progress: iter: 50 / bw: 4.794 / grad: 140.022 / stop criter: 181.275 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.92it/s] * GD progress: iter: 50 / bw: 4.794 / grad: 140.022 / stop criter: 181.275 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.92it/s]* GD progress: iter: 51 / bw: 4.789 / grad: -115.884 / stop criter: 70.011 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.92it/s]* GD progress: iter: 51 / bw: 4.789 / grad: -115.884 / stop criter: 70.011 :  48%|████▊     | 48/100 [00:02&lt;00:02, 24.92it/s]* GD progress: iter: 51 / bw: 4.789 / grad: -115.884 / stop criter: 70.011 :  51%|█████     | 51/100 [00:02&lt;00:01, 24.97it/s]* GD progress: iter: 52 / bw: 4.792 / grad: -85.239 / stop criter: 57.942 :  51%|█████     | 51/100 [00:02&lt;00:01, 24.97it/s] * GD progress: iter: 52 / bw: 4.792 / grad: -85.239 / stop criter: 57.942 :  51%|█████     | 51/100 [00:02&lt;00:01, 24.97it/s]* GD progress: iter: 53 / bw: 4.794 / grad: -289.336 / stop criter: 42.619 :  51%|█████     | 51/100 [00:02&lt;00:01, 24.97it/s]* GD progress: iter: 53 / bw: 4.794 / grad: -289.336 / stop criter: 42.619 :  51%|█████     | 51/100 [00:02&lt;00:01, 24.97it/s]* GD progress: iter: 54 / bw: 4.800 / grad: -183.311 / stop criter: 144.668 :  51%|█████     | 51/100 [00:02&lt;00:01, 24.97it/s]* GD progress: iter: 54 / bw: 4.800 / grad: -183.311 / stop criter: 144.668 :  51%|█████     | 51/100 [00:02&lt;00:01, 24.97it/s]* GD progress: iter: 54 / bw: 4.800 / grad: -183.311 / stop criter: 144.668 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 25.08it/s]* GD progress: iter: 55 / bw: 4.803 / grad: -1046.820 / stop criter: 91.655 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 25.08it/s]* GD progress: iter: 55 / bw: 4.803 / grad: -1046.820 / stop criter: 91.655 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 25.08it/s]* GD progress: iter: 56 / bw: 4.824 / grad: -199.866 / stop criter: 523.410 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 25.08it/s]* GD progress: iter: 56 / bw: 4.824 / grad: -199.866 / stop criter: 523.410 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 25.08it/s]* GD progress: iter: 57 / bw: 4.828 / grad: 23.073 / stop criter: 99.933 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 25.08it/s]   * GD progress: iter: 57 / bw: 4.828 / grad: 23.073 / stop criter: 99.933 :  54%|█████▍    | 54/100 [00:02&lt;00:01, 25.08it/s]* GD progress: iter: 57 / bw: 4.828 / grad: 23.073 / stop criter: 99.933 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 24.90it/s]* GD progress: iter: 58 / bw: 4.827 / grad: -212.296 / stop criter: 11.536 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 24.90it/s]* GD progress: iter: 58 / bw: 4.827 / grad: -212.296 / stop criter: 11.536 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 24.90it/s]* GD progress: iter: 59 / bw: 4.830 / grad: -180.273 / stop criter: 106.148 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 24.90it/s]* GD progress: iter: 59 / bw: 4.830 / grad: -180.273 / stop criter: 106.148 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 24.90it/s]* GD progress: iter: 60 / bw: 4.833 / grad: -322.652 / stop criter: 90.136 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 24.90it/s] * GD progress: iter: 60 / bw: 4.833 / grad: -322.652 / stop criter: 90.136 :  57%|█████▋    | 57/100 [00:02&lt;00:01, 24.90it/s]* GD progress: iter: 60 / bw: 4.833 / grad: -322.652 / stop criter: 90.136 :  60%|██████    | 60/100 [00:02&lt;00:01, 25.25it/s]* GD progress: iter: 61 / bw: 4.837 / grad: -462.485 / stop criter: 161.326 :  60%|██████    | 60/100 [00:02&lt;00:01, 25.25it/s]* GD progress: iter: 61 / bw: 4.837 / grad: -462.485 / stop criter: 161.326 :  60%|██████    | 60/100 [00:02&lt;00:01, 25.25it/s]* GD progress: iter: 62 / bw: 4.843 / grad: -173.387 / stop criter: 231.243 :  60%|██████    | 60/100 [00:02&lt;00:01, 25.25it/s]* GD progress: iter: 62 / bw: 4.843 / grad: -173.387 / stop criter: 231.243 :  60%|██████    | 60/100 [00:02&lt;00:01, 25.25it/s]* GD progress: iter: 63 / bw: 4.845 / grad: 197.938 / stop criter: 86.693 :  60%|██████    | 60/100 [00:02&lt;00:01, 25.25it/s]  * GD progress: iter: 63 / bw: 4.845 / grad: 197.938 / stop criter: 86.693 :  60%|██████    | 60/100 [00:02&lt;00:01, 25.25it/s]* GD progress: iter: 63 / bw: 4.845 / grad: 197.938 / stop criter: 86.693 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 25.28it/s]* GD progress: iter: 64 / bw: 4.842 / grad: -67.880 / stop criter: 98.969 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 25.28it/s]* GD progress: iter: 64 / bw: 4.842 / grad: -67.880 / stop criter: 98.969 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 25.28it/s]* GD progress: iter: 65 / bw: 4.843 / grad: -210.943 / stop criter: 33.940 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 25.28it/s]* GD progress: iter: 65 / bw: 4.843 / grad: -210.943 / stop criter: 33.940 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 25.28it/s]* GD progress: iter: 66 / bw: 4.845 / grad: 282.555 / stop criter: 105.472 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 25.28it/s]* GD progress: iter: 66 / bw: 4.845 / grad: 282.555 / stop criter: 105.472 :  63%|██████▎   | 63/100 [00:02&lt;00:01, 25.28it/s]* GD progress: iter: 66 / bw: 4.845 / grad: 282.555 / stop criter: 105.472 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 26.11it/s]* GD progress: iter: 67 / bw: 4.842 / grad: -139.509 / stop criter: 141.277 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 26.11it/s]* GD progress: iter: 67 / bw: 4.842 / grad: -139.509 / stop criter: 141.277 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 26.11it/s]* GD progress: iter: 68 / bw: 4.843 / grad: 312.268 / stop criter: 69.754 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 26.11it/s]  * GD progress: iter: 68 / bw: 4.843 / grad: 312.268 / stop criter: 69.754 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 26.11it/s]* GD progress: iter: 69 / bw: 4.842 / grad: -186.249 / stop criter: 156.134 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 26.11it/s]* GD progress: iter: 69 / bw: 4.842 / grad: -186.249 / stop criter: 156.134 :  66%|██████▌   | 66/100 [00:02&lt;00:01, 26.11it/s]* GD progress: iter: 69 / bw: 4.842 / grad: -186.249 / stop criter: 156.134 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 26.42it/s]* GD progress: iter: 70 / bw: 4.842 / grad: 189.447 / stop criter: 93.125 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 26.42it/s]  * GD progress: iter: 70 / bw: 4.842 / grad: 189.447 / stop criter: 93.125 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 26.42it/s]* GD progress: iter: 71 / bw: 4.842 / grad: -554.000 / stop criter: 94.723 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 26.42it/s]* GD progress: iter: 71 / bw: 4.842 / grad: -554.000 / stop criter: 94.723 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 26.42it/s]* GD progress: iter: 72 / bw: 4.843 / grad: 216.970 / stop criter: 277.000 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 26.42it/s]* GD progress: iter: 72 / bw: 4.843 / grad: 216.970 / stop criter: 277.000 :  69%|██████▉   | 69/100 [00:02&lt;00:01, 26.42it/s]* GD progress: iter: 72 / bw: 4.843 / grad: 216.970 / stop criter: 277.000 :  72%|███████▏  | 72/100 [00:02&lt;00:01, 25.90it/s]* GD progress: iter: 73 / bw: 4.843 / grad: -369.412 / stop criter: 108.485 :  72%|███████▏  | 72/100 [00:02&lt;00:01, 25.90it/s]* GD progress: iter: 73 / bw: 4.843 / grad: -369.412 / stop criter: 108.485 :  72%|███████▏  | 72/100 [00:02&lt;00:01, 25.90it/s]* GD progress: iter: 74 / bw: 4.843 / grad: 167.538 / stop criter: 184.706 :  72%|███████▏  | 72/100 [00:02&lt;00:01, 25.90it/s] * GD progress: iter: 74 / bw: 4.843 / grad: 167.538 / stop criter: 184.706 :  72%|███████▏  | 72/100 [00:02&lt;00:01, 25.90it/s]* GD progress: iter: 75 / bw: 4.843 / grad: 264.259 / stop criter: 83.769 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 25.90it/s] * GD progress: iter: 75 / bw: 4.843 / grad: 264.259 / stop criter: 83.769 :  72%|███████▏  | 72/100 [00:03&lt;00:01, 25.90it/s]* GD progress: iter: 75 / bw: 4.843 / grad: 264.259 / stop criter: 83.769 :  75%|███████▌  | 75/100 [00:03&lt;00:00, 25.17it/s]* GD progress: iter: 76 / bw: 4.843 / grad: -144.536 / stop criter: 132.130 :  75%|███████▌  | 75/100 [00:03&lt;00:00, 25.17it/s]* GD progress: iter: 76 / bw: 4.843 / grad: -144.536 / stop criter: 132.130 :  75%|███████▌  | 75/100 [00:03&lt;00:00, 25.17it/s]* GD progress: iter: 77 / bw: 4.843 / grad: 66.006 / stop criter: 72.268 :  75%|███████▌  | 75/100 [00:03&lt;00:00, 25.17it/s]   * GD progress: iter: 77 / bw: 4.843 / grad: 66.006 / stop criter: 72.268 :  75%|███████▌  | 75/100 [00:03&lt;00:00, 25.17it/s]* GD progress: iter: 78 / bw: 4.843 / grad: 351.271 / stop criter: 33.003 :  75%|███████▌  | 75/100 [00:03&lt;00:00, 25.17it/s]* GD progress: iter: 78 / bw: 4.843 / grad: 351.271 / stop criter: 33.003 :  75%|███████▌  | 75/100 [00:03&lt;00:00, 25.17it/s]* GD progress: iter: 78 / bw: 4.843 / grad: 351.271 / stop criter: 33.003 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 24.72it/s]* GD progress: iter: 79 / bw: 4.843 / grad: -205.904 / stop criter: 175.636 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 24.72it/s]* GD progress: iter: 79 / bw: 4.843 / grad: -205.904 / stop criter: 175.636 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 24.72it/s]* GD progress: iter: 80 / bw: 4.843 / grad: -469.013 / stop criter: 102.952 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 24.72it/s]* GD progress: iter: 80 / bw: 4.843 / grad: -469.013 / stop criter: 102.952 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 24.72it/s]* GD progress: iter: 81 / bw: 4.843 / grad: 89.671 / stop criter: 234.507 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 24.72it/s]  * GD progress: iter: 81 / bw: 4.843 / grad: 89.671 / stop criter: 234.507 :  78%|███████▊  | 78/100 [00:03&lt;00:00, 24.72it/s]* GD progress: iter: 81 / bw: 4.843 / grad: 89.671 / stop criter: 234.507 :  81%|████████  | 81/100 [00:03&lt;00:00, 24.95it/s]* GD progress: iter: 82 / bw: 4.843 / grad: 37.609 / stop criter: 44.836 :  81%|████████  | 81/100 [00:03&lt;00:00, 24.95it/s] * GD progress: iter: 82 / bw: 4.843 / grad: 37.609 / stop criter: 44.836 :  81%|████████  | 81/100 [00:03&lt;00:00, 24.95it/s]* GD progress: iter: 83 / bw: 4.843 / grad: 153.617 / stop criter: 18.804 :  81%|████████  | 81/100 [00:03&lt;00:00, 24.95it/s]* GD progress: iter: 83 / bw: 4.843 / grad: 153.617 / stop criter: 18.804 :  81%|████████  | 81/100 [00:03&lt;00:00, 24.95it/s]* GD progress: iter: 84 / bw: 4.843 / grad: 19.324 / stop criter: 76.809 :  81%|████████  | 81/100 [00:03&lt;00:00, 24.95it/s] * GD progress: iter: 84 / bw: 4.843 / grad: 19.324 / stop criter: 76.809 :  81%|████████  | 81/100 [00:03&lt;00:00, 24.95it/s]* GD progress: iter: 84 / bw: 4.843 / grad: 19.324 / stop criter: 76.809 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 25.73it/s]* GD progress: iter: 85 / bw: 4.843 / grad: -487.424 / stop criter: 9.662 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 25.73it/s]* GD progress: iter: 85 / bw: 4.843 / grad: -487.424 / stop criter: 9.662 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 25.73it/s]* GD progress: iter: 86 / bw: 4.843 / grad: -775.910 / stop criter: 243.712 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 25.73it/s]* GD progress: iter: 86 / bw: 4.843 / grad: -775.910 / stop criter: 243.712 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 25.73it/s]* GD progress: iter: 87 / bw: 4.844 / grad: -302.174 / stop criter: 387.955 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 25.73it/s]* GD progress: iter: 87 / bw: 4.844 / grad: -302.174 / stop criter: 387.955 :  84%|████████▍ | 84/100 [00:03&lt;00:00, 25.73it/s]* GD progress: iter: 87 / bw: 4.844 / grad: -302.174 / stop criter: 387.955 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 25.21it/s]* GD progress: iter: 88 / bw: 4.844 / grad: 228.510 / stop criter: 151.087 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 25.21it/s] * GD progress: iter: 88 / bw: 4.844 / grad: 228.510 / stop criter: 151.087 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 25.21it/s]* GD progress: iter: 89 / bw: 4.844 / grad: -10.154 / stop criter: 114.255 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 25.21it/s]* GD progress: iter: 89 / bw: 4.844 / grad: -10.154 / stop criter: 114.255 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 25.21it/s]* GD progress: iter: 90 / bw: 4.844 / grad: -686.067 / stop criter: 5.077 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 25.21it/s] * GD progress: iter: 90 / bw: 4.844 / grad: -686.067 / stop criter: 5.077 :  87%|████████▋ | 87/100 [00:03&lt;00:00, 25.21it/s]* GD progress: iter: 90 / bw: 4.844 / grad: -686.067 / stop criter: 5.077 :  90%|█████████ | 90/100 [00:03&lt;00:00, 24.82it/s]* GD progress: iter: 91 / bw: 4.844 / grad: -401.530 / stop criter: 343.034 :  90%|█████████ | 90/100 [00:03&lt;00:00, 24.82it/s]* GD progress: iter: 91 / bw: 4.844 / grad: -401.530 / stop criter: 343.034 :  90%|█████████ | 90/100 [00:03&lt;00:00, 24.82it/s]* GD progress: iter: 92 / bw: 4.844 / grad: -277.910 / stop criter: 200.765 :  90%|█████████ | 90/100 [00:03&lt;00:00, 24.82it/s]* GD progress: iter: 92 / bw: 4.844 / grad: -277.910 / stop criter: 200.765 :  90%|█████████ | 90/100 [00:03&lt;00:00, 24.82it/s]* GD progress: iter: 93 / bw: 4.844 / grad: 63.184 / stop criter: 138.955 :  90%|█████████ | 90/100 [00:03&lt;00:00, 24.82it/s]  * GD progress: iter: 93 / bw: 4.844 / grad: 63.184 / stop criter: 138.955 :  90%|█████████ | 90/100 [00:03&lt;00:00, 24.82it/s]* GD progress: iter: 93 / bw: 4.844 / grad: 63.184 / stop criter: 138.955 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.98it/s]* GD progress: iter: 94 / bw: 4.844 / grad: -345.128 / stop criter: 31.592 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.98it/s]* GD progress: iter: 94 / bw: 4.844 / grad: -345.128 / stop criter: 31.592 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.98it/s]* GD progress: iter: 95 / bw: 4.844 / grad: -710.991 / stop criter: 172.564 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.98it/s]* GD progress: iter: 95 / bw: 4.844 / grad: -710.991 / stop criter: 172.564 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.98it/s]* GD progress: iter: 96 / bw: 4.844 / grad: -839.199 / stop criter: 355.495 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.98it/s]* GD progress: iter: 96 / bw: 4.844 / grad: -839.199 / stop criter: 355.495 :  93%|█████████▎| 93/100 [00:03&lt;00:00, 23.98it/s]* GD progress: iter: 96 / bw: 4.844 / grad: -839.199 / stop criter: 355.495 :  96%|█████████▌| 96/100 [00:03&lt;00:00, 23.30it/s]* GD progress: iter: 97 / bw: 4.844 / grad: -465.556 / stop criter: 419.600 :  96%|█████████▌| 96/100 [00:03&lt;00:00, 23.30it/s]* GD progress: iter: 97 / bw: 4.844 / grad: -465.556 / stop criter: 419.600 :  96%|█████████▌| 96/100 [00:03&lt;00:00, 23.30it/s]* GD progress: iter: 98 / bw: 4.844 / grad: -465.902 / stop criter: 232.778 :  96%|█████████▌| 96/100 [00:03&lt;00:00, 23.30it/s]* GD progress: iter: 98 / bw: 4.844 / grad: -465.902 / stop criter: 232.778 :  96%|█████████▌| 96/100 [00:03&lt;00:00, 23.30it/s]* GD progress: iter: 99 / bw: 4.844 / grad: -46.661 / stop criter: 232.951 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.30it/s] * GD progress: iter: 99 / bw: 4.844 / grad: -46.661 / stop criter: 232.951 :  96%|█████████▌| 96/100 [00:04&lt;00:00, 23.30it/s]* GD progress: iter: 99 / bw: 4.844 / grad: -46.661 / stop criter: 232.951 :  99%|█████████▉| 99/100 [00:04&lt;00:00, 23.33it/s]* GD progress: iter: 100 / bw: 4.844 / grad: -684.318 / stop criter: 23.331 :  99%|█████████▉| 99/100 [00:04&lt;00:00, 23.33it/s]* GD progress: iter: 100 / bw: 4.844 / grad: -684.318 / stop criter: 23.331 :  99%|█████████▉| 99/100 [00:04&lt;00:00, 23.33it/s]* GD progress: iter: 100 / bw: 4.844 / grad: -684.318 / stop criter: 23.331 : 100%|██████████| 100/100 [00:04&lt;00:00, 24.60it/s]</code></pre>
</div>
</div>
<p>Now, let’s compare it to the previous example.</p>
<div id="a570f935" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(ker2_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ker2_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :4.844263058634648</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="38e2c4d2-0f03-4aef-9c3b-36cedba1870f" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("38e2c4d2-0f03-4aef-9c3b-36cedba1870f")) {                    Plotly.newPlot(                        "38e2c4d2-0f03-4aef-9c3b-36cedba1870f",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[3.1,3.1,3.1,3.1,3.1,3.190796975300609,3.2685586497062804,3.3892769225601316,3.460230666362759,3.495057929388423,3.572222947801983,3.6142438134849275,3.6946206459750703,3.76260615369768,3.820354077380086,3.849097886537656,3.9045062765232417,3.9709711781782477,4.021183701941493,4.055264003603775,4.098639753880095,4.164119226941318,4.1756636671286405,4.191215373976957,4.2262724405929974,4.263613559739643,4.293204538194923,4.367442216235435,4.4085823555725225,4.424190516371841,4.450659347171858,4.497665452559858,4.5093170586286275,4.516790476985049,4.546176957532497,4.566943484995815,4.578994739091067,4.600642929333484,4.625134090622673,4.645430027296486,4.677088092882616,4.700638907589983,4.70936105074723,4.717074130057875,4.727516541346564,4.742151654627472,4.790874632651303,4.797748415930229,4.7797560664983765,4.793639450007292,4.789349878275869,4.7921899430326445,4.793861158112718,4.799533977504672,4.803128031180939,4.823652326205176,4.827570965970898,4.82711859596555,4.830448473075174,4.832710545047794,4.836759199878787,4.842562484665074,4.844738152003476,4.84225441052826,4.842935823868496,4.844629856506222,4.842360729172555,4.843257018383189,4.841652058852439,4.842417867720789,4.841794703168528,4.843252562237821,4.842795793735268,4.843417945842854,4.843192215270065,4.8429073783674905,4.843063169422658,4.843006252388244,4.84276393274861,4.842905972758132,4.843164806677493,4.843115320020942,4.843098715845999,4.843030894505724,4.843022363019864,4.843237558505568,4.843511607035902,4.8436183336846526,4.843537624960175,4.8435404941366,4.843695576604479,4.8437863405587995,4.843849160799009,4.843834878392189,4.84389729016679,4.844000148619636,4.844121554877794,4.844188906458522,4.844256308167005,4.844263058634648],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,99],"y":[4.844263058634648,4.844263058634648],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.9688526117269296,2.192666437066209,3.4164802624054884,4.640294087744768,5.864107913084047,7.087921738423327,8.311735563762607,9.535549389101885,10.759363214441166,11.983177039780443,13.206990865119725,14.430804690459002,15.654618515798283,16.87843234113756,18.102246166476842,19.326059991816123,20.5498738171554,21.77368764249468,22.99750146783396,24.22131529317324],"y":[21291.80692305744,12237.472101446318,8824.631200357975,7721.729170213916,7576.937248804161,7815.576776310221,8191.227367241188,8597.421435386088,8988.823187284119,9348.078158941455,9670.781985978834,9958.222758830143,10213.862672376416,10441.701883098503,10645.573991436657,10828.888231821988,10994.570794826868,11145.090424360747,11282.512181083777,11408.558799116805],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[4.844263058634648],"y":[7652.781568411059],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,4.844263058634648,4.844263058634648],"y":[7652.781568411059,7652.781568411059,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('38e2c4d2-0f03-4aef-9c3b-36cedba1870f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Compare MSE and MAPE.</p>
<div id="fdac8985" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span> ker2_fit.predict(X_test1)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test1, y_pred2))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test1, y_pred2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9595916657164
8778.146644208395</code></pre>
</div>
</div>
<p>Compare <code>qq-plot</code>.</p>
<div id="0e672936" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ker2_fit.draw_learning_curve(y_test<span class="op">=</span>y_test1, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="2b0ae06c-80f4-44f6-a6e0-f844ff734978" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2b0ae06c-80f4-44f6-a6e0-f844ff734978")) {                    Plotly.newPlot(                        "2b0ae06c-80f4-44f6-a6e0-f844ff734978",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[-86.1230356569171,-76.93078537959221,50.97474276908403,-185.58742012852815,83.16863638863477,-90.52688616312805,106.7414296390276,-83.1668711353292,-90.68700076798308,251.77196635182227,82.46483891991656,138.7099565385106,-785.4985041773948,205.74737281090256,234.08733796134422,99.65445079178966,257.4073600197746,252.0744019100761,282.58366070896284,4.075662544635111,-1.4383377942086182,-77.99553286591986,195.40876245764292,-63.42861805776095,269.7671537124295,-79.63212090078956,7.623249928279979,-172.83566865220624,167.86803350976308,161.31814641350516,1.012696138396318,36.986808507635416,-86.66244946596873,188.21454162011491,-137.07730934117913,335.8629621906082,224.83892912074322,6.689562122057109,-56.40732548978641,256.90086260365547,119.16806186528244,-311.90313492050774,449.719405212038,-5.273418005534807,-682.2517726208913,257.53033801668647,-180.23474761140454,118.92791866285725,57.43877974169241,250.0382388237785,360.15236717559213,24.509499368569035,-240.17406008366015,-80.20711763142226,-117.39315858495162,167.3043482764136,156.88258368709012,503.38808891969575,-2.359944729674296,219.8502470670091,-364.7598965642611,4.679460860474425,-75.22486064859983,109.12028879842379,299.504836784831,-88.4025403000081,-267.29952417235904,34.56784689889023,77.52139720545289,241.71647648043455,50.4138940997371,-387.1266540821292,-330.6772358640141,-197.3753755715616,-62.68381156460539,-93.42259899990464,-356.64061101249047,230.58833397161487,101.96400200258333,53.300829613243415,143.5263907608617,-177.42532862225417,-27.662593611877814,-81.56145585437032,-127.16184323037972,-45.90432935176605,-500.3525641874223,132.1089195718619,12.026788181797016,-433.08197686175987,-168.77035117178357,53.76999260917576,56.013706606124856,322.31170613925116,100.21661071726592,-157.63184805348664,101.98200107858416,-75.09278133091411,283.0624585133832,304.0276830645346,-59.31586771196313,333.13149960451835,-95.74708869034697,8.290931158444915,203.47491215608417,114.56466032321784,333.8626841254291,357.80969970716876,-84.61741093321766,-381.7510297976623,18.55876463310474,58.0457815525275,-58.22106616080463,252.97671489700187,269.4211393726558,34.27588990746599,14.472912832578388,679.8215808158232,-224.09264153113,11.058254500037204,-52.45737342696991,254.60530898583946,-440.56886982785585,-90.19439849446908,-107.45231767645645,-453.56988739048666,-239.43368223562734,-5.864023829616331,-240.32733204895217,-108.97223267966469,-212.90949863731777,-70.99687844198822,113.15803408160996,186.19729205548438,54.55914076446016,74.19403312187146,281.1020991635118,-310.09699390663775,-174.7178714544378,-64.7108110667626,-253.6002052436947,186.74228860367998,218.08338904303375,-146.39803399782969,-199.30899629964262,37.6328469504373,-309.32604315485764,-69.91078606235617,-66.96698503915368,-21.881637458920157,-424.73748378123884,-39.836585771011386,101.2918249980767,-88.95821250796081,130.29777634958518,-12.892766172371633,294.986552741984,23.48029481056667,35.863454330816126,-288.05434276897984,411.42999517675463,165.95675067824746,-35.76580712665841,-133.66082315095554,-41.92721601941911,-186.20202260875996,-164.98290488745837,-128.5264909339381,165.5152806193353,253.8546912064182,-185.03048205979212,-338.0828394521503,-21.95067349933645,115.3028516429631,-157.12591594393618,27.53388232663615,-151.12858547039318,371.8339037545842,75.96798996233677,135.27701128861685,-19.19976774939901,-104.05648243195407,50.956246878921895,-2.6905747234882806,-216.16518343683305,24.18998533475998,-36.93788910844318,417.86886834432136,-180.25822794638316,-90.28551854014144,6.943188886615214,116.11089629545486,-198.3982822728782,162.97177270500052,392.6214383422561,-120.76983081402558,-21.068089597542173,-375.3870256227878,68.69428524824858,365.59160496084303],"xaxis":"x","y":[-86.1230356569171,-76.93078537959221,50.97474276908403,-185.58742012852815,83.16863638863477,-90.52688616312805,106.7414296390276,-83.1668711353292,-90.68700076798308,251.77196635182227,82.46483891991656,138.7099565385106,-785.4985041773948,205.74737281090256,234.08733796134422,99.65445079178966,257.4073600197746,252.0744019100761,282.58366070896284,4.075662544635111,-1.4383377942086182,-77.99553286591986,195.40876245764292,-63.42861805776095,269.7671537124295,-79.63212090078956,7.623249928279979,-172.83566865220624,167.86803350976308,161.31814641350516,1.012696138396318,36.986808507635416,-86.66244946596873,188.21454162011491,-137.07730934117913,335.8629621906082,224.83892912074322,6.689562122057109,-56.40732548978641,256.90086260365547,119.16806186528244,-311.90313492050774,449.719405212038,-5.273418005534807,-682.2517726208913,257.53033801668647,-180.23474761140454,118.92791866285725,57.43877974169241,250.0382388237785,360.15236717559213,24.509499368569035,-240.17406008366015,-80.20711763142226,-117.39315858495162,167.3043482764136,156.88258368709012,503.38808891969575,-2.359944729674296,219.8502470670091,-364.7598965642611,4.679460860474425,-75.22486064859983,109.12028879842379,299.504836784831,-88.4025403000081,-267.29952417235904,34.56784689889023,77.52139720545289,241.71647648043455,50.4138940997371,-387.1266540821292,-330.6772358640141,-197.3753755715616,-62.68381156460539,-93.42259899990464,-356.64061101249047,230.58833397161487,101.96400200258333,53.300829613243415,143.5263907608617,-177.42532862225417,-27.662593611877814,-81.56145585437032,-127.16184323037972,-45.90432935176605,-500.3525641874223,132.1089195718619,12.026788181797016,-433.08197686175987,-168.77035117178357,53.76999260917576,56.013706606124856,322.31170613925116,100.21661071726592,-157.63184805348664,101.98200107858416,-75.09278133091411,283.0624585133832,304.0276830645346,-59.31586771196313,333.13149960451835,-95.74708869034697,8.290931158444915,203.47491215608417,114.56466032321784,333.8626841254291,357.80969970716876,-84.61741093321766,-381.7510297976623,18.55876463310474,58.0457815525275,-58.22106616080463,252.97671489700187,269.4211393726558,34.27588990746599,14.472912832578388,679.8215808158232,-224.09264153113,11.058254500037204,-52.45737342696991,254.60530898583946,-440.56886982785585,-90.19439849446908,-107.45231767645645,-453.56988739048666,-239.43368223562734,-5.864023829616331,-240.32733204895217,-108.97223267966469,-212.90949863731777,-70.99687844198822,113.15803408160996,186.19729205548438,54.55914076446016,74.19403312187146,281.1020991635118,-310.09699390663775,-174.7178714544378,-64.7108110667626,-253.6002052436947,186.74228860367998,218.08338904303375,-146.39803399782969,-199.30899629964262,37.6328469504373,-309.32604315485764,-69.91078606235617,-66.96698503915368,-21.881637458920157,-424.73748378123884,-39.836585771011386,101.2918249980767,-88.95821250796081,130.29777634958518,-12.892766172371633,294.986552741984,23.48029481056667,35.863454330816126,-288.05434276897984,411.42999517675463,165.95675067824746,-35.76580712665841,-133.66082315095554,-41.92721601941911,-186.20202260875996,-164.98290488745837,-128.5264909339381,165.5152806193353,253.8546912064182,-185.03048205979212,-338.0828394521503,-21.95067349933645,115.3028516429631,-157.12591594393618,27.53388232663615,-151.12858547039318,371.8339037545842,75.96798996233677,135.27701128861685,-19.19976774939901,-104.05648243195407,50.956246878921895,-2.6905747234882806,-216.16518343683305,24.18998533475998,-36.93788910844318,417.86886834432136,-180.25822794638316,-90.28551854014144,6.943188886615214,116.11089629545486,-198.3982822728782,162.97177270500052,392.6214383422561,-120.76983081402558,-21.068089597542173,-375.3870256227878,68.69428524824858,365.59160496084303],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-56.14264219915389,-68.21358749958223,69.470423045897,-102.9071337738875,99.59370623194258,-62.997545461417005,1.7673057955804932,-33.878325059401114,-51.5151471464074,148.31055215062395,22.382304309073273,84.21769261926245,-417.2914452502136,107.87672720558523,142.58750571431628,61.92154443020494,161.30383170949975,117.46134383646294,184.22424359168713,37.537971591611274,58.69732139378184,-81.32686055640684,137.78583990252278,-52.42567989141824,175.46247115472266,23.149299390698918,24.99461990170975,-103.3198119498275,102.29482548711199,123.28008132459836,-7.26253990771393,5.375866291598923,-18.31326003808819,114.60991717215494,-67.44352695621487,221.94804231741435,140.76659218140472,19.81992588757224,-24.897308639859933,152.27437348609598,105.96919622667896,-184.5270159234529,251.7291978453336,-11.468722143425174,-336.2517049029103,249.35742426050436,-125.62944264062706,57.55994377548963,-25.892085300605498,161.68091327931796,201.5875198127227,13.738961576699651,-214.49218261843262,-22.639403769332073,-115.14535112534409,106.1734290646961,81.77517763277386,251.31907267563457,-17.119096733358006,124.39323307058581,-266.3794082056446,-8.600877772358352,-16.493587553605593,0.9470673372697781,243.37805853283803,-67.79269876448572,-133.21414789147363,-17.15311787368217,58.99402959416632,138.24630390754336,21.754065404021098,-240.37199428997224,-212.2774278411529,-93.47578083660238,114.70892974996522,-139.2734513081275,-217.45095097997176,154.4605476733019,58.00742636287931,-23.6810525428324,145.66997279939562,-149.24673635680068,-10.50477579271027,-42.358365487680906,-93.56069809661045,-68.49314067691472,-325.1334891875107,45.33145905882219,-1.148609567835498,-247.9916026943402,-73.06801731535575,-12.321262864583709,13.961942473565772,223.14419120557022,95.49296178163699,-103.01387331216522,39.97781060221239,-74.5203207893957,168.27286450900903,207.47442913339827,-90.3430013641366,241.11914912798363,-93.39428977339965,11.979430901994212,84.92697347733245,118.28426794246086,165.58209626841833,242.54905380938743,-1.3716783515927116,-270.87113936775836,-24.832578567376395,-7.451631275814847,-30.235616587601058,153.92822927472943,143.11677628683083,-33.62779991178694,-9.127722712888694,352.5591185666859,-161.9967836093285,2.8937879131265882,-28.10672154260067,138.5335344033568,-292.5304069330177,-83.13396241977578,-38.56173083732352,-193.31015915662144,-154.28338912461572,-10.885111320819579,-166.87223828011415,-60.66820149274866,-88.97558212509405,-86.92265252006924,94.66108713452299,132.6639683374245,-3.6057702194883356,21.622155726372757,273.115573265497,-218.44449296207154,-138.4340362724398,-47.754544437880426,-118.83053045484999,135.72193360271268,111.96916569803348,-60.156622339841896,-133.32188796376334,76.65350358449328,-217.0586657130099,-35.224565606534334,-106.94774822773095,-23.90769764315915,-320.89320820233684,-77.8007235736848,67.98855047466245,-37.86123293781082,80.3616895340569,-59.966179762510784,246.60422136793744,37.635001633532944,23.748332827852096,-266.94769741763616,232.05929948338925,55.68749095077326,-124.69191763682966,-64.59124831970267,-43.03944552592371,-117.42071590847735,-138.4805248516276,-54.43246868883876,127.47670073427668,128.35991506208973,-136.5065567057422,-208.25760144371012,15.979284986925038,57.522928485593404,-37.261233226710345,-0.43656902723687363,-62.85083146299701,160.04663435444402,33.4572322094608,-9.727570187598323,-47.83995568116895,-28.37586942709773,41.855366074309536,-29.817645828967176,-148.70112137281714,82.50285828752328,-26.303546175525454,166.7175131985759,-90.03894154396455,-20.84262838034604,-23.982117156938894,71.89591734305618,-103.4424889996368,118.94524062948285,245.02854237895346,-67.91115476480468,-47.56993841012706,-298.1984315623304,20.462087484216458,261.97247827210526],"xaxis":"x","y":[-86.1230356569171,-76.93078537959221,50.97474276908403,-185.58742012852815,83.16863638863477,-90.52688616312805,106.7414296390276,-83.1668711353292,-90.68700076798308,251.77196635182227,82.46483891991656,138.7099565385106,-785.4985041773948,205.74737281090256,234.08733796134422,99.65445079178966,257.4073600197746,252.0744019100761,282.58366070896284,4.075662544635111,-1.4383377942086182,-77.99553286591986,195.40876245764292,-63.42861805776095,269.7671537124295,-79.63212090078956,7.623249928279979,-172.83566865220624,167.86803350976308,161.31814641350516,1.012696138396318,36.986808507635416,-86.66244946596873,188.21454162011491,-137.07730934117913,335.8629621906082,224.83892912074322,6.689562122057109,-56.40732548978641,256.90086260365547,119.16806186528244,-311.90313492050774,449.719405212038,-5.273418005534807,-682.2517726208913,257.53033801668647,-180.23474761140454,118.92791866285725,57.43877974169241,250.0382388237785,360.15236717559213,24.509499368569035,-240.17406008366015,-80.20711763142226,-117.39315858495162,167.3043482764136,156.88258368709012,503.38808891969575,-2.359944729674296,219.8502470670091,-364.7598965642611,4.679460860474425,-75.22486064859983,109.12028879842379,299.504836784831,-88.4025403000081,-267.29952417235904,34.56784689889023,77.52139720545289,241.71647648043455,50.4138940997371,-387.1266540821292,-330.6772358640141,-197.3753755715616,-62.68381156460539,-93.42259899990464,-356.64061101249047,230.58833397161487,101.96400200258333,53.300829613243415,143.5263907608617,-177.42532862225417,-27.662593611877814,-81.56145585437032,-127.16184323037972,-45.90432935176605,-500.3525641874223,132.1089195718619,12.026788181797016,-433.08197686175987,-168.77035117178357,53.76999260917576,56.013706606124856,322.31170613925116,100.21661071726592,-157.63184805348664,101.98200107858416,-75.09278133091411,283.0624585133832,304.0276830645346,-59.31586771196313,333.13149960451835,-95.74708869034697,8.290931158444915,203.47491215608417,114.56466032321784,333.8626841254291,357.80969970716876,-84.61741093321766,-381.7510297976623,18.55876463310474,58.0457815525275,-58.22106616080463,252.97671489700187,269.4211393726558,34.27588990746599,14.472912832578388,679.8215808158232,-224.09264153113,11.058254500037204,-52.45737342696991,254.60530898583946,-440.56886982785585,-90.19439849446908,-107.45231767645645,-453.56988739048666,-239.43368223562734,-5.864023829616331,-240.32733204895217,-108.97223267966469,-212.90949863731777,-70.99687844198822,113.15803408160996,186.19729205548438,54.55914076446016,74.19403312187146,281.1020991635118,-310.09699390663775,-174.7178714544378,-64.7108110667626,-253.6002052436947,186.74228860367998,218.08338904303375,-146.39803399782969,-199.30899629964262,37.6328469504373,-309.32604315485764,-69.91078606235617,-66.96698503915368,-21.881637458920157,-424.73748378123884,-39.836585771011386,101.2918249980767,-88.95821250796081,130.29777634958518,-12.892766172371633,294.986552741984,23.48029481056667,35.863454330816126,-288.05434276897984,411.42999517675463,165.95675067824746,-35.76580712665841,-133.66082315095554,-41.92721601941911,-186.20202260875996,-164.98290488745837,-128.5264909339381,165.5152806193353,253.8546912064182,-185.03048205979212,-338.0828394521503,-21.95067349933645,115.3028516429631,-157.12591594393618,27.53388232663615,-151.12858547039318,371.8339037545842,75.96798996233677,135.27701128861685,-19.19976774939901,-104.05648243195407,50.956246878921895,-2.6905747234882806,-216.16518343683305,24.18998533475998,-36.93788910844318,417.86886834432136,-180.25822794638316,-90.28551854014144,6.943188886615214,116.11089629545486,-198.3982822728782,162.97177270500052,392.6214383422561,-120.76983081402558,-21.068089597542173,-375.3870256227878,68.69428524824858,365.59160496084303],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2b0ae06c-80f4-44f6-a6e0-f844ff734978');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><p><a href="https://jdssv.org/index.php/jdssv/article/view/70">S. Has (2023). A Gradient COBRA: A kernel-based consensual aggregation for regression. Journal of Data Science, Statistics, and Visualisation, 3(2).</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.jmva.2015.04.007">G. Biau, A. Fischer, B. Guedj and J. D. Malley (2016), COBRA: A combined regression strategy, Journal of Multivariate Analysis.</a></p></li>
<li><p><a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California Housing Prices</a></p></li>
</ul>
<section id="read-also" class="level3">
<h3 class="anchored" data-anchor-id="read-also">Read also:</h3>
<ul>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/gradientcobra.html">GradientCOBRA</a></p></li>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/superlearner.html">SuperLearner</a></p></li>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/MixCOBRARegressor.html">MixCOBRARegressor</a></p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
