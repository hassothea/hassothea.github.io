<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.358">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sothea HAS">

<title> GradientCobra Python Library</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="gradientcobra_files/libs/clipboard/clipboard.min.js"></script>
<script src="gradientcobra_files/libs/quarto-html/quarto.js"></script>
<script src="gradientcobra_files/libs/quarto-html/popper.min.js"></script>
<script src="gradientcobra_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="gradientcobra_files/libs/quarto-html/anchor.min.js"></script>
<link href="gradientcobra_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="gradientcobra_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="gradientcobra_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="gradientcobra_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="gradientcobra_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.27.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><img src="gradientcobra_logo.svg" class="img-fluid" style="width:1.38889in"> GradientCobra Python Library</h1>
            <p class="subtitle lead"><strong>Class <a href="https://jdssv.org/index.php/jdssv/article/view/70">GradientCOBRA</a></strong></p>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p><a href="https://hassothea.github.io/">Sothea HAS</a> </p>
                      </div>
          </div>
                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-gradientcobra-method" id="toc-introduction-to-gradientcobra-method" class="nav-link active" data-scroll-target="#introduction-to-gradientcobra-method">Introduction to GradientCOBRA method</a></li>
  <li><a href="#gradientcobra-method" id="toc-gradientcobra-method" class="nav-link" data-scroll-target="#gradientcobra-method">GradientCOBRA method</a>
  <ul class="collapse">
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#returns" id="toc-returns" class="nav-link" data-scroll-target="#returns">Returns:</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods:</a></li>
  </ul></li>
  <li><a href="#installation-of-the-library-from-pypi" id="toc-installation-of-the-library-from-pypi" class="nav-link" data-scroll-target="#installation-of-the-library-from-pypi">Installation of the library from <code>pypi</code></a></li>
  <li><a href="#implementation-of-the-method" id="toc-implementation-of-the-method" class="nav-link" data-scroll-target="#implementation-of-the-method">Implementation of the method</a>
  <ul class="collapse">
  <li><a href="#importing-some-packages" id="toc-importing-some-packages" class="nav-link" data-scroll-target="#importing-some-packages">Importing some packages</a></li>
  <li><a href="#gradientcobra-on-simulated-data" id="toc-gradientcobra-on-simulated-data" class="nav-link" data-scroll-target="#gradientcobra-on-simulated-data"><code>GradientCOBRA</code> on simulated data</a></li>
  <li><a href="#gradientcobra-on-real-dataset" id="toc-gradientcobra-on-real-dataset" class="nav-link" data-scroll-target="#gradientcobra-on-real-dataset"><code>GradientCOBRA</code> on real dataset</a></li>
  <li><a href="#a-comparison-with-adaboost" id="toc-a-comparison-with-adaboost" class="nav-link" data-scroll-target="#a-comparison-with-adaboost">A comparison with <code>Adaboost</code></a></li>
  <li><a href="#pretrained-basic-estimators" id="toc-pretrained-basic-estimators" class="nav-link" data-scroll-target="#pretrained-basic-estimators">Pretrained basic estimators</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a>
  <ul class="collapse">
  <li><a href="#read-also" id="toc-read-also" class="nav-link" data-scroll-target="#read-also">Read also:</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  

<section id="introduction-to-gradientcobra-method" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-gradientcobra-method">Introduction to <a href="https://jdssv.org/index.php/jdssv/article/view/70">GradientCOBRA</a> method</h2>
<p><code>GradientCOBRA</code> is a consensual aggregation method that combines a given number of regressors based on their predicted features (<a href="https://jdssv.org/index.php/jdssv/article/view/70">Has, 2023</a>). The method is summarized in the following figure.</p>
<p><img src="gradientcobra_summary.jpg" class="img-fluid" style="width:6.25in"></p>
<p>where</p>
<ul>
<li><span class="math inline">\({\bf r}(x)=(r_1(x),\dots, r_M(x))\)</span> is the predicted features of observation <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(K:\mathbb{R}_+\to\mathbb{R}_+\)</span> is a regular kernel function that converts the “closeness” between predicted features of observation <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x\)</span> into the associated weight for the aggregation. For any smoothing parameter <span class="math inline">\(h&gt;0\)</span>, <span class="math inline">\(K_h(t)=K(t/h)\)</span>.</li>
</ul>
<p>Constructing a consensual aggregation method is equivalent to estimating an appropriate smoothing parameter <span class="math inline">\(h\)</span> that minimizes the so-called <span class="math inline">\(\kappa\)</span>-fold cross validation error:</p>
<p><span class="math display">\[\phi(h)=\frac{1}{\kappa}\sum_{j=1}^{\kappa}\sum_{(x_i,y_i)\in F_j}\ell(\hat{y}_{-F_j}(x_i),y_i)\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\ell\)</span> is any regression loss function. By default, <span class="math inline">\(\ell(y_1,y_2)=(y_1-y_2)^2\)</span>.</li>
<li><span class="math inline">\((F_j)_{j=1,2,\dots,\kappa}\)</span> are the <span class="math inline">\(\kappa\)</span> folds of the second of the training data used for aggregation.</li>
<li><span class="math inline">\(\hat{y}_{-F_j}(x)\)</span> is the prediction of <span class="math inline">\(x\)</span> by aggregating predicted features on all folds <span class="math inline">\((F_k)_{k}\)</span> except for <span class="math inline">\(F_j\)</span>.</li>
</ul>
<hr>
</section>
<section id="gradientcobra-method" class="level2">
<h2 class="anchored" data-anchor-id="gradientcobra-method">GradientCOBRA method</h2>
<p><code>class</code> <strong>GradientCOBRA</strong>(<em>random_state = None, learning_rate = 0.01, bandwidth_list = None, speed = ‘constant’, estimator_list = None, estimator_params = None, opt_method = “grad”, max_iter = int(300), opt_params = None, kernel = ‘radial’, kernel_exponent = 1.0, show_progress = True, loss_function = None, loss_weight = None, norm_constant = None</em>):</p>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">Parameters</h3>
<hr>
<ul>
<li><p><code>random_state</code>: (default is <code>None</code>) for setting the random state of all the random generators in the class. This allows the method to produce the same result when the same <code>random_state</code> is used.</p></li>
<li><p><code>learning_rate</code>: (default is <code>0.1</code>) the learning rate in gradient descent algorithm for estimating the optimal bandwidth.</p></li>
<li><p><code>bandwidth_list</code>: a list of bandwidth parameters for grid search algorithm (<code>default = np.linspace(0.00001, 10, 300)</code>).</p></li>
<li><p><code>speed</code>: (default is <code>constant</code>) for adjusting the speed of the learning rate. It is helpful when the cost function is flat around the optimal value, changing the learning speed might help the algorithm to converge faster. It should be an element of <em>[‘constant’, ‘linear’, ‘log’, ‘sqrt_root’, ‘quad’, ‘exp’]</em>.</p></li>
<li><p><code>estimator_list</code>: (default is None) the list of intial estimators (machines as addressed in <a href="https://www.sciencedirect.com/science/article/pii/S0047259X15000950">Biau et al.&nbsp;(2016)</a>). If it is <code>None</code>, the intial learners including <em>‘linear_regression’, ‘ridge’, ‘lasso’, ‘tree’</em>, and <em>‘random_forest’</em> are used with their default parameters. This argument should be a sublist of the following list: <em>[‘linear_regression’, ‘knn’, ‘ridge’, ‘lasso’, ‘tree’, ‘random_forest’, ‘svm’, ‘sgd’, ‘bayesian_ridge’, ‘adaboost’, ‘gradient_boost’]</em>.</p></li>
<li><p><code>estimator_params</code>: (default is <code>None</code>) is a dictionary containing the parameters of the basic estimators given in the <code>estimator_list</code> argument. It must be a dictionary with:</p>
<ul>
<li><code>key</code> : the name of the basic estimator defined in <code>estimator_list</code>,</li>
<li><code>value</code> : a dictionary with <em>(key, value) = (parameter, value)</em>.</li>
</ul></li>
<li><p><code>opt_method</code>: (default is “<code>grad</code>”) is an optimization algorithm for estimating the bandwidth parameter. It should be either “<code>grid</code>” (grid search) or “<code>grad</code>” (gradient descent for non-compactly supported kernels).</p></li>
<li><p><code>max_iter</code>: (default = <code>100</code>) maximum iteration of gradient descent algorithm.</p></li>
<li><p><code>opt_params</code>: (default is <code>None</code>) is a dictionary of additional parameters for the optimization algorithm (both grid search and gradient descent). Its should contain some of the following keys:</p>
<ul>
<li>‘<em>epsilon</em>’: stopping criterion for gradient descent algorithm (<code>default =</code> <span class="math inline">\(10^{-6}\)</span>).</li>
<li>‘<em>n_tries</em>’: the number of tries for selecting initial position of gradient descent algorithm (<code>default = 10</code>)</li>
<li>‘<em>start</em>’: the initial value of the bandwidth parameter (<code>default = None</code>)</li>
<li>‘<em>n_cv</em>’: number of cross-validation folds (<code>default = 10</code>)</li>
<li>‘precision’ : the precision to estimate the gradient for gradient descent algorithm (<code>default =</code> <span class="math inline">\(10^{-10}\)</span>).</li>
</ul></li>
<li><p><code>kernel</code>: (default is <code>'radial'</code>) the kernel function used for the aggregation. It should be an element of the list <em>[‘exponential’, ‘gaussian’, ‘radial’, ‘cauchy’, ‘reverse_cosh’,‘epanechnikov’,‘biweight’, ‘triweight’, ‘triangular’, ‘cobra’, ‘naive’]</em>. Some options such as <code>'gaussian'</code> and <code>'radial'</code> lead to the same radial kernel function. For <code>'cobra'</code> or <code>'naive'</code>, they correspond to COBRA method by <a href="https://www.sciencedirect.com/science/article/pii/S0047259X15000950">Biau et al.&nbsp;(2016)</a>.</p></li>
<li><p><code>kernel_exponent</code>: (default is <code>1.0</code>) is an exponential <span class="math inline">\(\alpha\)</span> of the exponential and radial kernel function i.e., <span class="math inline">\(K(x) = \exp(|x|^{2\alpha})\)</span>. By default, <code>alpha = 1.0</code>.</p></li>
<li><p><code>show_progress</code>: (default is <code>True</code>) a boolean defining whether or not to show the progress of the optimization algorithm for both grid search and gradient descent.</p></li>
<li><p><code>loss_function</code>: (default is <code>None</code>) a function or string defining the cost function to be optimized for estimating the optimal bandwidth parameter. By defalut, the K-Fold cross-validation MSE is used. Otherwise, it must be either:</p>
<ul>
<li>a function of two argumetns (y_true, y_pred) or</li>
<li>a string element of the list <em>[‘mse’, ‘mae’, ‘mape’, ‘weighted_mse’]</em>. If it is <code>weighted_mse</code>, one can define the weight for each training point using <code>loss_weight</code> argument below.
<ul>
<li><code>loss_weight</code>: (default is <code>None</code>) a list of size <span class="math inline">\(n\)</span> (number of training observations) defining the weight for each individual data point for the loss function. If it is <code>None</code> and the <code>loss_function = weighted_mse</code>, then a normalized weight <span class="math inline">\(W(i) = 1/\text{PDF}(i)\)</span> is assigned to the individual <span class="math inline">\(i\)</span> of the training data.</li>
</ul></li>
</ul></li>
<li><p><code>norm_constant</code>: (default is <code>None</code>) a normalized constant used to scale the features in optimization algorithm. By defalut, they are</p></li>
</ul>
</section>
<section id="returns" class="level3">
<h3 class="anchored" data-anchor-id="returns">Returns:</h3>
<hr>
<ul>
<li><code>self</code> : returns an instance of self containing the optimal estimated bandwidth and other results of the algorithm.</li>
</ul>
</section>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">Methods:</h3>
<hr>
<ul>
<li><code>fit</code> : fitting the aggregation method on the design features (original data or predicted features).</li>
<li><code>split_data</code> : to split the data into <span class="math inline">\(D_k = \{(X_k,y_k)\}\)</span> and <span class="math inline">\(D_{\ell} = \{(X_\ell,y_\ell)\}\)</span> to train the basic estimators and perform aggregation respectively.</li>
<li><code>build_basic_estimators</code> : build basic estimators for the aggregation. It is also possible to set the values of (hyper)parameters for each estimators.</li>
<li><code>load_predictions</code> : to make predictions using the constructed basic estimators.</li>
<li><code>distances</code> : to construct distance matrix according to the kernel function used for the aggregation.</li>
<li><code>kappa_cross_validation_error</code> : the objective function to be minimized.</li>
<li><code>optimize_bandwidth</code> : the optimization method used to estimate the optimal bendwidth parameter.</li>
<li><code>predict</code> : for building prediction on the new observations using any given bendwidth or the estimated one.</li>
<li><code>draw_learning_curve</code> : for plotting the graphic of learning algorithm (error vs parameter).</li>
</ul>
<hr>
</section>
</section>
<section id="installation-of-the-library-from-pypi" class="level2">
<h2 class="anchored" data-anchor-id="installation-of-the-library-from-pypi">Installation of the library from <code>pypi</code></h2>
<p><a href="https://pypi.org/project/gradientcobra/">gradientcobra</a> can be installed from <a href="https://pypi.org/">pypi</a> using <code>pip</code>:</p>
<blockquote class="blockquote">
<p><code>pip install gradientcobra</code></p>
</blockquote>
<hr>
</section>
<section id="implementation-of-the-method" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-the-method">Implementation of the method</h2>
<section id="importing-some-packages" class="level3">
<h3 class="anchored" data-anchor-id="importing-some-packages">Importing some packages</h3>
<div id="6a1c12f6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Metric of error</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, mean_absolute_percentage_error</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting figures</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Import class GradientCOBRA from the gradientcobra library</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gradientcobra.gradientcobra <span class="im">import</span> GradientCOBRA</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gradientcobra-on-simulated-data" class="level3">
<h3 class="anchored" data-anchor-id="gradientcobra-on-simulated-data"><code>GradientCOBRA</code> on simulated data</h3>
<p>We simulate a regression data with <span class="math inline">\(1000\)</span> observations and <span class="math inline">\(10\)</span> inputs variables.</p>
<div id="30db214b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For simulating dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_regression</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>X1, y1 <span class="op">=</span> make_regression(n_samples<span class="op">=</span><span class="dv">1000</span>, n_features<span class="op">=</span><span class="dv">10</span>, noise<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s randomly split the simulated data into <span class="math inline">\(80\%-20\%\)</span> training-testing data.</p>
<div id="ca4b0878" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>X_train1, X_test1, y_train1, y_test1 <span class="op">=</span> train_test_split(X1, y1, test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'shape: x_train = </span><span class="sc">{}</span><span class="st"> , x_train = </span><span class="sc">{}</span><span class="st"> , y_train = </span><span class="sc">{}</span><span class="st"> , y_test = </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    X_train1.shape, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    X_test1.shape, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    y_train1.shape, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    y_test1.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: x_train = (800, 10) , x_train = (200, 10) , y_train = (800,) , y_test = (200,)</code></pre>
</div>
</div>
<section id="bullet-gradientcobra-with-default-parameters" class="level4">
<h4 class="anchored" data-anchor-id="bullet-gradientcobra-with-default-parameters"><span class="math inline">\(\bullet\)</span> <code>GradientCOBRA</code> with default parameters</h4>
<p>We create <code>GradientCOBRA</code> object called <code>gc1</code> using <code>GradientCOBRA</code> class with the default parameters, then fit it to the training data.</p>
<div id="49b24459" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gc1 <span class="op">=</span> GradientCOBRA()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>gc1_fit <span class="op">=</span> gc1.fit(X_train1, y_train1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: -19.389 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -19.389 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.100 / grad: -84.857 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.100 / grad: -84.857 / stop criter: 19.389 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.538 / grad: -12.805 / stop criter: 84.857 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.538 / grad: -12.805 / stop criter: 84.857 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 3.604 / grad: -17.871 / stop criter: 12.805 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 3.604 / grad: -17.871 / stop criter: 12.805 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 3.696 / grad: -20.533 / stop criter: 17.871 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 3.696 / grad: -20.533 / stop criter: 17.871 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 3.802 / grad: 29.665 / stop criter: 20.533 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 9 / bw: 3.802 / grad: 29.665 / stop criter: 20.533 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 3.649 / grad: -42.539 / stop criter: 29.665 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 3.649 / grad: -42.539 / stop criter: 29.665 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 11 / bw: 3.866 / grad: -15.752 / stop criter: 42.539 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 11 / bw: 3.866 / grad: -15.752 / stop criter: 42.539 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 12 / bw: 3.946 / grad: 91.348 / stop criter: 15.752 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 12 / bw: 3.946 / grad: 91.348 / stop criter: 15.752 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 12 / bw: 3.946 / grad: 91.348 / stop criter: 15.752 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 13 / bw: 3.484 / grad: 27.631 / stop criter: 91.348 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 13 / bw: 3.484 / grad: 27.631 / stop criter: 91.348 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 14 / bw: 3.346 / grad: -77.736 / stop criter: 27.631 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 14 / bw: 3.346 / grad: -77.736 / stop criter: 27.631 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 15 / bw: 3.735 / grad: 45.085 / stop criter: 77.736 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s] * GD progress: iter: 15 / bw: 3.735 / grad: 45.085 / stop criter: 77.736 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 16 / bw: 3.511 / grad: -38.421 / stop criter: 45.085 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 16 / bw: 3.511 / grad: -38.421 / stop criter: 45.085 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 17 / bw: 3.700 / grad: 16.647 / stop criter: 38.421 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s] * GD progress: iter: 17 / bw: 3.700 / grad: 16.647 / stop criter: 38.421 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 18 / bw: 3.619 / grad: -48.544 / stop criter: 16.647 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 18 / bw: 3.619 / grad: -48.544 / stop criter: 16.647 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 19 / bw: 3.852 / grad: -83.813 / stop criter: 48.544 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 19 / bw: 3.852 / grad: -83.813 / stop criter: 48.544 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 20 / bw: 4.251 / grad: 71.178 / stop criter: 83.813 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s] * GD progress: iter: 20 / bw: 4.251 / grad: 71.178 / stop criter: 83.813 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 21 / bw: 3.912 / grad: -19.918 / stop criter: 71.178 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 21 / bw: 3.912 / grad: -19.918 / stop criter: 71.178 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 22 / bw: 4.006 / grad: -31.498 / stop criter: 19.918 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 22 / bw: 4.006 / grad: -31.498 / stop criter: 19.918 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 23 / bw: 4.153 / grad: -8.174 / stop criter: 31.498 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s] * GD progress: iter: 23 / bw: 4.153 / grad: -8.174 / stop criter: 31.498 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 24 / bw: 4.191 / grad: 49.798 / stop criter: 8.174 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s] * GD progress: iter: 24 / bw: 4.191 / grad: 49.798 / stop criter: 8.174 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 25 / bw: 3.959 / grad: -4.718 / stop criter: 49.798 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 25 / bw: 3.959 / grad: -4.718 / stop criter: 49.798 :   4%|▍         | 12/300 [00:00&lt;00:02, 119.45it/s]* GD progress: iter: 25 / bw: 3.959 / grad: -4.718 / stop criter: 49.798 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 26 / bw: 3.981 / grad: 32.786 / stop criter: 4.718 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s] * GD progress: iter: 26 / bw: 3.981 / grad: 32.786 / stop criter: 4.718 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 27 / bw: 3.831 / grad: 6.176 / stop criter: 32.786 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 27 / bw: 3.831 / grad: 6.176 / stop criter: 32.786 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 28 / bw: 3.803 / grad: -17.235 / stop criter: 6.176 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 28 / bw: 3.803 / grad: -17.235 / stop criter: 6.176 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 29 / bw: 3.881 / grad: -54.019 / stop criter: 17.235 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 29 / bw: 3.881 / grad: -54.019 / stop criter: 17.235 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 30 / bw: 4.123 / grad: -51.531 / stop criter: 54.019 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 30 / bw: 4.123 / grad: -51.531 / stop criter: 54.019 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 31 / bw: 4.354 / grad: 71.170 / stop criter: 51.531 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s] * GD progress: iter: 31 / bw: 4.354 / grad: 71.170 / stop criter: 51.531 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 32 / bw: 4.035 / grad: -101.614 / stop criter: 71.170 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 32 / bw: 4.035 / grad: -101.614 / stop criter: 71.170 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 33 / bw: 4.486 / grad: -57.542 / stop criter: 101.614 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 33 / bw: 4.486 / grad: -57.542 / stop criter: 101.614 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 34 / bw: 4.738 / grad: -30.312 / stop criter: 57.542 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s] * GD progress: iter: 34 / bw: 4.738 / grad: -30.312 / stop criter: 57.542 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 35 / bw: 4.871 / grad: -27.846 / stop criter: 30.312 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 35 / bw: 4.871 / grad: -27.846 / stop criter: 30.312 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 36 / bw: 4.994 / grad: 21.438 / stop criter: 27.846 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s] * GD progress: iter: 36 / bw: 4.994 / grad: 21.438 / stop criter: 27.846 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 37 / bw: 4.900 / grad: 28.704 / stop criter: 21.438 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 37 / bw: 4.900 / grad: 28.704 / stop criter: 21.438 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 38 / bw: 4.775 / grad: -67.847 / stop criter: 28.704 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 38 / bw: 4.775 / grad: -67.847 / stop criter: 28.704 :   8%|▊         | 25/300 [00:00&lt;00:02, 116.68it/s]* GD progress: iter: 38 / bw: 4.775 / grad: -67.847 / stop criter: 28.704 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 39 / bw: 5.070 / grad: 77.576 / stop criter: 67.847 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s] * GD progress: iter: 39 / bw: 5.070 / grad: 77.576 / stop criter: 67.847 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 40 / bw: 4.736 / grad: -57.038 / stop criter: 77.576 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 40 / bw: 4.736 / grad: -57.038 / stop criter: 77.576 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 41 / bw: 4.979 / grad: 26.584 / stop criter: 57.038 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s] * GD progress: iter: 41 / bw: 4.979 / grad: 26.584 / stop criter: 57.038 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 42 / bw: 4.867 / grad: -29.853 / stop criter: 26.584 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 42 / bw: 4.867 / grad: -29.853 / stop criter: 26.584 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 43 / bw: 4.991 / grad: -34.202 / stop criter: 29.853 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 43 / bw: 4.991 / grad: -34.202 / stop criter: 29.853 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 44 / bw: 5.133 / grad: 22.736 / stop criter: 34.202 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s] * GD progress: iter: 44 / bw: 5.133 / grad: 22.736 / stop criter: 34.202 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 45 / bw: 5.039 / grad: 70.580 / stop criter: 22.736 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 45 / bw: 5.039 / grad: 70.580 / stop criter: 22.736 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 46 / bw: 4.750 / grad: -9.699 / stop criter: 70.580 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 46 / bw: 4.750 / grad: -9.699 / stop criter: 70.580 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 47 / bw: 4.790 / grad: -47.634 / stop criter: 9.699 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 47 / bw: 4.790 / grad: -47.634 / stop criter: 9.699 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 48 / bw: 4.983 / grad: 71.020 / stop criter: 47.634 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 48 / bw: 4.983 / grad: 71.020 / stop criter: 47.634 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 49 / bw: 4.695 / grad: -20.859 / stop criter: 71.020 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 49 / bw: 4.695 / grad: -20.859 / stop criter: 71.020 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 50 / bw: 4.779 / grad: 23.949 / stop criter: 20.859 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s] * GD progress: iter: 50 / bw: 4.779 / grad: 23.949 / stop criter: 20.859 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 51 / bw: 4.683 / grad: -26.081 / stop criter: 23.949 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 51 / bw: 4.683 / grad: -26.081 / stop criter: 23.949 :  13%|█▎        | 38/300 [00:00&lt;00:02, 120.72it/s]* GD progress: iter: 51 / bw: 4.683 / grad: -26.081 / stop criter: 23.949 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 52 / bw: 4.786 / grad: -18.979 / stop criter: 26.081 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 52 / bw: 4.786 / grad: -18.979 / stop criter: 26.081 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 53 / bw: 4.860 / grad: 18.048 / stop criter: 18.979 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s] * GD progress: iter: 53 / bw: 4.860 / grad: 18.048 / stop criter: 18.979 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 54 / bw: 4.790 / grad: -17.989 / stop criter: 18.048 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 54 / bw: 4.790 / grad: -17.989 / stop criter: 18.048 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 55 / bw: 4.859 / grad: 23.301 / stop criter: 17.989 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s] * GD progress: iter: 55 / bw: 4.859 / grad: 23.301 / stop criter: 17.989 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 56 / bw: 4.770 / grad: 8.084 / stop criter: 23.301 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s] * GD progress: iter: 56 / bw: 4.770 / grad: 8.084 / stop criter: 23.301 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 57 / bw: 4.740 / grad: 34.426 / stop criter: 8.084 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 57 / bw: 4.740 / grad: 34.426 / stop criter: 8.084 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 58 / bw: 4.610 / grad: -30.742 / stop criter: 34.426 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 58 / bw: 4.610 / grad: -30.742 / stop criter: 34.426 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 59 / bw: 4.726 / grad: 82.251 / stop criter: 30.742 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s] * GD progress: iter: 59 / bw: 4.726 / grad: 82.251 / stop criter: 30.742 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 60 / bw: 4.418 / grad: 33.820 / stop criter: 82.251 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 60 / bw: 4.418 / grad: 33.820 / stop criter: 82.251 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 61 / bw: 4.293 / grad: -107.551 / stop criter: 33.820 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 61 / bw: 4.293 / grad: -107.551 / stop criter: 33.820 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 62 / bw: 4.691 / grad: -65.953 / stop criter: 107.551 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 62 / bw: 4.691 / grad: -65.953 / stop criter: 107.551 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 63 / bw: 4.933 / grad: 20.592 / stop criter: 65.953 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]  * GD progress: iter: 63 / bw: 4.933 / grad: 20.592 / stop criter: 65.953 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 64 / bw: 4.857 / grad: -73.346 / stop criter: 20.592 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 64 / bw: 4.857 / grad: -73.346 / stop criter: 20.592 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 65 / bw: 5.123 / grad: 71.437 / stop criter: 73.346 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s] * GD progress: iter: 65 / bw: 5.123 / grad: 71.437 / stop criter: 73.346 :  17%|█▋        | 51/300 [00:00&lt;00:02, 124.00it/s]* GD progress: iter: 65 / bw: 5.123 / grad: 71.437 / stop criter: 73.346 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 66 / bw: 4.867 / grad: 55.946 / stop criter: 71.437 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 66 / bw: 4.867 / grad: 55.946 / stop criter: 71.437 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 67 / bw: 4.668 / grad: 32.531 / stop criter: 55.946 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 67 / bw: 4.668 / grad: 32.531 / stop criter: 55.946 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 68 / bw: 4.552 / grad: -27.696 / stop criter: 32.531 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 68 / bw: 4.552 / grad: -27.696 / stop criter: 32.531 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 69 / bw: 4.651 / grad: -5.087 / stop criter: 27.696 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s] * GD progress: iter: 69 / bw: 4.651 / grad: -5.087 / stop criter: 27.696 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 70 / bw: 4.669 / grad: -18.382 / stop criter: 5.087 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 70 / bw: 4.669 / grad: -18.382 / stop criter: 5.087 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 71 / bw: 4.733 / grad: 50.621 / stop criter: 18.382 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 71 / bw: 4.733 / grad: 50.621 / stop criter: 18.382 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 72 / bw: 4.555 / grad: 52.692 / stop criter: 50.621 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 72 / bw: 4.555 / grad: 52.692 / stop criter: 50.621 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 73 / bw: 4.371 / grad: -7.684 / stop criter: 52.692 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 73 / bw: 4.371 / grad: -7.684 / stop criter: 52.692 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 74 / bw: 4.398 / grad: 5.758 / stop criter: 7.684 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]  * GD progress: iter: 74 / bw: 4.398 / grad: 5.758 / stop criter: 7.684 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 75 / bw: 4.378 / grad: -34.029 / stop criter: 5.758 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 75 / bw: 4.378 / grad: -34.029 / stop criter: 5.758 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 76 / bw: 4.495 / grad: -11.710 / stop criter: 34.029 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 76 / bw: 4.495 / grad: -11.710 / stop criter: 34.029 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 77 / bw: 4.534 / grad: -18.298 / stop criter: 11.710 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 77 / bw: 4.534 / grad: -18.298 / stop criter: 11.710 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 78 / bw: 4.596 / grad: 53.685 / stop criter: 18.298 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s] * GD progress: iter: 78 / bw: 4.596 / grad: 53.685 / stop criter: 18.298 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 79 / bw: 4.415 / grad: -10.848 / stop criter: 53.685 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 79 / bw: 4.415 / grad: -10.848 / stop criter: 53.685 :  22%|██▏       | 65/300 [00:00&lt;00:01, 127.14it/s]* GD progress: iter: 79 / bw: 4.415 / grad: -10.848 / stop criter: 53.685 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 80 / bw: 4.451 / grad: 33.412 / stop criter: 10.848 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s] * GD progress: iter: 80 / bw: 4.451 / grad: 33.412 / stop criter: 10.848 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 81 / bw: 4.340 / grad: 7.450 / stop criter: 33.412 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s] * GD progress: iter: 81 / bw: 4.340 / grad: 7.450 / stop criter: 33.412 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 82 / bw: 4.316 / grad: 27.246 / stop criter: 7.450 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 82 / bw: 4.316 / grad: 27.246 / stop criter: 7.450 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 83 / bw: 4.226 / grad: -22.078 / stop criter: 27.246 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 83 / bw: 4.226 / grad: -22.078 / stop criter: 27.246 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 84 / bw: 4.299 / grad: 39.908 / stop criter: 22.078 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s] * GD progress: iter: 84 / bw: 4.299 / grad: 39.908 / stop criter: 22.078 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 85 / bw: 4.169 / grad: 45.877 / stop criter: 39.908 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 85 / bw: 4.169 / grad: 45.877 / stop criter: 39.908 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 86 / bw: 4.022 / grad: 51.440 / stop criter: 45.877 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 86 / bw: 4.022 / grad: 51.440 / stop criter: 45.877 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 87 / bw: 3.856 / grad: -86.935 / stop criter: 51.440 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 87 / bw: 3.856 / grad: -86.935 / stop criter: 51.440 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 88 / bw: 4.136 / grad: -51.301 / stop criter: 86.935 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 88 / bw: 4.136 / grad: -51.301 / stop criter: 86.935 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 89 / bw: 4.299 / grad: -11.606 / stop criter: 51.301 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 89 / bw: 4.299 / grad: -11.606 / stop criter: 51.301 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 90 / bw: 4.336 / grad: -67.186 / stop criter: 11.606 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 90 / bw: 4.336 / grad: -67.186 / stop criter: 11.606 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 91 / bw: 4.550 / grad: -52.527 / stop criter: 67.186 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 91 / bw: 4.550 / grad: -52.527 / stop criter: 67.186 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 92 / bw: 4.717 / grad: -11.675 / stop criter: 52.527 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 92 / bw: 4.717 / grad: -11.675 / stop criter: 52.527 :  26%|██▋       | 79/300 [00:00&lt;00:01, 126.96it/s]* GD progress: iter: 92 / bw: 4.717 / grad: -11.675 / stop criter: 52.527 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 93 / bw: 4.754 / grad: 28.206 / stop criter: 11.675 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s] * GD progress: iter: 93 / bw: 4.754 / grad: 28.206 / stop criter: 11.675 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 94 / bw: 4.664 / grad: -86.511 / stop criter: 28.206 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 94 / bw: 4.664 / grad: -86.511 / stop criter: 28.206 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 95 / bw: 4.937 / grad: -23.748 / stop criter: 86.511 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 95 / bw: 4.937 / grad: -23.748 / stop criter: 86.511 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 96 / bw: 5.011 / grad: -9.064 / stop criter: 23.748 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s] * GD progress: iter: 96 / bw: 5.011 / grad: -9.064 / stop criter: 23.748 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 97 / bw: 5.039 / grad: 0.156 / stop criter: 9.064 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]  * GD progress: iter: 97 / bw: 5.039 / grad: 0.156 / stop criter: 9.064 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 98 / bw: 5.039 / grad: -96.447 / stop criter: 0.156 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 98 / bw: 5.039 / grad: -96.447 / stop criter: 0.156 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 99 / bw: 5.337 / grad: -64.783 / stop criter: 96.447 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 99 / bw: 5.337 / grad: -64.783 / stop criter: 96.447 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 100 / bw: 5.535 / grad: -6.210 / stop criter: 64.783 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 100 / bw: 5.535 / grad: -6.210 / stop criter: 64.783 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 101 / bw: 5.554 / grad: -61.093 / stop criter: 6.210 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 101 / bw: 5.554 / grad: -61.093 / stop criter: 6.210 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 102 / bw: 5.741 / grad: 168.090 / stop criter: 61.093 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 102 / bw: 5.741 / grad: 168.090 / stop criter: 61.093 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 103 / bw: 5.227 / grad: 57.859 / stop criter: 168.090 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 103 / bw: 5.227 / grad: 57.859 / stop criter: 168.090 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 104 / bw: 5.052 / grad: -46.318 / stop criter: 57.859 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 104 / bw: 5.052 / grad: -46.318 / stop criter: 57.859 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 105 / bw: 5.192 / grad: 86.578 / stop criter: 46.318 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s] * GD progress: iter: 105 / bw: 5.192 / grad: 86.578 / stop criter: 46.318 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 106 / bw: 4.932 / grad: -25.160 / stop criter: 86.578 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 106 / bw: 4.932 / grad: -25.160 / stop criter: 86.578 :  31%|███       | 92/300 [00:00&lt;00:01, 127.87it/s]* GD progress: iter: 106 / bw: 4.932 / grad: -25.160 / stop criter: 86.578 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 107 / bw: 5.007 / grad: -53.665 / stop criter: 25.160 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 107 / bw: 5.007 / grad: -53.665 / stop criter: 25.160 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 108 / bw: 5.165 / grad: 6.658 / stop criter: 53.665 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]  * GD progress: iter: 108 / bw: 5.165 / grad: 6.658 / stop criter: 53.665 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 109 / bw: 5.145 / grad: 80.569 / stop criter: 6.658 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 109 / bw: 5.145 / grad: 80.569 / stop criter: 6.658 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 110 / bw: 4.911 / grad: -36.359 / stop criter: 80.569 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 110 / bw: 4.911 / grad: -36.359 / stop criter: 80.569 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 111 / bw: 5.017 / grad: -68.066 / stop criter: 36.359 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 111 / bw: 5.017 / grad: -68.066 / stop criter: 36.359 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 112 / bw: 5.213 / grad: 30.848 / stop criter: 68.066 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s] * GD progress: iter: 112 / bw: 5.213 / grad: 30.848 / stop criter: 68.066 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 113 / bw: 5.124 / grad: -54.862 / stop criter: 30.848 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 113 / bw: 5.124 / grad: -54.862 / stop criter: 30.848 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 114 / bw: 5.280 / grad: -12.416 / stop criter: 54.862 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 114 / bw: 5.280 / grad: -12.416 / stop criter: 54.862 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 115 / bw: 5.315 / grad: -44.309 / stop criter: 12.416 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 115 / bw: 5.315 / grad: -44.309 / stop criter: 12.416 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 116 / bw: 5.440 / grad: -33.260 / stop criter: 44.309 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 116 / bw: 5.440 / grad: -33.260 / stop criter: 44.309 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 117 / bw: 5.534 / grad: 51.751 / stop criter: 33.260 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s] * GD progress: iter: 117 / bw: 5.534 / grad: 51.751 / stop criter: 33.260 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 118 / bw: 5.388 / grad: -25.853 / stop criter: 51.751 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 118 / bw: 5.388 / grad: -25.853 / stop criter: 51.751 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 119 / bw: 5.460 / grad: -6.615 / stop criter: 25.853 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s] * GD progress: iter: 119 / bw: 5.460 / grad: -6.615 / stop criter: 25.853 :  35%|███▌      | 106/300 [00:00&lt;00:01, 129.08it/s]* GD progress: iter: 119 / bw: 5.460 / grad: -6.615 / stop criter: 25.853 :  40%|███▉      | 119/300 [00:00&lt;00:01, 113.69it/s]* GD progress: iter: 120 / bw: 5.479 / grad: 80.664 / stop criter: 6.615 :  40%|███▉      | 119/300 [00:00&lt;00:01, 113.69it/s] * GD progress: iter: 120 / bw: 5.479 / grad: 80.664 / stop criter: 6.615 :  40%|███▉      | 119/300 [00:00&lt;00:01, 113.69it/s]* GD progress: iter: 121 / bw: 5.255 / grad: -34.412 / stop criter: 80.664 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 121 / bw: 5.255 / grad: -34.412 / stop criter: 80.664 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 122 / bw: 5.350 / grad: -9.138 / stop criter: 34.412 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s] * GD progress: iter: 122 / bw: 5.350 / grad: -9.138 / stop criter: 34.412 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 123 / bw: 5.374 / grad: -91.120 / stop criter: 9.138 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 123 / bw: 5.374 / grad: -91.120 / stop criter: 9.138 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 124 / bw: 5.621 / grad: -42.187 / stop criter: 91.120 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 124 / bw: 5.621 / grad: -42.187 / stop criter: 91.120 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 125 / bw: 5.736 / grad: 24.687 / stop criter: 42.187 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s] * GD progress: iter: 125 / bw: 5.736 / grad: 24.687 / stop criter: 42.187 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 126 / bw: 5.669 / grad: 63.083 / stop criter: 24.687 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 126 / bw: 5.669 / grad: 63.083 / stop criter: 24.687 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 127 / bw: 5.500 / grad: 80.459 / stop criter: 63.083 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 127 / bw: 5.500 / grad: 80.459 / stop criter: 63.083 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 128 / bw: 5.284 / grad: 13.017 / stop criter: 80.459 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 128 / bw: 5.284 / grad: 13.017 / stop criter: 80.459 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 129 / bw: 5.249 / grad: 16.161 / stop criter: 13.017 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 129 / bw: 5.249 / grad: 16.161 / stop criter: 13.017 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 130 / bw: 5.205 / grad: 44.050 / stop criter: 16.161 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 130 / bw: 5.205 / grad: 44.050 / stop criter: 16.161 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 131 / bw: 5.087 / grad: 62.221 / stop criter: 44.050 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 131 / bw: 5.087 / grad: 62.221 / stop criter: 44.050 :  40%|███▉      | 119/300 [00:01&lt;00:01, 113.69it/s]* GD progress: iter: 131 / bw: 5.087 / grad: 62.221 / stop criter: 44.050 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 132 / bw: 4.920 / grad: 14.196 / stop criter: 62.221 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 132 / bw: 4.920 / grad: 14.196 / stop criter: 62.221 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 133 / bw: 4.882 / grad: -69.393 / stop criter: 14.196 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 133 / bw: 4.882 / grad: -69.393 / stop criter: 14.196 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 134 / bw: 5.068 / grad: 74.633 / stop criter: 69.393 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s] * GD progress: iter: 134 / bw: 5.068 / grad: 74.633 / stop criter: 69.393 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 135 / bw: 4.870 / grad: -50.993 / stop criter: 74.633 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 135 / bw: 4.870 / grad: -50.993 / stop criter: 74.633 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 136 / bw: 5.004 / grad: 68.779 / stop criter: 50.993 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s] * GD progress: iter: 136 / bw: 5.004 / grad: 68.779 / stop criter: 50.993 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 137 / bw: 4.825 / grad: -27.155 / stop criter: 68.779 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 137 / bw: 4.825 / grad: -27.155 / stop criter: 68.779 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 138 / bw: 4.895 / grad: -33.406 / stop criter: 27.155 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 138 / bw: 4.895 / grad: -33.406 / stop criter: 27.155 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 139 / bw: 4.980 / grad: 87.675 / stop criter: 33.406 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s] * GD progress: iter: 139 / bw: 4.980 / grad: 87.675 / stop criter: 33.406 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 140 / bw: 4.757 / grad: -31.554 / stop criter: 87.675 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 140 / bw: 4.757 / grad: -31.554 / stop criter: 87.675 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 141 / bw: 4.836 / grad: -133.276 / stop criter: 31.554 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 141 / bw: 4.836 / grad: -133.276 / stop criter: 31.554 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 142 / bw: 5.170 / grad: 63.817 / stop criter: 133.276 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s] * GD progress: iter: 142 / bw: 5.170 / grad: 63.817 / stop criter: 133.276 :  44%|████▎     | 131/300 [00:01&lt;00:01, 106.81it/s]* GD progress: iter: 142 / bw: 5.170 / grad: 63.817 / stop criter: 133.276 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 143 / bw: 5.010 / grad: 10.211 / stop criter: 63.817 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s] * GD progress: iter: 143 / bw: 5.010 / grad: 10.211 / stop criter: 63.817 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 144 / bw: 4.985 / grad: 60.700 / stop criter: 10.211 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 144 / bw: 4.985 / grad: 60.700 / stop criter: 10.211 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 145 / bw: 4.834 / grad: 20.858 / stop criter: 60.700 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 145 / bw: 4.834 / grad: 20.858 / stop criter: 60.700 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 146 / bw: 4.783 / grad: 6.270 / stop criter: 20.858 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s] * GD progress: iter: 146 / bw: 4.783 / grad: 6.270 / stop criter: 20.858 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 147 / bw: 4.767 / grad: 2.571 / stop criter: 6.270 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s] * GD progress: iter: 147 / bw: 4.767 / grad: 2.571 / stop criter: 6.270 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 148 / bw: 4.761 / grad: 5.949 / stop criter: 2.571 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 148 / bw: 4.761 / grad: 5.949 / stop criter: 2.571 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 149 / bw: 4.746 / grad: 73.200 / stop criter: 5.949 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 149 / bw: 4.746 / grad: 73.200 / stop criter: 5.949 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 150 / bw: 4.565 / grad: -102.063 / stop criter: 73.200 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 150 / bw: 4.565 / grad: -102.063 / stop criter: 73.200 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 151 / bw: 4.818 / grad: 15.675 / stop criter: 102.063 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s] * GD progress: iter: 151 / bw: 4.818 / grad: 15.675 / stop criter: 102.063 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 152 / bw: 4.779 / grad: 18.677 / stop criter: 15.675 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s] * GD progress: iter: 152 / bw: 4.779 / grad: 18.677 / stop criter: 15.675 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 153 / bw: 4.734 / grad: -181.051 / stop criter: 18.677 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 153 / bw: 4.734 / grad: -181.051 / stop criter: 18.677 :  47%|████▋     | 142/300 [00:01&lt;00:01, 107.09it/s]* GD progress: iter: 153 / bw: 4.734 / grad: -181.051 / stop criter: 18.677 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 154 / bw: 5.173 / grad: 67.798 / stop criter: 181.051 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s] * GD progress: iter: 154 / bw: 5.173 / grad: 67.798 / stop criter: 181.051 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 155 / bw: 5.010 / grad: 96.627 / stop criter: 67.798 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s] * GD progress: iter: 155 / bw: 5.010 / grad: 96.627 / stop criter: 67.798 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 156 / bw: 4.780 / grad: -90.199 / stop criter: 96.627 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 156 / bw: 4.780 / grad: -90.199 / stop criter: 96.627 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 157 / bw: 4.995 / grad: -93.582 / stop criter: 90.199 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 157 / bw: 4.995 / grad: -93.582 / stop criter: 90.199 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 158 / bw: 5.215 / grad: 29.778 / stop criter: 93.582 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s] * GD progress: iter: 158 / bw: 5.215 / grad: 29.778 / stop criter: 93.582 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 159 / bw: 5.145 / grad: -68.206 / stop criter: 29.778 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 159 / bw: 5.145 / grad: -68.206 / stop criter: 29.778 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 160 / bw: 5.304 / grad: -5.268 / stop criter: 68.206 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s] * GD progress: iter: 160 / bw: 5.304 / grad: -5.268 / stop criter: 68.206 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 161 / bw: 5.316 / grad: -31.044 / stop criter: 5.268 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 161 / bw: 5.316 / grad: -31.044 / stop criter: 5.268 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 162 / bw: 5.388 / grad: -91.676 / stop criter: 31.044 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 162 / bw: 5.388 / grad: -91.676 / stop criter: 31.044 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 163 / bw: 5.600 / grad: -0.138 / stop criter: 91.676 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s] * GD progress: iter: 163 / bw: 5.600 / grad: -0.138 / stop criter: 91.676 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 164 / bw: 5.600 / grad: 3.164 / stop criter: 0.138 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]  * GD progress: iter: 164 / bw: 5.600 / grad: 3.164 / stop criter: 0.138 :  51%|█████     | 153/300 [00:01&lt;00:01, 105.53it/s]* GD progress: iter: 164 / bw: 5.600 / grad: 3.164 / stop criter: 0.138 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 165 / bw: 5.593 / grad: 34.451 / stop criter: 3.164 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 165 / bw: 5.593 / grad: 34.451 / stop criter: 3.164 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 166 / bw: 5.514 / grad: -24.672 / stop criter: 34.451 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 166 / bw: 5.514 / grad: -24.672 / stop criter: 34.451 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 167 / bw: 5.570 / grad: -90.733 / stop criter: 24.672 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 167 / bw: 5.570 / grad: -90.733 / stop criter: 24.672 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 168 / bw: 5.776 / grad: 25.488 / stop criter: 90.733 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s] * GD progress: iter: 168 / bw: 5.776 / grad: 25.488 / stop criter: 90.733 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 169 / bw: 5.718 / grad: -5.679 / stop criter: 25.488 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 169 / bw: 5.718 / grad: -5.679 / stop criter: 25.488 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 170 / bw: 5.731 / grad: 73.712 / stop criter: 5.679 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s] * GD progress: iter: 170 / bw: 5.731 / grad: 73.712 / stop criter: 5.679 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 171 / bw: 5.567 / grad: -108.670 / stop criter: 73.712 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 171 / bw: 5.567 / grad: -108.670 / stop criter: 73.712 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 172 / bw: 5.806 / grad: -44.638 / stop criter: 108.670 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 172 / bw: 5.806 / grad: -44.638 / stop criter: 108.670 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 173 / bw: 5.903 / grad: 143.846 / stop criter: 44.638 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s] * GD progress: iter: 173 / bw: 5.903 / grad: 143.846 / stop criter: 44.638 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 174 / bw: 5.590 / grad: 79.335 / stop criter: 143.846 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 174 / bw: 5.590 / grad: 79.335 / stop criter: 143.846 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 175 / bw: 5.420 / grad: 1.108 / stop criter: 79.335 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]  * GD progress: iter: 175 / bw: 5.420 / grad: 1.108 / stop criter: 79.335 :  55%|█████▍    | 164/300 [00:01&lt;00:01, 100.99it/s]* GD progress: iter: 175 / bw: 5.420 / grad: 1.108 / stop criter: 79.335 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s] * GD progress: iter: 176 / bw: 5.417 / grad: -5.599 / stop criter: 1.108 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 176 / bw: 5.417 / grad: -5.599 / stop criter: 1.108 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 177 / bw: 5.429 / grad: -11.423 / stop criter: 5.599 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 177 / bw: 5.429 / grad: -11.423 / stop criter: 5.599 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 178 / bw: 5.454 / grad: -3.700 / stop criter: 11.423 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 178 / bw: 5.454 / grad: -3.700 / stop criter: 11.423 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 179 / bw: 5.461 / grad: -41.725 / stop criter: 3.700 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 179 / bw: 5.461 / grad: -41.725 / stop criter: 3.700 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 180 / bw: 5.550 / grad: 15.484 / stop criter: 41.725 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 180 / bw: 5.550 / grad: 15.484 / stop criter: 41.725 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 181 / bw: 5.517 / grad: -120.359 / stop criter: 15.484 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 181 / bw: 5.517 / grad: -120.359 / stop criter: 15.484 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 182 / bw: 5.771 / grad: 30.398 / stop criter: 120.359 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s] * GD progress: iter: 182 / bw: 5.771 / grad: 30.398 / stop criter: 120.359 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 183 / bw: 5.708 / grad: -14.084 / stop criter: 30.398 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 183 / bw: 5.708 / grad: -14.084 / stop criter: 30.398 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 184 / bw: 5.737 / grad: 19.769 / stop criter: 14.084 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s] * GD progress: iter: 184 / bw: 5.737 / grad: 19.769 / stop criter: 14.084 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 185 / bw: 5.696 / grad: -51.929 / stop criter: 19.769 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 185 / bw: 5.696 / grad: -51.929 / stop criter: 19.769 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 186 / bw: 5.801 / grad: -96.140 / stop criter: 51.929 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 186 / bw: 5.801 / grad: -96.140 / stop criter: 51.929 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 187 / bw: 5.994 / grad: 27.938 / stop criter: 96.140 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s] * GD progress: iter: 187 / bw: 5.994 / grad: 27.938 / stop criter: 96.140 :  58%|█████▊    | 175/300 [00:01&lt;00:01, 99.83it/s]* GD progress: iter: 187 / bw: 5.994 / grad: 27.938 / stop criter: 96.140 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 188 / bw: 5.938 / grad: 133.501 / stop criter: 27.938 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 188 / bw: 5.938 / grad: 133.501 / stop criter: 27.938 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 189 / bw: 5.673 / grad: 71.023 / stop criter: 133.501 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 189 / bw: 5.673 / grad: 71.023 / stop criter: 133.501 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 190 / bw: 5.532 / grad: 116.724 / stop criter: 71.023 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 190 / bw: 5.532 / grad: 116.724 / stop criter: 71.023 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 191 / bw: 5.301 / grad: 14.194 / stop criter: 116.724 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 191 / bw: 5.301 / grad: 14.194 / stop criter: 116.724 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 192 / bw: 5.272 / grad: 26.379 / stop criter: 14.194 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s] * GD progress: iter: 192 / bw: 5.272 / grad: 26.379 / stop criter: 14.194 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 193 / bw: 5.220 / grad: -40.750 / stop criter: 26.379 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 193 / bw: 5.220 / grad: -40.750 / stop criter: 26.379 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 194 / bw: 5.301 / grad: 26.242 / stop criter: 40.750 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s] * GD progress: iter: 194 / bw: 5.301 / grad: 26.242 / stop criter: 40.750 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 195 / bw: 5.249 / grad: -47.685 / stop criter: 26.242 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 195 / bw: 5.249 / grad: -47.685 / stop criter: 26.242 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 196 / bw: 5.342 / grad: 9.328 / stop criter: 47.685 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]  * GD progress: iter: 196 / bw: 5.342 / grad: 9.328 / stop criter: 47.685 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 197 / bw: 5.324 / grad: 59.686 / stop criter: 9.328 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 197 / bw: 5.324 / grad: 59.686 / stop criter: 9.328 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 198 / bw: 5.210 / grad: -7.951 / stop criter: 59.686 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 198 / bw: 5.210 / grad: -7.951 / stop criter: 59.686 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 199 / bw: 5.225 / grad: -39.607 / stop criter: 7.951 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 199 / bw: 5.225 / grad: -39.607 / stop criter: 7.951 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 200 / bw: 5.300 / grad: -40.185 / stop criter: 39.607 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 200 / bw: 5.300 / grad: -40.185 / stop criter: 39.607 :  62%|██████▏   | 187/300 [00:01&lt;00:01, 103.14it/s]* GD progress: iter: 200 / bw: 5.300 / grad: -40.185 / stop criter: 39.607 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 201 / bw: 5.376 / grad: 13.271 / stop criter: 40.185 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s] * GD progress: iter: 201 / bw: 5.376 / grad: 13.271 / stop criter: 40.185 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 202 / bw: 5.351 / grad: 95.474 / stop criter: 13.271 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 202 / bw: 5.351 / grad: 95.474 / stop criter: 13.271 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 203 / bw: 5.173 / grad: -58.987 / stop criter: 95.474 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 203 / bw: 5.173 / grad: -58.987 / stop criter: 95.474 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 204 / bw: 5.283 / grad: 26.698 / stop criter: 58.987 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s] * GD progress: iter: 204 / bw: 5.283 / grad: 26.698 / stop criter: 58.987 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 205 / bw: 5.233 / grad: 66.186 / stop criter: 26.698 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 205 / bw: 5.233 / grad: 66.186 / stop criter: 26.698 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 206 / bw: 5.112 / grad: 49.765 / stop criter: 66.186 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 206 / bw: 5.112 / grad: 49.765 / stop criter: 66.186 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 207 / bw: 5.021 / grad: -24.804 / stop criter: 49.765 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 207 / bw: 5.021 / grad: -24.804 / stop criter: 49.765 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 208 / bw: 5.066 / grad: -11.011 / stop criter: 24.804 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 208 / bw: 5.066 / grad: -11.011 / stop criter: 24.804 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 209 / bw: 5.086 / grad: 64.479 / stop criter: 11.011 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s] * GD progress: iter: 209 / bw: 5.086 / grad: 64.479 / stop criter: 11.011 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 210 / bw: 4.970 / grad: 45.297 / stop criter: 64.479 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 210 / bw: 4.970 / grad: 45.297 / stop criter: 64.479 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 211 / bw: 4.888 / grad: -38.366 / stop criter: 45.297 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 211 / bw: 4.888 / grad: -38.366 / stop criter: 45.297 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 212 / bw: 4.957 / grad: 28.223 / stop criter: 38.366 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s] * GD progress: iter: 212 / bw: 4.957 / grad: 28.223 / stop criter: 38.366 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 213 / bw: 4.907 / grad: 14.730 / stop criter: 28.223 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 213 / bw: 4.907 / grad: 14.730 / stop criter: 28.223 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 214 / bw: 4.881 / grad: -14.718 / stop criter: 14.730 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 214 / bw: 4.881 / grad: -14.718 / stop criter: 14.730 :  67%|██████▋   | 200/300 [00:01&lt;00:00, 110.55it/s]* GD progress: iter: 214 / bw: 4.881 / grad: -14.718 / stop criter: 14.730 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 215 / bw: 4.907 / grad: 58.809 / stop criter: 14.718 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s] * GD progress: iter: 215 / bw: 4.907 / grad: 58.809 / stop criter: 14.718 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 216 / bw: 4.804 / grad: 38.089 / stop criter: 58.809 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 216 / bw: 4.804 / grad: 38.089 / stop criter: 58.809 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 217 / bw: 4.739 / grad: 22.133 / stop criter: 38.089 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 217 / bw: 4.739 / grad: 22.133 / stop criter: 38.089 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 218 / bw: 4.701 / grad: -63.104 / stop criter: 22.133 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 218 / bw: 4.701 / grad: -63.104 / stop criter: 22.133 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 219 / bw: 4.809 / grad: 3.690 / stop criter: 63.104 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]  * GD progress: iter: 219 / bw: 4.809 / grad: 3.690 / stop criter: 63.104 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 220 / bw: 4.803 / grad: -20.798 / stop criter: 3.690 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 220 / bw: 4.803 / grad: -20.798 / stop criter: 3.690 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 221 / bw: 4.838 / grad: -55.546 / stop criter: 20.798 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 221 / bw: 4.838 / grad: -55.546 / stop criter: 20.798 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 222 / bw: 4.931 / grad: 55.790 / stop criter: 55.546 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s] * GD progress: iter: 222 / bw: 4.931 / grad: 55.790 / stop criter: 55.546 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 223 / bw: 4.838 / grad: -3.561 / stop criter: 55.790 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 223 / bw: 4.838 / grad: -3.561 / stop criter: 55.790 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 224 / bw: 4.844 / grad: 61.784 / stop criter: 3.561 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s] * GD progress: iter: 224 / bw: 4.844 / grad: 61.784 / stop criter: 3.561 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 225 / bw: 4.742 / grad: -39.683 / stop criter: 61.784 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 225 / bw: 4.742 / grad: -39.683 / stop criter: 61.784 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 226 / bw: 4.807 / grad: -17.985 / stop criter: 39.683 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 226 / bw: 4.807 / grad: -17.985 / stop criter: 39.683 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 227 / bw: 4.836 / grad: -46.529 / stop criter: 17.985 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 227 / bw: 4.836 / grad: -46.529 / stop criter: 17.985 :  71%|███████▏  | 214/300 [00:01&lt;00:00, 116.62it/s]* GD progress: iter: 227 / bw: 4.836 / grad: -46.529 / stop criter: 17.985 :  76%|███████▌  | 227/300 [00:01&lt;00:00, 118.86it/s]* GD progress: iter: 228 / bw: 4.911 / grad: -41.596 / stop criter: 46.529 :  76%|███████▌  | 227/300 [00:01&lt;00:00, 118.86it/s]* GD progress: iter: 228 / bw: 4.911 / grad: -41.596 / stop criter: 46.529 :  76%|███████▌  | 227/300 [00:01&lt;00:00, 118.86it/s]* GD progress: iter: 229 / bw: 4.977 / grad: -107.462 / stop criter: 41.596 :  76%|███████▌  | 227/300 [00:01&lt;00:00, 118.86it/s]* GD progress: iter: 229 / bw: 4.977 / grad: -107.462 / stop criter: 41.596 :  76%|███████▌  | 227/300 [00:01&lt;00:00, 118.86it/s]* GD progress: iter: 230 / bw: 5.150 / grad: -86.011 / stop criter: 107.462 :  76%|███████▌  | 227/300 [00:01&lt;00:00, 118.86it/s]* GD progress: iter: 230 / bw: 5.150 / grad: -86.011 / stop criter: 107.462 :  76%|███████▌  | 227/300 [00:01&lt;00:00, 118.86it/s]* GD progress: iter: 231 / bw: 5.288 / grad: -43.999 / stop criter: 86.011 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s] * GD progress: iter: 231 / bw: 5.288 / grad: -43.999 / stop criter: 86.011 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 232 / bw: 5.359 / grad: -77.132 / stop criter: 43.999 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 232 / bw: 5.359 / grad: -77.132 / stop criter: 43.999 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 233 / bw: 5.483 / grad: -41.216 / stop criter: 77.132 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 233 / bw: 5.483 / grad: -41.216 / stop criter: 77.132 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 234 / bw: 5.549 / grad: -36.667 / stop criter: 41.216 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 234 / bw: 5.549 / grad: -36.667 / stop criter: 41.216 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 235 / bw: 5.608 / grad: -68.243 / stop criter: 36.667 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 235 / bw: 5.608 / grad: -68.243 / stop criter: 36.667 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 236 / bw: 5.718 / grad: -7.993 / stop criter: 68.243 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s] * GD progress: iter: 236 / bw: 5.718 / grad: -7.993 / stop criter: 68.243 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 237 / bw: 5.731 / grad: -6.742 / stop criter: 7.993 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s] * GD progress: iter: 237 / bw: 5.731 / grad: -6.742 / stop criter: 7.993 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 238 / bw: 5.742 / grad: 40.831 / stop criter: 6.742 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 238 / bw: 5.742 / grad: 40.831 / stop criter: 6.742 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 239 / bw: 5.676 / grad: -98.426 / stop criter: 40.831 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 239 / bw: 5.676 / grad: -98.426 / stop criter: 40.831 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 240 / bw: 5.833 / grad: -22.221 / stop criter: 98.426 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 240 / bw: 5.833 / grad: -22.221 / stop criter: 98.426 :  76%|███████▌  | 227/300 [00:02&lt;00:00, 118.86it/s]* GD progress: iter: 240 / bw: 5.833 / grad: -22.221 / stop criter: 98.426 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 241 / bw: 5.868 / grad: 5.727 / stop criter: 22.221 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]  * GD progress: iter: 241 / bw: 5.868 / grad: 5.727 / stop criter: 22.221 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 242 / bw: 5.859 / grad: 7.155 / stop criter: 5.727 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s] * GD progress: iter: 242 / bw: 5.859 / grad: 7.155 / stop criter: 5.727 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 243 / bw: 5.848 / grad: 20.227 / stop criter: 7.155 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 243 / bw: 5.848 / grad: 20.227 / stop criter: 7.155 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 244 / bw: 5.816 / grad: -76.393 / stop criter: 20.227 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 244 / bw: 5.816 / grad: -76.393 / stop criter: 20.227 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 245 / bw: 5.935 / grad: -6.652 / stop criter: 76.393 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s] * GD progress: iter: 245 / bw: 5.935 / grad: -6.652 / stop criter: 76.393 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 246 / bw: 5.945 / grad: -107.805 / stop criter: 6.652 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 246 / bw: 5.945 / grad: -107.805 / stop criter: 6.652 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 247 / bw: 6.112 / grad: -33.952 / stop criter: 107.805 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 247 / bw: 6.112 / grad: -33.952 / stop criter: 107.805 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 248 / bw: 6.164 / grad: -20.404 / stop criter: 33.952 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s] * GD progress: iter: 248 / bw: 6.164 / grad: -20.404 / stop criter: 33.952 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 249 / bw: 6.196 / grad: 57.322 / stop criter: 20.404 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s] * GD progress: iter: 249 / bw: 6.196 / grad: 57.322 / stop criter: 20.404 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 250 / bw: 6.107 / grad: -88.861 / stop criter: 57.322 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 250 / bw: 6.107 / grad: -88.861 / stop criter: 57.322 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 251 / bw: 6.243 / grad: -35.062 / stop criter: 88.861 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 251 / bw: 6.243 / grad: -35.062 / stop criter: 88.861 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 252 / bw: 6.296 / grad: -88.278 / stop criter: 35.062 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 252 / bw: 6.296 / grad: -88.278 / stop criter: 35.062 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 253 / bw: 6.430 / grad: -12.247 / stop criter: 88.278 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 253 / bw: 6.430 / grad: -12.247 / stop criter: 88.278 :  80%|████████  | 240/300 [00:02&lt;00:00, 120.56it/s]* GD progress: iter: 253 / bw: 6.430 / grad: -12.247 / stop criter: 88.278 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 254 / bw: 6.448 / grad: -110.910 / stop criter: 12.247 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 254 / bw: 6.448 / grad: -110.910 / stop criter: 12.247 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 255 / bw: 6.616 / grad: 80.423 / stop criter: 110.910 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s] * GD progress: iter: 255 / bw: 6.616 / grad: 80.423 / stop criter: 110.910 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 256 / bw: 6.494 / grad: 14.874 / stop criter: 80.423 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s] * GD progress: iter: 256 / bw: 6.494 / grad: 14.874 / stop criter: 80.423 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 257 / bw: 6.472 / grad: 13.337 / stop criter: 14.874 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 257 / bw: 6.472 / grad: 13.337 / stop criter: 14.874 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 258 / bw: 6.452 / grad: -45.387 / stop criter: 13.337 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 258 / bw: 6.452 / grad: -45.387 / stop criter: 13.337 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 259 / bw: 6.520 / grad: 80.785 / stop criter: 45.387 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s] * GD progress: iter: 259 / bw: 6.520 / grad: 80.785 / stop criter: 45.387 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 260 / bw: 6.400 / grad: -11.431 / stop criter: 80.785 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 260 / bw: 6.400 / grad: -11.431 / stop criter: 80.785 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 261 / bw: 6.417 / grad: -98.998 / stop criter: 11.431 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 261 / bw: 6.417 / grad: -98.998 / stop criter: 11.431 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 262 / bw: 6.561 / grad: -48.508 / stop criter: 98.998 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 262 / bw: 6.561 / grad: -48.508 / stop criter: 98.998 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 263 / bw: 6.632 / grad: 20.714 / stop criter: 48.508 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s] * GD progress: iter: 263 / bw: 6.632 / grad: 20.714 / stop criter: 48.508 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 264 / bw: 6.601 / grad: -108.811 / stop criter: 20.714 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 264 / bw: 6.601 / grad: -108.811 / stop criter: 20.714 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 265 / bw: 6.758 / grad: -61.644 / stop criter: 108.811 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 265 / bw: 6.758 / grad: -61.644 / stop criter: 108.811 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 266 / bw: 6.846 / grad: 53.866 / stop criter: 61.644 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]  * GD progress: iter: 266 / bw: 6.846 / grad: 53.866 / stop criter: 61.644 :  84%|████████▍ | 253/300 [00:02&lt;00:00, 122.98it/s]* GD progress: iter: 266 / bw: 6.846 / grad: 53.866 / stop criter: 61.644 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 267 / bw: 6.769 / grad: -109.374 / stop criter: 53.866 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 267 / bw: 6.769 / grad: -109.374 / stop criter: 53.866 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 268 / bw: 6.923 / grad: 9.337 / stop criter: 109.374 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]  * GD progress: iter: 268 / bw: 6.923 / grad: 9.337 / stop criter: 109.374 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 269 / bw: 6.910 / grad: 45.757 / stop criter: 9.337 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s] * GD progress: iter: 269 / bw: 6.910 / grad: 45.757 / stop criter: 9.337 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 270 / bw: 6.847 / grad: 7.319 / stop criter: 45.757 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 270 / bw: 6.847 / grad: 7.319 / stop criter: 45.757 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 271 / bw: 6.837 / grad: -1.368 / stop criter: 7.319 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 271 / bw: 6.837 / grad: -1.368 / stop criter: 7.319 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 272 / bw: 6.839 / grad: -18.729 / stop criter: 1.368 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 272 / bw: 6.839 / grad: -18.729 / stop criter: 1.368 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 273 / bw: 6.865 / grad: 152.037 / stop criter: 18.729 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 273 / bw: 6.865 / grad: 152.037 / stop criter: 18.729 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 274 / bw: 6.656 / grad: 24.767 / stop criter: 152.037 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 274 / bw: 6.656 / grad: 24.767 / stop criter: 152.037 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 275 / bw: 6.623 / grad: 8.861 / stop criter: 24.767 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]  * GD progress: iter: 275 / bw: 6.623 / grad: 8.861 / stop criter: 24.767 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 276 / bw: 6.611 / grad: 39.535 / stop criter: 8.861 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 276 / bw: 6.611 / grad: 39.535 / stop criter: 8.861 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 277 / bw: 6.557 / grad: -63.606 / stop criter: 39.535 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 277 / bw: 6.557 / grad: -63.606 / stop criter: 39.535 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 278 / bw: 6.643 / grad: -88.197 / stop criter: 63.606 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 278 / bw: 6.643 / grad: -88.197 / stop criter: 63.606 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 279 / bw: 6.762 / grad: -3.236 / stop criter: 88.197 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s] * GD progress: iter: 279 / bw: 6.762 / grad: -3.236 / stop criter: 88.197 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 280 / bw: 6.766 / grad: -43.926 / stop criter: 3.236 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 280 / bw: 6.766 / grad: -43.926 / stop criter: 3.236 :  89%|████████▊ | 266/300 [00:02&lt;00:00, 124.12it/s]* GD progress: iter: 280 / bw: 6.766 / grad: -43.926 / stop criter: 3.236 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 281 / bw: 6.825 / grad: 44.941 / stop criter: 43.926 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 281 / bw: 6.825 / grad: 44.941 / stop criter: 43.926 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 282 / bw: 6.765 / grad: -82.411 / stop criter: 44.941 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 282 / bw: 6.765 / grad: -82.411 / stop criter: 44.941 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 283 / bw: 6.874 / grad: 22.031 / stop criter: 82.411 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s] * GD progress: iter: 283 / bw: 6.874 / grad: 22.031 / stop criter: 82.411 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 284 / bw: 6.845 / grad: 19.184 / stop criter: 22.031 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 284 / bw: 6.845 / grad: 19.184 / stop criter: 22.031 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 285 / bw: 6.820 / grad: -109.898 / stop criter: 19.184 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 285 / bw: 6.820 / grad: -109.898 / stop criter: 19.184 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 286 / bw: 6.963 / grad: 69.356 / stop criter: 109.898 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s] * GD progress: iter: 286 / bw: 6.963 / grad: 69.356 / stop criter: 109.898 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 287 / bw: 6.874 / grad: 29.559 / stop criter: 69.356 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s] * GD progress: iter: 287 / bw: 6.874 / grad: 29.559 / stop criter: 69.356 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 288 / bw: 6.836 / grad: 22.520 / stop criter: 29.559 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 288 / bw: 6.836 / grad: 22.520 / stop criter: 29.559 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 289 / bw: 6.808 / grad: -67.382 / stop criter: 22.520 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 289 / bw: 6.808 / grad: -67.382 / stop criter: 22.520 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 290 / bw: 6.893 / grad: -42.829 / stop criter: 67.382 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 290 / bw: 6.893 / grad: -42.829 / stop criter: 67.382 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 291 / bw: 6.948 / grad: 54.706 / stop criter: 42.829 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s] * GD progress: iter: 291 / bw: 6.948 / grad: 54.706 / stop criter: 42.829 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 292 / bw: 6.878 / grad: -6.877 / stop criter: 54.706 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 292 / bw: 6.878 / grad: -6.877 / stop criter: 54.706 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 293 / bw: 6.887 / grad: -37.790 / stop criter: 6.877 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 293 / bw: 6.887 / grad: -37.790 / stop criter: 6.877 :  93%|█████████▎| 280/300 [00:02&lt;00:00, 126.04it/s]* GD progress: iter: 293 / bw: 6.887 / grad: -37.790 / stop criter: 6.877 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 294 / bw: 6.934 / grad: 43.401 / stop criter: 37.790 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 294 / bw: 6.934 / grad: 43.401 / stop criter: 37.790 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 295 / bw: 6.880 / grad: 72.939 / stop criter: 43.401 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 295 / bw: 6.880 / grad: 72.939 / stop criter: 43.401 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 296 / bw: 6.791 / grad: 43.836 / stop criter: 72.939 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 296 / bw: 6.791 / grad: 43.836 / stop criter: 72.939 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 297 / bw: 6.737 / grad: 25.216 / stop criter: 43.836 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 297 / bw: 6.737 / grad: 25.216 / stop criter: 43.836 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 298 / bw: 6.706 / grad: 20.613 / stop criter: 25.216 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 298 / bw: 6.706 / grad: 20.613 / stop criter: 25.216 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 299 / bw: 6.681 / grad: 8.135 / stop criter: 20.613 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s] * GD progress: iter: 299 / bw: 6.681 / grad: 8.135 / stop criter: 20.613 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 300 / bw: 6.671 / grad: 22.439 / stop criter: 8.135 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 300 / bw: 6.671 / grad: 22.439 / stop criter: 8.135 :  98%|█████████▊| 293/300 [00:02&lt;00:00, 125.63it/s]* GD progress: iter: 300 / bw: 6.671 / grad: 22.439 / stop criter: 8.135 : 100%|██████████| 300/300 [00:02&lt;00:00, 117.65it/s]</code></pre>
</div>
</div>
<p>The estimated optimal bandwidth is given by <code>gc1.optimization_outputs['opt_bandwidth']</code>.</p>
<div id="efac9d19" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient COBRA with default parameter</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(gc1_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :6.670893357263273</code></pre>
</div>
</div>
<p>We can look at the learning curve of the algorithm using <code>draw_learning_curve()</code> method.</p>
<div id="113e9d44" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gc1_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="247a1739-89d0-4b2b-a0c1-11e11ad79b6d" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("247a1739-89d0-4b2b-a0c1-11e11ad79b6d")) {                    Plotly.newPlot(                        "247a1739-89d0-4b2b-a0c1-11e11ad79b6d",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299],"y":[3.1,3.1,3.1,3.1,3.1,3.537655326875549,3.603698590103937,3.6958689425947733,3.8017711984066334,3.648771525418104,3.8659749063863065,3.9456016498347295,3.48384496773535,3.345570878763255,3.7345917880694652,3.5112248088650126,3.6996718648319793,3.618840260292446,3.8521998356018465,4.251075870699013,3.912333849381288,4.006179742128384,4.153096789145991,4.191223093701577,3.958944875637417,3.9807294578264347,3.830846992806802,3.8028972787068187,3.880898803505003,4.122934128540302,4.353823766590763,4.034938823104519,4.485677030122627,4.73836799177491,4.871479154798971,4.993763933630299,4.899621880305255,4.77483059397262,5.069797990102043,4.735909619876511,4.9789487380134485,4.866806861468362,4.991478479449988,5.132885463454693,5.038883582575033,4.749992675657103,4.789690460801716,4.982709728309483,4.694923583236261,4.778601526786596,4.683487723612084,4.786032818278978,4.85990850808156,4.7896556264759855,4.8589761914352705,4.770081707428953,4.739550583973646,4.6095295139452235,4.725640118896014,4.4180960578143464,4.292904212680092,4.691029906699049,4.9327277087764765,4.857263915753386,5.123366173362728,4.866781278051722,4.6678444462006885,4.552167425391957,4.650649003906361,4.668557866567291,4.733266694942867,4.555067252640186,4.371429353400331,4.398209314711115,4.378341403257426,4.494576579096683,4.5341759267217485,4.596053079647782,4.414511613091738,4.450826750243505,4.340091044450727,4.315647015071514,4.2262501249681295,4.298691921760952,4.169056777452533,4.0215225405225725,3.856097748642377,4.135668860173365,4.298994411728773,4.335943805966864,4.54984502418111,4.7170748680510535,4.754243094822318,4.66444271342987,4.937112125150325,5.011214873217232,5.03949637323138,5.0390095990026165,5.336946967891025,5.535068368003972,5.55405924292456,5.740896903132286,5.2268367666799165,5.051657733923864,5.1918940251890175,4.9323860707139975,5.0070461244795625,5.164699430388209,5.145140614113602,4.910816895354465,5.016563361145765,5.212543726857273,5.123722355741998,5.2801054519625295,5.315142720001448,5.440182933576189,5.534041434755695,5.388001964481815,5.460227987430908,5.478524182804417,5.255420585719051,5.349645410813632,5.374415309390266,5.621421785021768,5.735781478181342,5.668859792769801,5.4995649685218275,5.283639336875989,5.2487072183728625,5.205336684064007,5.087121546214535,4.920139809303921,4.88204146741541,5.068270219813796,4.869981833098819,5.004106910280876,4.825007895477454,4.895010792146238,4.980267729824577,4.7565070165013035,4.836232185151167,5.16960434511123,5.009975522838339,4.9846899631504895,4.83437618681405,4.782723775734407,4.767198006865027,4.760831665300653,4.746099868607494,4.564830266006619,4.817572585286412,4.77914390326208,4.733814690544865,5.173236922414021,5.010331804961695,4.780477682084308,4.995041229311421,5.215423984589361,5.145296205216362,5.304313743386412,5.316472777815714,5.38812713903749,5.599725626865223,5.600044705669873,5.5927419420356195,5.514019120602032,5.570394490141364,5.775648388842821,5.717989423767584,5.730707203409237,5.567275894746605,5.805806667413333,5.902807998513727,5.590224561310377,5.41954960879987,5.41716490854918,5.429210074024343,5.453538520646758,5.46141953262854,5.550285787290222,5.517308605549776,5.7710862590765934,5.7076328501964895,5.73673910190643,5.69629506035019,5.801472590622368,5.994248848280061,5.938228363567614,5.6732134496296664,5.532224732129239,5.300513551196015,5.272336346580707,5.219971020469071,5.300863663569699,5.249291156525691,5.3420684727999665,5.3241011839288666,5.210285783495413,5.225447138870873,5.3002174637103865,5.376079335297393,5.351025900247399,5.172590848243412,5.282835045034603,5.233437046594235,5.112200099556109,5.021043436338508,5.066479183865826,5.086447096969463,4.969518490737328,4.8881972178978685,4.957076218083336,4.906914097622045,4.880996386703288,4.906893537810911,4.804449449616409,4.738763015488175,4.700592450086939,4.809419000609483,4.803118520423121,4.838271785558931,4.931219072810336,4.837863812874781,4.843763314111861,4.742435860891665,4.806866450253554,4.835776385027845,4.9105667233427726,4.977427672956975,5.150163124808296,5.288417772173307,5.359141848195496,5.483123946921163,5.5493747862432805,5.608313450628731,5.718007442289737,5.7308559617461166,5.741693734130508,5.676061813085924,5.832690072955721,5.867698033823714,5.8586753309788975,5.847515850572833,5.8159691649534935,5.935116256686691,5.945387054376434,6.111845077342744,6.164268640007219,6.195773220325899,6.107263651628132,6.243098391123616,6.296158386831795,6.429753498309474,6.4482879733787914,6.616133018724109,6.494425348454458,6.472140492190163,6.452159177308284,6.520158962319532,6.4003365372307055,6.4171219533837265,6.561036533205061,6.631553129620574,6.6014403620660405,6.758037997940356,6.845867361349942,6.769120022895488,6.9233955980393,6.910357231425546,6.84710023046185,6.836981918013044,6.838873085736075,6.864506186798672,6.656422665504201,6.622864113122669,6.610858403211051,6.557289912882407,6.643473133686312,6.761780638304906,6.766121449338794,6.825043572494477,6.764759376635355,6.874199962301623,6.845235695026186,6.8202671404396495,6.963306434630255,6.873938534830315,6.836231503747011,6.807503769391217,6.893460467132763,6.947549023143578,6.878460407868703,6.887058537951317,6.933834469041856,6.880114081100369,6.790735095164749,6.737019371699702,6.706119833053343,6.680861340538512,6.670893357263273],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,299],"y":[6.670893357263273,6.670893357263273],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[1.3341786714526545,3.0194569932875863,4.704735315122519,6.39001363695745,8.075291958792382,9.760570280627315,11.445848602462247,13.13112692429718,14.816405246132112,16.501683567967042,18.186961889801974,19.872240211636907,21.55751853347184,23.24279685530677,24.928075177141704,26.613353498976636,28.29863182081157,29.9839101426465,31.669188464481433,33.354466786316365],"y":[127.0694364908162,76.43095716217401,68.51434738482817,66.4118171305624,66.27139401810157,67.2303146619355,68.81077986747809,70.68180302653715,72.64247771647779,74.5909537229285,76.48333407347327,78.30342040062045,80.04623929481765,81.7110674677372,83.29849789648998,84.80981494487584,86.2467277804785,87.6113844741574,88.90635533217839,90.13450036514861],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[6.670893357263273],"y":[66.28523715885278],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,6.670893357263273,6.670893357263273],"y":[66.28523715885278,66.28523715885278,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('247a1739-89d0-4b2b-a0c1-11e11ad79b6d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We evaluate the performance of the method on the testing data using MSE and MAPE.</p>
<div id="89919017" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_percentage_error</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span> gc1_fit.predict(X_test1)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test1, y_pred1))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test1, y_pred1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1472624412385403
207.34787904142127</code></pre>
</div>
</div>
<p>Let’s look at <code>qq-plot</code> of the predictions and the actual response values using <code>draw_learning_curve()</code> method.</p>
<div id="6930b8aa" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gc1_fit.draw_learning_curve(y_test<span class="op">=</span>y_test1, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="bd2ce2f3-866a-46d6-9aa8-aaba59264312" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("bd2ce2f3-866a-46d6-9aa8-aaba59264312")) {                    Plotly.newPlot(                        "bd2ce2f3-866a-46d6-9aa8-aaba59264312",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[77.62665809912859,117.0610733373304,-197.56118737155037,-22.133110019615454,-114.39426609592529,-63.81632816577354,128.1705024299555,-19.142703094757685,241.9749445815004,-67.31463474003694,248.99358291599683,53.58777113264207,-151.21570073643866,0.7646716784450569,4.294729271268852,29.322146433130442,-271.49600577309934,17.96609003749834,152.21090232531034,59.279135671784914,-121.03739304817142,-120.04341203091774,-121.14127843966672,140.2753664857092,250.20376512681366,113.25151447709005,40.035267372086786,248.85854559529494,-136.97433599646777,162.76716011693873,-150.9499496398121,-98.37517899346959,-97.69398802365883,51.96709910695785,80.42677204726782,39.4405594106306,120.12663530107704,-335.92401528380003,-208.95566342111593,48.14721649945321,42.26713482339346,223.20230419629746,191.8425633911278,63.943494768471595,0.3049846339570518,34.05862615636854,218.97629161129228,28.881044578977306,-98.64555548523538,120.18210882865502,-192.70494227042602,-435.8155989222874,-181.19885967569206,280.83356713851333,-131.6564058138814,48.5824950601174,-65.35230414058142,-72.76757592460076,13.646978003057868,82.16445820362914,-123.2836160248559,-164.7923776248007,-190.6840268912771,-5.991390528030769,-91.29810223803102,26.602379171986804,-30.073587636087023,126.308197822847,21.329285813251126,559.7582929662497,-125.85108576809832,-174.84853600460724,-174.4843385285401,-45.16922818805723,8.753020583853038,-160.63456653077293,-83.55003401841462,98.87883271210131,254.0299663804242,242.4246281305304,-89.77698628458855,-190.8035650750847,9.862483400910953,275.4190647536663,41.166556493814724,71.82544166953546,222.11235200097207,149.3581286487418,23.88340937767786,183.99740429066657,-105.10272426884431,-33.4730116637116,46.931400148510164,449.6122853673226,-176.34555884195626,191.58704126963502,-103.36349640805693,280.27712187678634,-96.0958619811546,43.37702623913367,139.97247146978268,-81.86156079983351,-24.242852395289113,-16.253736805721495,152.91659402235246,63.71358402085484,12.823739837439584,19.86847285588762,-224.73583707603592,182.52484793263682,155.07518352629742,20.868459468497626,-180.27660134330552,-50.18767431760673,-57.077687257195976,41.767451469536326,-78.12405124709416,30.938474402362488,-158.35252890628456,-134.91121022336475,165.28386833250295,-188.64854868334166,65.78916299043703,309.33827291557986,-22.32041889872831,39.70934665844606,-152.0528810042279,-54.886628470514175,-41.99552480763533,-387.6647565008365,204.491255288854,58.73152827548237,331.08574667163083,-82.50985599005239,-218.67660616865862,-11.842827581855786,29.089879546179937,196.53807486433632,-156.2866912244859,-25.890866570844846,27.10902164266649,269.3803664467614,-201.2306124257738,163.81687528227494,-340.9187958841954,-112.68779225024278,74.90069095713685,154.4516862645878,-136.92358753316066,-257.61316489152995,-33.14165533101284,78.75593166035975,-5.068659806313638,-87.27835258464789,25.40674460494629,45.463098311424474,-77.9573557445384,-61.78844600266972,177.1574619896827,84.50358060879984,67.02865429944305,92.19581518467204,5.7268479446447556,263.41819863862423,54.42986295567795,-139.01141340710612,-50.33942227315308,326.9628424983268,-440.51335533727996,316.58696719972556,256.7753375906115,36.6257899348516,-165.13079239740205,231.40686552361757,-6.3267262149320995,-127.7009690514876,40.219524531090634,-220.40023605083948,260.1809405247371,-59.754238927377,-51.22060100590498,-136.72765571629077,85.39181602697909,-19.736476952177384,-76.5098403568304,204.2296406332639,141.89847086285047,-295.622581228759,-149.42932130946994,80.6533884836618,-45.28203378109508,32.65405823707516,34.68033423484386,7.473057990106335,166.49060095814687,124.74982928740805,33.49102068788112,-31.98542480850489,-67.70680508568705,-205.93662405163656],"xaxis":"x","y":[77.62665809912859,117.0610733373304,-197.56118737155037,-22.133110019615454,-114.39426609592529,-63.81632816577354,128.1705024299555,-19.142703094757685,241.9749445815004,-67.31463474003694,248.99358291599683,53.58777113264207,-151.21570073643866,0.7646716784450569,4.294729271268852,29.322146433130442,-271.49600577309934,17.96609003749834,152.21090232531034,59.279135671784914,-121.03739304817142,-120.04341203091774,-121.14127843966672,140.2753664857092,250.20376512681366,113.25151447709005,40.035267372086786,248.85854559529494,-136.97433599646777,162.76716011693873,-150.9499496398121,-98.37517899346959,-97.69398802365883,51.96709910695785,80.42677204726782,39.4405594106306,120.12663530107704,-335.92401528380003,-208.95566342111593,48.14721649945321,42.26713482339346,223.20230419629746,191.8425633911278,63.943494768471595,0.3049846339570518,34.05862615636854,218.97629161129228,28.881044578977306,-98.64555548523538,120.18210882865502,-192.70494227042602,-435.8155989222874,-181.19885967569206,280.83356713851333,-131.6564058138814,48.5824950601174,-65.35230414058142,-72.76757592460076,13.646978003057868,82.16445820362914,-123.2836160248559,-164.7923776248007,-190.6840268912771,-5.991390528030769,-91.29810223803102,26.602379171986804,-30.073587636087023,126.308197822847,21.329285813251126,559.7582929662497,-125.85108576809832,-174.84853600460724,-174.4843385285401,-45.16922818805723,8.753020583853038,-160.63456653077293,-83.55003401841462,98.87883271210131,254.0299663804242,242.4246281305304,-89.77698628458855,-190.8035650750847,9.862483400910953,275.4190647536663,41.166556493814724,71.82544166953546,222.11235200097207,149.3581286487418,23.88340937767786,183.99740429066657,-105.10272426884431,-33.4730116637116,46.931400148510164,449.6122853673226,-176.34555884195626,191.58704126963502,-103.36349640805693,280.27712187678634,-96.0958619811546,43.37702623913367,139.97247146978268,-81.86156079983351,-24.242852395289113,-16.253736805721495,152.91659402235246,63.71358402085484,12.823739837439584,19.86847285588762,-224.73583707603592,182.52484793263682,155.07518352629742,20.868459468497626,-180.27660134330552,-50.18767431760673,-57.077687257195976,41.767451469536326,-78.12405124709416,30.938474402362488,-158.35252890628456,-134.91121022336475,165.28386833250295,-188.64854868334166,65.78916299043703,309.33827291557986,-22.32041889872831,39.70934665844606,-152.0528810042279,-54.886628470514175,-41.99552480763533,-387.6647565008365,204.491255288854,58.73152827548237,331.08574667163083,-82.50985599005239,-218.67660616865862,-11.842827581855786,29.089879546179937,196.53807486433632,-156.2866912244859,-25.890866570844846,27.10902164266649,269.3803664467614,-201.2306124257738,163.81687528227494,-340.9187958841954,-112.68779225024278,74.90069095713685,154.4516862645878,-136.92358753316066,-257.61316489152995,-33.14165533101284,78.75593166035975,-5.068659806313638,-87.27835258464789,25.40674460494629,45.463098311424474,-77.9573557445384,-61.78844600266972,177.1574619896827,84.50358060879984,67.02865429944305,92.19581518467204,5.7268479446447556,263.41819863862423,54.42986295567795,-139.01141340710612,-50.33942227315308,326.9628424983268,-440.51335533727996,316.58696719972556,256.7753375906115,36.6257899348516,-165.13079239740205,231.40686552361757,-6.3267262149320995,-127.7009690514876,40.219524531090634,-220.40023605083948,260.1809405247371,-59.754238927377,-51.22060100590498,-136.72765571629077,85.39181602697909,-19.736476952177384,-76.5098403568304,204.2296406332639,141.89847086285047,-295.622581228759,-149.42932130946994,80.6533884836618,-45.28203378109508,32.65405823707516,34.68033423484386,7.473057990106335,166.49060095814687,124.74982928740805,33.49102068788112,-31.98542480850489,-67.70680508568705,-205.93662405163656],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[76.21128798868195,117.99584588930163,-203.92493965938974,-24.998645265798498,-109.21467923101555,-63.53723383871134,135.54485419106192,-20.539516700929187,245.48664125768923,-50.02219015699303,252.037421220793,59.85098344895496,-149.54092137846033,-0.1079229046586183,1.207616654012468,28.662897617900466,-267.73803467478325,12.37397791389258,148.29377382185157,63.235503263259204,-117.37637630690912,-114.65498055925634,-120.86128285893614,141.033925711475,247.64734182400267,115.20155461457561,44.28570142516348,239.41841111532815,-130.21416241069574,167.74502955985955,-145.83070800227756,-95.66382119032016,-97.45468617545393,55.28131218793464,80.01018233571854,27.65929518992281,121.54967214847075,-339.9438081850141,-204.84020390904993,55.45475851539211,45.1005177703509,223.9114967609049,190.58863108943947,65.22933711073443,-2.7076132267302913,38.61615015552244,213.29456910034452,24.525919008427476,-109.2295205560895,118.88481864114068,-192.27719852661775,-408.05890024808303,-183.44585385350086,272.4593406298797,-132.34214098252164,47.30848385803358,-72.69702014482716,-78.53473626779363,11.797636653521948,80.59954067602766,-124.25261001545815,-162.19325375855365,-196.3802895153826,-3.253453107144718,-95.04326109439167,23.865034647126034,-28.34745140731192,139.72453020772153,26.31550886907753,398.6830834401641,-117.71158220433436,-173.97115340440504,-188.91728801481463,-41.445845439042444,7.836041893469522,-153.86904379524066,-86.5420757752646,93.9176025606358,256.18663583920465,252.23096625147883,-83.4031580914308,-189.6563975105469,4.183396486958982,276.4200196055193,41.32487413607741,77.73658956052138,228.23780386513585,151.79822460144078,29.919020754650763,177.08122490221476,-75.92461514092989,-28.553150457658873,47.22165668763875,381.47121126826744,-184.26992345901382,185.10622484581688,-99.13046818676126,277.18302387793943,-95.39105605146341,42.742061819148184,145.36167456084237,-89.19764535228381,-21.625060345324535,-12.708970478829855,171.68926830274532,67.45295459915906,9.344830475419009,4.133266598827383,-221.95183629061933,175.4429599679582,153.14881057588758,23.580130554197844,-184.59118416936542,-54.7968233303097,-57.2402962536266,41.88421575049125,-79.58827601331257,41.83313167729212,-162.273749161125,-128.08166942003123,156.38668676306054,-191.4902321990217,66.40112106917427,310.38541173022344,-28.851434780960844,40.29890130689206,-144.00952481243132,-48.20547667445311,-32.25226324340364,-373.2324138126858,202.45694596415527,70.09069473566903,330.76031379483305,-87.83215776844368,-219.39725820425076,-13.719974473369142,27.172305330830554,189.0536363283815,-148.338101351326,-18.012893834931955,19.117958233627235,254.2648672987929,-208.27487211230195,162.7202311401985,-332.9582773355862,-108.50846170409699,67.84064251506021,147.00580047386347,-132.6441381203024,-259.8723745602272,-32.78227307969275,69.62629648589815,-0.7000442849856395,-93.13500265073387,14.292487466943266,49.912320118112426,-85.38462732691204,-75.80996111347216,215.69351154658602,83.98780881865538,63.14250158960321,84.60164278815841,2.7231422484415266,264.37034765147087,51.81124497615152,-142.3382323673337,-49.218635506713326,339.32270573701203,-460.7611912427238,337.4795713674651,243.2307603972001,39.68274792872032,-159.08923358736018,229.46984928682778,-5.053026456077218,-139.88139810930065,34.78321594297238,-217.10129453195302,252.09996759372748,-64.41767409391329,-55.03517342052615,-135.8166600026976,75.95970163279384,-22.8373665909039,-80.49892607965333,204.21836288143902,142.9938386148924,-299.5462852171946,-150.96524362859637,72.09300205528335,-48.41926135270934,42.557956474954764,29.752131656816104,13.119887193894142,164.52630629404388,133.62706349485237,30.62739356082717,-26.826351403261285,-74.7301966387231,-207.47216041972942],"xaxis":"x","y":[77.62665809912859,117.0610733373304,-197.56118737155037,-22.133110019615454,-114.39426609592529,-63.81632816577354,128.1705024299555,-19.142703094757685,241.9749445815004,-67.31463474003694,248.99358291599683,53.58777113264207,-151.21570073643866,0.7646716784450569,4.294729271268852,29.322146433130442,-271.49600577309934,17.96609003749834,152.21090232531034,59.279135671784914,-121.03739304817142,-120.04341203091774,-121.14127843966672,140.2753664857092,250.20376512681366,113.25151447709005,40.035267372086786,248.85854559529494,-136.97433599646777,162.76716011693873,-150.9499496398121,-98.37517899346959,-97.69398802365883,51.96709910695785,80.42677204726782,39.4405594106306,120.12663530107704,-335.92401528380003,-208.95566342111593,48.14721649945321,42.26713482339346,223.20230419629746,191.8425633911278,63.943494768471595,0.3049846339570518,34.05862615636854,218.97629161129228,28.881044578977306,-98.64555548523538,120.18210882865502,-192.70494227042602,-435.8155989222874,-181.19885967569206,280.83356713851333,-131.6564058138814,48.5824950601174,-65.35230414058142,-72.76757592460076,13.646978003057868,82.16445820362914,-123.2836160248559,-164.7923776248007,-190.6840268912771,-5.991390528030769,-91.29810223803102,26.602379171986804,-30.073587636087023,126.308197822847,21.329285813251126,559.7582929662497,-125.85108576809832,-174.84853600460724,-174.4843385285401,-45.16922818805723,8.753020583853038,-160.63456653077293,-83.55003401841462,98.87883271210131,254.0299663804242,242.4246281305304,-89.77698628458855,-190.8035650750847,9.862483400910953,275.4190647536663,41.166556493814724,71.82544166953546,222.11235200097207,149.3581286487418,23.88340937767786,183.99740429066657,-105.10272426884431,-33.4730116637116,46.931400148510164,449.6122853673226,-176.34555884195626,191.58704126963502,-103.36349640805693,280.27712187678634,-96.0958619811546,43.37702623913367,139.97247146978268,-81.86156079983351,-24.242852395289113,-16.253736805721495,152.91659402235246,63.71358402085484,12.823739837439584,19.86847285588762,-224.73583707603592,182.52484793263682,155.07518352629742,20.868459468497626,-180.27660134330552,-50.18767431760673,-57.077687257195976,41.767451469536326,-78.12405124709416,30.938474402362488,-158.35252890628456,-134.91121022336475,165.28386833250295,-188.64854868334166,65.78916299043703,309.33827291557986,-22.32041889872831,39.70934665844606,-152.0528810042279,-54.886628470514175,-41.99552480763533,-387.6647565008365,204.491255288854,58.73152827548237,331.08574667163083,-82.50985599005239,-218.67660616865862,-11.842827581855786,29.089879546179937,196.53807486433632,-156.2866912244859,-25.890866570844846,27.10902164266649,269.3803664467614,-201.2306124257738,163.81687528227494,-340.9187958841954,-112.68779225024278,74.90069095713685,154.4516862645878,-136.92358753316066,-257.61316489152995,-33.14165533101284,78.75593166035975,-5.068659806313638,-87.27835258464789,25.40674460494629,45.463098311424474,-77.9573557445384,-61.78844600266972,177.1574619896827,84.50358060879984,67.02865429944305,92.19581518467204,5.7268479446447556,263.41819863862423,54.42986295567795,-139.01141340710612,-50.33942227315308,326.9628424983268,-440.51335533727996,316.58696719972556,256.7753375906115,36.6257899348516,-165.13079239740205,231.40686552361757,-6.3267262149320995,-127.7009690514876,40.219524531090634,-220.40023605083948,260.1809405247371,-59.754238927377,-51.22060100590498,-136.72765571629077,85.39181602697909,-19.736476952177384,-76.5098403568304,204.2296406332639,141.89847086285047,-295.622581228759,-149.42932130946994,80.6533884836618,-45.28203378109508,32.65405823707516,34.68033423484386,7.473057990106335,166.49060095814687,124.74982928740805,33.49102068788112,-31.98542480850489,-67.70680508568705,-205.93662405163656],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('bd2ce2f3-866a-46d6-9aa8-aaba59264312');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<hr>
</section>
<section id="bullet-gradientcobra-with-non-default-parameters" class="level4">
<h4 class="anchored" data-anchor-id="bullet-gradientcobra-with-non-default-parameters"><span class="math inline">\(\bullet\)</span> <code>GradientCOBRA</code> with non-default parameters</h4>
<p>We create another object <code>gc2</code> with non-default parameters, then fit it to the same training data as in the previous example.</p>
<div id="9ff23dd3" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gc2 <span class="op">=</span> GradientCOBRA(learning_rate<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                    opt_method<span class="op">=</span><span class="st">'grad'</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                    loss_function<span class="op">=</span><span class="st">"weighted_mse"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                    max_iter<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                    estimator_list<span class="op">=</span>[<span class="st">'random_forest'</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'adaboost'</span>, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'knn'</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'lasso'</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'ridge'</span>],</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                    estimator_params<span class="op">=</span>{</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'random_forest'</span> : {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'n_estimators'</span> : <span class="dv">300</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'min_samples_leaf'</span> : <span class="dv">5</span>},</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'adaboost'</span> : {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'n_estimators'</span> : <span class="dv">300</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'max_depth'</span> : <span class="dv">5</span>},</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'knn'</span> : {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'n_neighbors'</span> : <span class="dv">10</span>}</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>gc2_fit <span class="op">=</span> gc2.fit(X_train1, y_train1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: -2.664 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.010 / grad: -2.664 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.010 / grad: -0.226 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.010 / grad: -0.226 / stop criter: 2.664 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.011 / grad: -3.806 / stop criter: 0.226 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.011 / grad: -3.806 / stop criter: 0.226 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 3.025 / grad: 1.798 / stop criter: 3.806 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 7 / bw: 3.025 / grad: 1.798 / stop criter: 3.806 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 3.018 / grad: -1.526 / stop criter: 1.798 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 3.018 / grad: -1.526 / stop criter: 1.798 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 3.024 / grad: -0.008 / stop criter: 1.526 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 3.024 / grad: -0.008 / stop criter: 1.526 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 3.024 / grad: -0.152 / stop criter: 0.008 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 3.024 / grad: -0.152 / stop criter: 0.008 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 3.024 / grad: -0.152 / stop criter: 0.008 :   3%|▎         | 10/300 [00:00&lt;00:02, 116.13it/s]</code></pre>
</div>
</div>
<p>Now, let’s compare it to the previous example.</p>
<div id="9ea1ff7a" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(gc2_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gc2_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :3.024651586048566</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="fa2799ff-32b6-4a8a-9cc8-4aaf46252e1f" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fa2799ff-32b6-4a8a-9cc8-4aaf46252e1f")) {                    Plotly.newPlot(                        "fa2799ff-32b6-4a8a-9cc8-4aaf46252e1f",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9],"y":[3.01,3.01,3.01,3.01,3.01,3.010850165795319,3.025139329778502,3.0183877859363943,3.024059619352324,3.0240907661514322],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,9],"y":[3.0240907661514322,3.0240907661514322],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.6049303172097132,1.3690528231588246,2.133175329107936,2.8972978350570475,3.661420341006159,4.4255428469552704,5.189665352904382,5.953787858853493,6.717910364802605,7.482032870751716,8.246155376700829,9.010277882649941,9.774400388599052,10.538522894548162,11.302645400497275,12.066767906446387,12.830890412395497,13.595012918344608,14.35913542429372,15.123257930242831],"y":[3.793526423495348,2.1460018398269507,1.825983700977035,1.774714958995732,1.806035381496401,1.857741102229283,1.9083860416048766,1.9516526231642988,1.9868063512748022,2.014932728739995,2.0374858093639476,2.0557836210685636,2.0708699478577044,2.083528283981312,2.0943368680160717,2.103711482493799,2.1119450782069285,2.11857367330841,3.063485518465064,17.456081154345092],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[3.024651586048566],"y":[1.7767014909194416],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,3.024651586048566,3.024651586048566],"y":[1.7767014909194416,1.7767014909194416,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fa2799ff-32b6-4a8a-9cc8-4aaf46252e1f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Compare MSE and MAPE.</p>
<div id="96656a64" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span> gc2_fit.predict(X_test1)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test1, y_pred2))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test1, y_pred2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2829808883045769
119.93078678083599</code></pre>
</div>
</div>
<p>Compare <code>qq-plot</code>.</p>
<div id="8ddee8bf" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gc2_fit.draw_learning_curve(y_test<span class="op">=</span>y_test1, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="480b8992-84b2-458d-94d4-158ee9170d56" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("480b8992-84b2-458d-94d4-158ee9170d56")) {                    Plotly.newPlot(                        "480b8992-84b2-458d-94d4-158ee9170d56",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[77.62665809912859,117.0610733373304,-197.56118737155037,-22.133110019615454,-114.39426609592529,-63.81632816577354,128.1705024299555,-19.142703094757685,241.9749445815004,-67.31463474003694,248.99358291599683,53.58777113264207,-151.21570073643866,0.7646716784450569,4.294729271268852,29.322146433130442,-271.49600577309934,17.96609003749834,152.21090232531034,59.279135671784914,-121.03739304817142,-120.04341203091774,-121.14127843966672,140.2753664857092,250.20376512681366,113.25151447709005,40.035267372086786,248.85854559529494,-136.97433599646777,162.76716011693873,-150.9499496398121,-98.37517899346959,-97.69398802365883,51.96709910695785,80.42677204726782,39.4405594106306,120.12663530107704,-335.92401528380003,-208.95566342111593,48.14721649945321,42.26713482339346,223.20230419629746,191.8425633911278,63.943494768471595,0.3049846339570518,34.05862615636854,218.97629161129228,28.881044578977306,-98.64555548523538,120.18210882865502,-192.70494227042602,-435.8155989222874,-181.19885967569206,280.83356713851333,-131.6564058138814,48.5824950601174,-65.35230414058142,-72.76757592460076,13.646978003057868,82.16445820362914,-123.2836160248559,-164.7923776248007,-190.6840268912771,-5.991390528030769,-91.29810223803102,26.602379171986804,-30.073587636087023,126.308197822847,21.329285813251126,559.7582929662497,-125.85108576809832,-174.84853600460724,-174.4843385285401,-45.16922818805723,8.753020583853038,-160.63456653077293,-83.55003401841462,98.87883271210131,254.0299663804242,242.4246281305304,-89.77698628458855,-190.8035650750847,9.862483400910953,275.4190647536663,41.166556493814724,71.82544166953546,222.11235200097207,149.3581286487418,23.88340937767786,183.99740429066657,-105.10272426884431,-33.4730116637116,46.931400148510164,449.6122853673226,-176.34555884195626,191.58704126963502,-103.36349640805693,280.27712187678634,-96.0958619811546,43.37702623913367,139.97247146978268,-81.86156079983351,-24.242852395289113,-16.253736805721495,152.91659402235246,63.71358402085484,12.823739837439584,19.86847285588762,-224.73583707603592,182.52484793263682,155.07518352629742,20.868459468497626,-180.27660134330552,-50.18767431760673,-57.077687257195976,41.767451469536326,-78.12405124709416,30.938474402362488,-158.35252890628456,-134.91121022336475,165.28386833250295,-188.64854868334166,65.78916299043703,309.33827291557986,-22.32041889872831,39.70934665844606,-152.0528810042279,-54.886628470514175,-41.99552480763533,-387.6647565008365,204.491255288854,58.73152827548237,331.08574667163083,-82.50985599005239,-218.67660616865862,-11.842827581855786,29.089879546179937,196.53807486433632,-156.2866912244859,-25.890866570844846,27.10902164266649,269.3803664467614,-201.2306124257738,163.81687528227494,-340.9187958841954,-112.68779225024278,74.90069095713685,154.4516862645878,-136.92358753316066,-257.61316489152995,-33.14165533101284,78.75593166035975,-5.068659806313638,-87.27835258464789,25.40674460494629,45.463098311424474,-77.9573557445384,-61.78844600266972,177.1574619896827,84.50358060879984,67.02865429944305,92.19581518467204,5.7268479446447556,263.41819863862423,54.42986295567795,-139.01141340710612,-50.33942227315308,326.9628424983268,-440.51335533727996,316.58696719972556,256.7753375906115,36.6257899348516,-165.13079239740205,231.40686552361757,-6.3267262149320995,-127.7009690514876,40.219524531090634,-220.40023605083948,260.1809405247371,-59.754238927377,-51.22060100590498,-136.72765571629077,85.39181602697909,-19.736476952177384,-76.5098403568304,204.2296406332639,141.89847086285047,-295.622581228759,-149.42932130946994,80.6533884836618,-45.28203378109508,32.65405823707516,34.68033423484386,7.473057990106335,166.49060095814687,124.74982928740805,33.49102068788112,-31.98542480850489,-67.70680508568705,-205.93662405163656],"xaxis":"x","y":[77.62665809912859,117.0610733373304,-197.56118737155037,-22.133110019615454,-114.39426609592529,-63.81632816577354,128.1705024299555,-19.142703094757685,241.9749445815004,-67.31463474003694,248.99358291599683,53.58777113264207,-151.21570073643866,0.7646716784450569,4.294729271268852,29.322146433130442,-271.49600577309934,17.96609003749834,152.21090232531034,59.279135671784914,-121.03739304817142,-120.04341203091774,-121.14127843966672,140.2753664857092,250.20376512681366,113.25151447709005,40.035267372086786,248.85854559529494,-136.97433599646777,162.76716011693873,-150.9499496398121,-98.37517899346959,-97.69398802365883,51.96709910695785,80.42677204726782,39.4405594106306,120.12663530107704,-335.92401528380003,-208.95566342111593,48.14721649945321,42.26713482339346,223.20230419629746,191.8425633911278,63.943494768471595,0.3049846339570518,34.05862615636854,218.97629161129228,28.881044578977306,-98.64555548523538,120.18210882865502,-192.70494227042602,-435.8155989222874,-181.19885967569206,280.83356713851333,-131.6564058138814,48.5824950601174,-65.35230414058142,-72.76757592460076,13.646978003057868,82.16445820362914,-123.2836160248559,-164.7923776248007,-190.6840268912771,-5.991390528030769,-91.29810223803102,26.602379171986804,-30.073587636087023,126.308197822847,21.329285813251126,559.7582929662497,-125.85108576809832,-174.84853600460724,-174.4843385285401,-45.16922818805723,8.753020583853038,-160.63456653077293,-83.55003401841462,98.87883271210131,254.0299663804242,242.4246281305304,-89.77698628458855,-190.8035650750847,9.862483400910953,275.4190647536663,41.166556493814724,71.82544166953546,222.11235200097207,149.3581286487418,23.88340937767786,183.99740429066657,-105.10272426884431,-33.4730116637116,46.931400148510164,449.6122853673226,-176.34555884195626,191.58704126963502,-103.36349640805693,280.27712187678634,-96.0958619811546,43.37702623913367,139.97247146978268,-81.86156079983351,-24.242852395289113,-16.253736805721495,152.91659402235246,63.71358402085484,12.823739837439584,19.86847285588762,-224.73583707603592,182.52484793263682,155.07518352629742,20.868459468497626,-180.27660134330552,-50.18767431760673,-57.077687257195976,41.767451469536326,-78.12405124709416,30.938474402362488,-158.35252890628456,-134.91121022336475,165.28386833250295,-188.64854868334166,65.78916299043703,309.33827291557986,-22.32041889872831,39.70934665844606,-152.0528810042279,-54.886628470514175,-41.99552480763533,-387.6647565008365,204.491255288854,58.73152827548237,331.08574667163083,-82.50985599005239,-218.67660616865862,-11.842827581855786,29.089879546179937,196.53807486433632,-156.2866912244859,-25.890866570844846,27.10902164266649,269.3803664467614,-201.2306124257738,163.81687528227494,-340.9187958841954,-112.68779225024278,74.90069095713685,154.4516862645878,-136.92358753316066,-257.61316489152995,-33.14165533101284,78.75593166035975,-5.068659806313638,-87.27835258464789,25.40674460494629,45.463098311424474,-77.9573557445384,-61.78844600266972,177.1574619896827,84.50358060879984,67.02865429944305,92.19581518467204,5.7268479446447556,263.41819863862423,54.42986295567795,-139.01141340710612,-50.33942227315308,326.9628424983268,-440.51335533727996,316.58696719972556,256.7753375906115,36.6257899348516,-165.13079239740205,231.40686552361757,-6.3267262149320995,-127.7009690514876,40.219524531090634,-220.40023605083948,260.1809405247371,-59.754238927377,-51.22060100590498,-136.72765571629077,85.39181602697909,-19.736476952177384,-76.5098403568304,204.2296406332639,141.89847086285047,-295.622581228759,-149.42932130946994,80.6533884836618,-45.28203378109508,32.65405823707516,34.68033423484386,7.473057990106335,166.49060095814687,124.74982928740805,33.49102068788112,-31.98542480850489,-67.70680508568705,-205.93662405163656],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[69.84664496114114,111.28494784384738,-168.6873355555367,-7.883304888647495,-114.13119682824195,-62.92615149969597,134.53576487462107,-6.668812978549677,245.69593312988388,-64.59350958653705,238.30330494575202,60.84275215883701,-147.4498212190004,7.64578158834789,4.328191527282835,27.425829720681957,-275.48896811029346,14.74731224566034,147.4040130476478,52.83963808135163,-111.88515283676826,-109.39919262995784,-126.74398680495437,143.00742566979858,262.3480425444673,125.20711340216704,38.094287117398366,250.52340964620456,-134.83059254423526,161.03889647877128,-144.75114124270084,-83.3732559296868,-111.3184977355735,53.720094984759825,70.0150144021926,33.22749310964784,121.71574711951426,-367.9460589173736,-192.15470135788306,43.405350152427324,39.83594283769321,228.12658768364005,180.3821850739354,68.50526594292161,7.595448031441881,38.36864289004009,206.73994220695803,21.407661880280045,-109.09535433660662,104.61339421994496,-165.70163072845733,-406.89475174531276,-182.11512966383518,265.2249788445906,-121.01234849453645,45.05495450398244,-74.06841128116498,-77.16992914412346,11.017409818560996,91.87777646163578,-120.92388393723283,-157.69986578910513,-169.5663911714846,0.46815305307587046,-90.59068794028681,24.59489240048994,-23.712743202204805,137.59041468456738,30.298352661318166,485.9046570548035,-117.68175819309278,-172.4284952568419,-164.90330599177872,-42.39070015247479,15.956250858155544,-157.34450670341715,-86.9435272220544,102.67543997294304,240.23795751546004,240.35545415047113,-90.2959226540139,-177.61415563165144,11.575230759152392,265.50184729846814,45.508526067713646,77.33425564138649,225.25215819209527,149.63893574228948,26.882617778963574,172.71573100377393,-92.09591096973818,-28.90517152940397,46.35725341515949,416.1786992231918,-186.27885309610474,176.9468767141589,-98.26840111790155,284.51431931234276,-104.45640608963481,30.73705430946981,140.76027250842355,-91.13157213977267,-15.7569167298128,-17.69519985584215,156.3430247587956,56.63031382577327,8.001343383097566,22.180480750008424,-208.37842001785486,177.28821900995217,151.90832015158122,24.127906046411137,-172.79553403274036,-55.735587156164854,-60.75992994445359,41.567043878114085,-76.62197729465753,44.98116410615142,-155.43556632112276,-127.30760797771018,157.85299767938585,-176.19209728633575,63.06174571769459,308.525013913389,-25.070166546547394,39.46294656696544,-128.37151786873713,-55.30314249395553,-45.54065809005043,-385.75147808477726,199.98213173361844,62.44385432905534,328.5688260567029,-88.02480776134144,-221.10507244569968,0.3688565712418117,27.06779507246196,180.1890351438212,-144.39511822432334,-17.498268411398584,32.21834717512006,272.2901711335782,-183.93783463176504,159.33652921445682,-332.8255471010489,-96.19661418705508,65.5377286753697,154.17939926811368,-137.87853171667308,-250.64542640152834,-20.546853846420483,76.31077154202826,-9.94041697804663,-93.26185127344608,19.53025578999763,37.08889290773834,-93.37294595450469,-75.37817516116391,186.22114648916278,87.5779461976738,53.88157506325672,79.99244776942479,9.802034801666201,252.47900305466308,49.215608857715196,-141.12880279434512,-31.233167780000628,324.32250411596533,-440.0349459376132,328.51451201022616,260.5622796983496,35.35380810761422,-163.66124926530622,230.6992016226865,-2.769215143822141,-138.87544676676703,42.00373571210725,-230.65681942711947,263.58395093921763,-49.806571681402126,-67.2773173885868,-131.7537061859211,71.68259259712651,-15.898981873723837,-62.87314698696124,189.64208291988461,140.4763761783688,-288.31028577031424,-143.85209437262083,57.872997165413885,-51.20742256477274,26.872485262613463,23.26714027028105,11.785530423413794,160.60962594235897,122.13137130270266,26.963684965268996,-32.45865423530054,-79.6508345494061,-186.00505999254608],"xaxis":"x","y":[77.62665809912859,117.0610733373304,-197.56118737155037,-22.133110019615454,-114.39426609592529,-63.81632816577354,128.1705024299555,-19.142703094757685,241.9749445815004,-67.31463474003694,248.99358291599683,53.58777113264207,-151.21570073643866,0.7646716784450569,4.294729271268852,29.322146433130442,-271.49600577309934,17.96609003749834,152.21090232531034,59.279135671784914,-121.03739304817142,-120.04341203091774,-121.14127843966672,140.2753664857092,250.20376512681366,113.25151447709005,40.035267372086786,248.85854559529494,-136.97433599646777,162.76716011693873,-150.9499496398121,-98.37517899346959,-97.69398802365883,51.96709910695785,80.42677204726782,39.4405594106306,120.12663530107704,-335.92401528380003,-208.95566342111593,48.14721649945321,42.26713482339346,223.20230419629746,191.8425633911278,63.943494768471595,0.3049846339570518,34.05862615636854,218.97629161129228,28.881044578977306,-98.64555548523538,120.18210882865502,-192.70494227042602,-435.8155989222874,-181.19885967569206,280.83356713851333,-131.6564058138814,48.5824950601174,-65.35230414058142,-72.76757592460076,13.646978003057868,82.16445820362914,-123.2836160248559,-164.7923776248007,-190.6840268912771,-5.991390528030769,-91.29810223803102,26.602379171986804,-30.073587636087023,126.308197822847,21.329285813251126,559.7582929662497,-125.85108576809832,-174.84853600460724,-174.4843385285401,-45.16922818805723,8.753020583853038,-160.63456653077293,-83.55003401841462,98.87883271210131,254.0299663804242,242.4246281305304,-89.77698628458855,-190.8035650750847,9.862483400910953,275.4190647536663,41.166556493814724,71.82544166953546,222.11235200097207,149.3581286487418,23.88340937767786,183.99740429066657,-105.10272426884431,-33.4730116637116,46.931400148510164,449.6122853673226,-176.34555884195626,191.58704126963502,-103.36349640805693,280.27712187678634,-96.0958619811546,43.37702623913367,139.97247146978268,-81.86156079983351,-24.242852395289113,-16.253736805721495,152.91659402235246,63.71358402085484,12.823739837439584,19.86847285588762,-224.73583707603592,182.52484793263682,155.07518352629742,20.868459468497626,-180.27660134330552,-50.18767431760673,-57.077687257195976,41.767451469536326,-78.12405124709416,30.938474402362488,-158.35252890628456,-134.91121022336475,165.28386833250295,-188.64854868334166,65.78916299043703,309.33827291557986,-22.32041889872831,39.70934665844606,-152.0528810042279,-54.886628470514175,-41.99552480763533,-387.6647565008365,204.491255288854,58.73152827548237,331.08574667163083,-82.50985599005239,-218.67660616865862,-11.842827581855786,29.089879546179937,196.53807486433632,-156.2866912244859,-25.890866570844846,27.10902164266649,269.3803664467614,-201.2306124257738,163.81687528227494,-340.9187958841954,-112.68779225024278,74.90069095713685,154.4516862645878,-136.92358753316066,-257.61316489152995,-33.14165533101284,78.75593166035975,-5.068659806313638,-87.27835258464789,25.40674460494629,45.463098311424474,-77.9573557445384,-61.78844600266972,177.1574619896827,84.50358060879984,67.02865429944305,92.19581518467204,5.7268479446447556,263.41819863862423,54.42986295567795,-139.01141340710612,-50.33942227315308,326.9628424983268,-440.51335533727996,316.58696719972556,256.7753375906115,36.6257899348516,-165.13079239740205,231.40686552361757,-6.3267262149320995,-127.7009690514876,40.219524531090634,-220.40023605083948,260.1809405247371,-59.754238927377,-51.22060100590498,-136.72765571629077,85.39181602697909,-19.736476952177384,-76.5098403568304,204.2296406332639,141.89847086285047,-295.622581228759,-149.42932130946994,80.6533884836618,-45.28203378109508,32.65405823707516,34.68033423484386,7.473057990106335,166.49060095814687,124.74982928740805,33.49102068788112,-31.98542480850489,-67.70680508568705,-205.93662405163656],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('480b8992-84b2-458d-94d4-158ee9170d56');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<hr>
</section>
</section>
<section id="gradientcobra-on-real-dataset" class="level3">
<h3 class="anchored" data-anchor-id="gradientcobra-on-real-dataset"><code>GradientCOBRA</code> on real dataset</h3>
<p>We look at the <a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California</a> housing dataset from <code>sklearn.datasets</code> module. To illustrate the idea, we only work with the first <span class="math inline">\(1000\)</span> observations.</p>
<div id="3cc95583" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_california_housing</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> fetch_california_housing()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>X_real, y_real <span class="op">=</span> data[<span class="st">'data'</span>], data[<span class="st">'target'</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>X_train_real, X_test_real, y_train_real, y_test_real <span class="op">=</span> train_test_split(X_real[:<span class="dv">1000</span>,:], y_real[:<span class="dv">1000</span>], test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'shape: x_train = </span><span class="sc">{}</span><span class="st"> , x_train = </span><span class="sc">{}</span><span class="st"> , y_train = </span><span class="sc">{}</span><span class="st"> , y_test = </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(X_train_real.shape, X_test_real.shape, y_train_real.shape, y_test_real.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: x_train = (800, 8) , x_train = (200, 8) , y_train = (800,) , y_test = (200,)</code></pre>
</div>
</div>
<p>We gave some random parameters to the method as follows.</p>
<div id="34f652ea" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gc_real <span class="op">=</span> GradientCOBRA(opt_method<span class="op">=</span><span class="st">"grad"</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                        learning_rate<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                        estimator_list<span class="op">=</span>[<span class="st">'random_forest'</span>, <span class="st">'knn'</span>, <span class="st">'ridge'</span>, <span class="st">'lasso'</span>],</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                        estimator_params<span class="op">=</span>{</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'random_forest'</span> : {<span class="st">'n_estimators'</span>: <span class="dv">300</span>},</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'knn'</span> : {<span class="st">'n_neighbors'</span> : <span class="dv">10</span>}</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>gc_real_fit <span class="op">=</span> gc_real.fit(X_train_real, y_train_real)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: -0.027 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.010 / grad: -0.027 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.010 / grad: 0.025 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 5 / bw: 3.010 / grad: 0.025 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.001 / grad: 0.011 / stop criter: 0.025 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.001 / grad: 0.011 / stop criter: 0.025 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.997 / grad: -0.046 / stop criter: 0.011 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.997 / grad: -0.046 / stop criter: 0.011 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 3.014 / grad: -0.003 / stop criter: 0.046 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 3.014 / grad: -0.003 / stop criter: 0.046 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 3.015 / grad: 0.059 / stop criter: 0.003 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 9 / bw: 3.015 / grad: 0.059 / stop criter: 0.003 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 3.015 / grad: 0.059 / stop criter: 0.003 :   3%|▎         | 9/300 [00:00&lt;00:03, 92.69it/s]</code></pre>
</div>
</div>
<p>Now, let’s look at the obtained bandwidth and the optimization result.</p>
<div id="9a0a47ce" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal bandwidth: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(gc_real_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>gc_real_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal bandwidth: 2.9934216302457184</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="af9497fa-bb3e-4e66-b5f4-ef8457d883f8" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("af9497fa-bb3e-4e66-b5f4-ef8457d883f8")) {                    Plotly.newPlot(                        "af9497fa-bb3e-4e66-b5f4-ef8457d883f8",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"y":[3.01,3.01,3.01,3.01,3.01,3.0009669477292875,2.997015504698858,3.0135514037921345,3.0145225252373393],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,8],"y":[3.0145225252373393,3.0145225252373393],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.5986843260491437,1.354917158953325,2.1111499918575065,2.8673828247616884,3.62361565766587,4.379848490570051,5.136081323474233,5.892314156378414,6.648546989282596,7.404779822186778,8.161012655090959,8.91724548799514,9.673478320899322,10.429711153803504,11.185943986707684,11.942176819611866,12.698409652516048,13.45464248542023,14.210875318324412,14.967108151228592],"y":[0.20721546425584,0.1868130460684906,0.18329358581553387,0.1827561999086918,0.1832442580060102,0.18417639978019018,0.1853113425320873,0.18654029756875184,0.1878163550960301,0.18912152396504653,0.19044990226548036,0.19179976242829216,0.19317022140367987,0.1945601075108484,0.19596772412668115,0.1973909557132305,0.19882740406752686,0.2002746202290131,0.2017302006920459,0.20319178825185938],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[2.9934216302457184],"y":[0.18278915052173889],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,2.9934216302457184,2.9934216302457184],"y":[0.18278915052173889,0.18278915052173889,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('af9497fa-bb3e-4e66-b5f4-ef8457d883f8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We look at the numerical and graphical performance.</p>
<div id="fbc5bd94" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>y_pred_real <span class="op">=</span> gc_real_fit.predict(X_test_real)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test_real, y_pred_real))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test_real, y_pred_real))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>gc_real_fit.draw_learning_curve(y_test<span class="op">=</span>y_test_real, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.17243806922881547
0.270561265848443</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="fec54adb-28b6-44c4-b9c8-e6de46c9fe3b" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fec54adb-28b6-44c4-b9c8-e6de46c9fe3b")) {                    Plotly.newPlot(                        "fec54adb-28b6-44c4-b9c8-e6de46c9fe3b",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0.975,2.923,2.125,3.053,2.697,2.34,5.00001,3.5,2.738,1.619,2.208,4.153,1.228,0.797,0.858,1.969,1.279,2.469,1.6,1.125,5.00001,2.403,2.625,1.875,2.103,1.791,1.996,4.833,1.596,2.457,1.543,1.72,3.373,2.089,1.526,1.375,3.326,2.18,1.692,3.898,1.654,3.324,2.08,2.964,0.853,1.555,2.438,1.592,3.115,0.975,3.011,1.325,1.799,1.969,1.826,2.31,2.768,1.891,2.75,1.921,2.899,2.297,2.137,1.024,2.006,2.316,0.888,2.711,1.531,3.5,1.833,2.398,0.861,1.809,0.6,2.699,2.322,2.284,0.893,2.697,1.567,2.876,0.895,1.181,1.598,2.654,3.372,2.313,1.37,1.25,3.147,2.364,2.734,2.155,2.188,4.125,2.042,1.938,3.115,2.56,3.416,1.449,1.076,1.979,1.535,0.905,1.565,2.099,3.368,2.735,2.213,2.422,2.032,1.125,1.792,1.571,2.306,2.0,1.406,1.643,2.639,1.079,1.607,2.854,1.612,1.014,1.827,2.713,2.714,2.17,1.621,2.212,2.277,0.918,1.565,3.97,0.803,2.318,3.524,1.894,2.277,1.81,1.702,2.528,3.357,1.521,1.75,2.092,0.938,0.972,1.7,1.614,2.75,3.367,0.947,1.448,0.893,1.373,2.192,1.75,1.514,0.952,1.004,2.157,1.669,2.209,2.757,4.5,0.75,3.507,1.188,2.385,1.673,2.396,3.404,1.417,2.848,1.325,2.045,5.00001,1.375,1.161,1.58,2.858,2.042,2.082,1.055,1.609,0.834,0.973,1.84,1.26,2.952,2.471,1.8,1.201,0.962,1.76,3.333,0.846],"xaxis":"x","y":[0.975,2.923,2.125,3.053,2.697,2.34,5.00001,3.5,2.738,1.619,2.208,4.153,1.228,0.797,0.858,1.969,1.279,2.469,1.6,1.125,5.00001,2.403,2.625,1.875,2.103,1.791,1.996,4.833,1.596,2.457,1.543,1.72,3.373,2.089,1.526,1.375,3.326,2.18,1.692,3.898,1.654,3.324,2.08,2.964,0.853,1.555,2.438,1.592,3.115,0.975,3.011,1.325,1.799,1.969,1.826,2.31,2.768,1.891,2.75,1.921,2.899,2.297,2.137,1.024,2.006,2.316,0.888,2.711,1.531,3.5,1.833,2.398,0.861,1.809,0.6,2.699,2.322,2.284,0.893,2.697,1.567,2.876,0.895,1.181,1.598,2.654,3.372,2.313,1.37,1.25,3.147,2.364,2.734,2.155,2.188,4.125,2.042,1.938,3.115,2.56,3.416,1.449,1.076,1.979,1.535,0.905,1.565,2.099,3.368,2.735,2.213,2.422,2.032,1.125,1.792,1.571,2.306,2.0,1.406,1.643,2.639,1.079,1.607,2.854,1.612,1.014,1.827,2.713,2.714,2.17,1.621,2.212,2.277,0.918,1.565,3.97,0.803,2.318,3.524,1.894,2.277,1.81,1.702,2.528,3.357,1.521,1.75,2.092,0.938,0.972,1.7,1.614,2.75,3.367,0.947,1.448,0.893,1.373,2.192,1.75,1.514,0.952,1.004,2.157,1.669,2.209,2.757,4.5,0.75,3.507,1.188,2.385,1.673,2.396,3.404,1.417,2.848,1.325,2.045,5.00001,1.375,1.161,1.58,2.858,2.042,2.082,1.055,1.609,0.834,0.973,1.84,1.26,2.952,2.471,1.8,1.201,0.962,1.76,3.333,0.846],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[1.1225816407043916,3.367698127657624,2.022617151229119,2.9046567923760365,2.211691311161312,2.0451614926882677,3.818916300883616,2.016007541068505,3.0047809109595622,1.7802368315998376,1.897255441160855,3.3725505362979273,1.7354537414031903,1.0218407776224188,1.0001930068673113,2.2855838318878177,1.4212507779755248,2.7070254194048085,1.6414350793977899,1.0120888153333838,5.0000063590745665,2.327103358718368,3.3689933086547317,1.6303555717614522,1.8861444314136346,1.966796842022664,1.9364671899752743,3.3065239403577436,1.861619977198678,2.6999969730565714,1.8242144937633198,1.8720019777812942,3.184761473157807,1.9923359981184514,1.6957700345992126,1.6261942741415807,3.247818551699984,1.9431178388058483,1.9606983981643558,3.473230055990916,1.8715067374895458,2.211882011161351,2.256686440333539,3.0224567921983807,1.0569353050495454,1.668592216023521,1.9784384587837003,1.7822816338415925,3.1460598005646987,1.1151650905792998,2.0401471896840113,1.2003387839657036,1.8166408674740402,3.0293522641501918,2.2636056423416413,2.2860595123597056,2.063781100409582,1.993292372882732,1.4619219311991132,2.0803675422610524,2.9660834711260566,2.3202262682349892,2.2523432928553144,1.1227171289162954,1.996184771225504,2.1409889566726092,1.070256988565219,2.3122511748020442,1.7721849972646848,1.928276615380985,1.77719507864165,2.4756067904479515,0.9828936464526061,1.8572493664246155,1.4091410753772404,2.3564037005281935,2.910990140914929,2.376810877078904,1.1113387545037614,2.367041365007141,1.7934310502849893,2.551065189769833,0.9980583418244113,1.1939826465767078,1.4135325776480043,2.6802394467811883,3.3504300653733634,1.5019501454289135,1.099245646255549,1.4492084583206115,2.5441797158030637,2.3978857010704306,2.1754168200340755,2.4124635308269076,1.8774112824322255,3.251992205226894,2.252197528232665,2.1726227782570477,3.121257093381354,2.1229993224379893,3.538592580303237,1.7355392689228062,1.3516555916654742,2.0013483933459075,1.719407554607072,1.0208987327798553,1.8784444135279303,2.0361242868310123,1.8168963321115092,3.0785425287333084,2.178493411766136,2.5315588171347794,2.202185654414992,1.2244638009628146,1.2206704557217476,1.799469055773424,1.9022274031262971,2.047153510913401,1.7599748159179138,1.9892514376274697,2.7115056634092376,1.3387171411497298,1.902039948197943,3.371203850628292,1.8382304561824967,1.2394388756902563,1.8854009588996705,1.8747262810613539,1.9583399537757529,2.1574160398807485,1.8074290488710243,2.1421386606029307,1.9552514075309961,1.0850604914175546,1.8628146356477047,4.6509992960231,1.0865845388348356,2.5966872673792754,3.1509057944353023,1.95735822580373,2.4126941191159244,1.769054437146824,1.6114541292366895,2.891928085709759,1.9652478717317972,1.9135917493110477,1.670249001632457,2.0879402613822737,1.6761151255731996,1.3875128141318225,1.584392233409607,1.9343048855163951,2.3518962290022314,2.8181610645316355,1.1765770917890517,1.6319395986384482,1.0416407615930885,1.7783028626409598,2.0436628656381344,1.6865967547592797,2.018272516076438,1.0226953427481302,1.3221216517774654,1.8760203081108826,1.7417787861707041,2.3142555960134836,2.4192542242149186,2.801769993946565,3.04175886119147,3.5973813648694684,1.0476727706095552,2.1401410637330867,1.3346167495006391,2.792869180114705,3.191082934854346,1.4691799655265139,3.3929775834392286,1.3139418763069384,2.097292066489042,1.7934880545320637,1.0849715654919188,1.5697068134716594,2.1896316013282426,3.1363352681388106,1.879774379287642,1.972587730695235,1.1481866966179424,1.8915680498403078,1.1830705045819923,1.213154589857906,1.9241844793935552,1.286404457833995,2.490359159143682,2.750466261553898,1.9832630848604267,1.7314700806224366,1.1806684464292336,2.016838788227784,3.4002019861019144,1.038483372718865],"xaxis":"x","y":[0.975,2.923,2.125,3.053,2.697,2.34,5.00001,3.5,2.738,1.619,2.208,4.153,1.228,0.797,0.858,1.969,1.279,2.469,1.6,1.125,5.00001,2.403,2.625,1.875,2.103,1.791,1.996,4.833,1.596,2.457,1.543,1.72,3.373,2.089,1.526,1.375,3.326,2.18,1.692,3.898,1.654,3.324,2.08,2.964,0.853,1.555,2.438,1.592,3.115,0.975,3.011,1.325,1.799,1.969,1.826,2.31,2.768,1.891,2.75,1.921,2.899,2.297,2.137,1.024,2.006,2.316,0.888,2.711,1.531,3.5,1.833,2.398,0.861,1.809,0.6,2.699,2.322,2.284,0.893,2.697,1.567,2.876,0.895,1.181,1.598,2.654,3.372,2.313,1.37,1.25,3.147,2.364,2.734,2.155,2.188,4.125,2.042,1.938,3.115,2.56,3.416,1.449,1.076,1.979,1.535,0.905,1.565,2.099,3.368,2.735,2.213,2.422,2.032,1.125,1.792,1.571,2.306,2.0,1.406,1.643,2.639,1.079,1.607,2.854,1.612,1.014,1.827,2.713,2.714,2.17,1.621,2.212,2.277,0.918,1.565,3.97,0.803,2.318,3.524,1.894,2.277,1.81,1.702,2.528,3.357,1.521,1.75,2.092,0.938,0.972,1.7,1.614,2.75,3.367,0.947,1.448,0.893,1.373,2.192,1.75,1.514,0.952,1.004,2.157,1.669,2.209,2.757,4.5,0.75,3.507,1.188,2.385,1.673,2.396,3.404,1.417,2.848,1.325,2.045,5.00001,1.375,1.161,1.58,2.858,2.042,2.082,1.055,1.609,0.834,0.973,1.84,1.26,2.952,2.471,1.8,1.201,0.962,1.76,3.333,0.846],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fec54adb-28b6-44c4-b9c8-e6de46c9fe3b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="a-comparison-with-adaboost" class="level3">
<h3 class="anchored" data-anchor-id="a-comparison-with-adaboost">A comparison with <code>Adaboost</code></h3>
<p>We campare the fitted method on <code>California</code> data with Adaboost method.</p>
<div id="78aeeb17" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> AdaBoostRegressor</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ada <span class="op">=</span> AdaBoostRegressor(n_estimators<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ada_fit <span class="op">=</span> ada.fit(X_train_real, y_train_real)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ada_pred <span class="op">=</span> ada_fit.predict(X_test_real)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test_real, ada_pred))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test_real, ada_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2583298469071653
0.29885486114201343</code></pre>
</div>
</div>
<hr>
</section>
<section id="pretrained-basic-estimators" class="level3">
<h3 class="anchored" data-anchor-id="pretrained-basic-estimators">Pretrained basic estimators</h3>
<p>An interesting application of consensual aggregation methods is having pretrained estimators from some source, then applying them to other testing data (not necessarily from the same source, having the same inputs is enough). The only requirement is the predictability of the basic estimators on new the observations, and only the predicted features are used in the aggregation. Here, we build pretrained estimators including <code>XGBoost</code> then aggregate it to some <code>sklearn</code> basic estimators.</p>
<p>We first split the training data into two parts: <span class="math inline">\(X_k\)</span> for building basic estimators, and <span class="math inline">\(X_\ell\)</span> for aggregation. We use the constructed estimators to predict the test data and only those predictions are used in the final predictions.</p>
<div id="374e8b66" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># X_k and X_l split</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>id_k <span class="op">=</span> np.random.permutation(<span class="bu">range</span>(<span class="bu">len</span>(y_train_real)))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span><span class="bu">int</span>(<span class="fl">.5</span> <span class="op">*</span> <span class="bu">len</span>(y_train_real))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>X_k, X_l, y_k, y_l <span class="op">=</span> X_train_real[id_k[:k],:], X_train_real[id_k[k:],:], y_train_real[id_k[:k]], y_train_real[id_k[k:]]</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Building basic estiators</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>rf_real <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">300</span>).fit(X_k, y_k)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>lm_real <span class="op">=</span> LinearRegression().fit(X_k, y_k)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>knn_real <span class="op">=</span> KNeighborsRegressor(n_neighbors<span class="op">=</span><span class="dv">10</span>).fit(X_k, y_k)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>tr_real <span class="op">=</span> DecisionTreeRegressor(min_samples_leaf<span class="op">=</span><span class="dv">5</span>).fit(X_k, y_k)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># External XGBoost estiator</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>xgb <span class="op">=</span> xgboost.XGBRegressor(n_estimators <span class="op">=</span> <span class="dv">500</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>xgb_real <span class="op">=</span> xgb.fit(X_k, y_k)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># All pretrained estimators</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>basic_estimators <span class="op">=</span> (rf_real, lm_real, knn_real, tr_real, xgb_real)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted features on X_l for aggregation</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>pred_feature_l <span class="op">=</span> np.column_stack([est.predict(X_l) <span class="cf">for</span> est <span class="kw">in</span> basic_estimators])</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted features on Testing data</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>pred_feature_test <span class="op">=</span> np.column_stack([est.predict(X_test_real) <span class="cf">for</span> est <span class="kw">in</span> basic_estimators])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To fit the aggregation method on predicted features (NOT the input data), we have to set argument <code>as_predictions = True</code>. This tells the <code>fit</code> method not to build any basic estimators on the given input (which is already the predictions), and the optimization method is performed directly on <span class="math inline">\(X\)</span>.</p>
<div id="bbb830ba" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>gc3_fit <span class="op">=</span> GradientCOBRA(learning_rate<span class="op">=</span><span class="fl">0.01</span>, opt_method<span class="op">=</span><span class="st">"grad"</span>).fit(X<span class="op">=</span>pred_feature_l,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                              y<span class="op">=</span>y_l,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                              as_predictions<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: 0.019 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 2.990 / grad: -0.036 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 2.990 / grad: -0.036 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.009 / grad: 0.020 / stop criter: 0.036 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 6 / bw: 3.009 / grad: 0.020 / stop criter: 0.036 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.999 / grad: 0.027 / stop criter: 0.020 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.999 / grad: 0.027 / stop criter: 0.020 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.985 / grad: 0.021 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.985 / grad: 0.021 / stop criter: 0.027 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 2.974 / grad: -0.012 / stop criter: 0.021 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 2.974 / grad: -0.012 / stop criter: 0.021 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 2.980 / grad: -0.006 / stop criter: 0.012 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 2.980 / grad: -0.006 / stop criter: 0.012 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 11 / bw: 2.983 / grad: -0.008 / stop criter: 0.006 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 11 / bw: 2.983 / grad: -0.008 / stop criter: 0.006 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 11 / bw: 2.983 / grad: -0.008 / stop criter: 0.006 :   4%|▎         | 11/300 [00:00&lt;00:02, 112.23it/s]</code></pre>
</div>
</div>
<p>We look at the optimization algorithm performance.</p>
<div id="1b3fb6c4" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(gc3_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>gc3_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :2.987081777074603</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="a62fe1b0-ce64-4be7-926b-ebc01aa42336" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a62fe1b0-ce64-4be7-926b-ebc01aa42336")) {                    Plotly.newPlot(                        "a62fe1b0-ce64-4be7-926b-ebc01aa42336",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10],"y":[2.99,2.99,2.99,2.99,2.99,3.0091596543870636,2.9985986527531314,2.98461091897605,2.973734150604758,2.980125250591938,2.983187853109478],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,10],"y":[2.983187853109478,2.983187853109478],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.5974163554149207,1.3520475412021888,2.106678726989457,2.861309912776725,3.6159410985639933,4.370572284351262,5.12520347013853,5.879834655925798,6.634465841713066,7.389097027500334,8.143728213287602,8.898359399074872,9.65299058486214,10.407621770649408,11.162252956436676,11.916884142223944,12.671515328011212,13.42614651379848,14.180777699585748,14.935408885373016],"y":[0.21169865761264167,0.17179825424136425,0.16253754262218784,0.15831899903218347,0.1561929082468108,0.15520615084540146,0.1548803981896078,0.1550115009875832,0.15551134631092592,0.15631430952924888,0.15735294244459394,0.1585608316025315,0.1598791956284025,0.16126064804960596,0.16266959958990784,0.16408096356267027,0.1654780777079912,0.16685056720113794,0.16819277545479167,0.16950215752846787],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[2.987081777074603],"y":[0.15785352083568444],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,2.987081777074603,2.987081777074603],"y":[0.15785352083568444,0.15785352083568444,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a62fe1b0-ce64-4be7-926b-ebc01aa42336');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Now, let’s look at the result.</p>
<div id="39a4e152" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pred_add <span class="op">=</span> gc3_fit.predict(pred_feature_test)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test_real, pred_add))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test_real, pred_add))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1776194282613607
0.25400997843985323</code></pre>
</div>
</div>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><p><a href="https://jdssv.org/index.php/jdssv/article/view/70">S. Has (2023). A Gradient COBRA: A kernel-based consensual aggregation for regression. Journal of Data Science, Statistics, and Visualisation, 3(2).</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.jmva.2015.04.007">G. Biau, A. Fischer, B. Guedj and J. D. Malley (2016), COBRA: A combined regression strategy, Journal of Multivariate Analysis.</a></p></li>
<li><p><a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California Housing Prices</a></p></li>
</ul>
<section id="read-also" class="level3">
<h3 class="anchored" data-anchor-id="read-also">Read also:</h3>
<ul>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/superlearner.html">SuperLearner</a></p></li>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/MixCOBRARegressor.html">MixCOBRARegressor</a></p></li>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/kernelsmoother.html">KernelSmoother</a></p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>