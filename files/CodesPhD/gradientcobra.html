<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.358">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sothea HAS">

<title> GradientCobra Python Library</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="gradientcobra_files/libs/clipboard/clipboard.min.js"></script>
<script src="gradientcobra_files/libs/quarto-html/quarto.js"></script>
<script src="gradientcobra_files/libs/quarto-html/popper.min.js"></script>
<script src="gradientcobra_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="gradientcobra_files/libs/quarto-html/anchor.min.js"></script>
<link href="gradientcobra_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="gradientcobra_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="gradientcobra_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="gradientcobra_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="gradientcobra_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.27.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><img src="gradientcobra_logo.svg" class="img-fluid" style="width:1.38889in"> GradientCobra Python Library</h1>
            <p class="subtitle lead"><strong>Class <a href="https://jdssv.org/index.php/jdssv/article/view/70">GradientCOBRA</a></strong></p>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p><a href="https://hassothea.github.io/">Sothea HAS</a> </p>
                      </div>
          </div>
                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-gradientcobra-method" id="toc-introduction-to-gradientcobra-method" class="nav-link active" data-scroll-target="#introduction-to-gradientcobra-method">Introduction to GradientCOBRA method</a></li>
  <li><a href="#gradientcobra-method" id="toc-gradientcobra-method" class="nav-link" data-scroll-target="#gradientcobra-method">GradientCOBRA method</a>
  <ul class="collapse">
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#returns" id="toc-returns" class="nav-link" data-scroll-target="#returns">Returns:</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods:</a></li>
  </ul></li>
  <li><a href="#installation-of-the-library-from-pypi" id="toc-installation-of-the-library-from-pypi" class="nav-link" data-scroll-target="#installation-of-the-library-from-pypi">Installation of the library from <code>pypi</code></a></li>
  <li><a href="#implementation-of-the-method" id="toc-implementation-of-the-method" class="nav-link" data-scroll-target="#implementation-of-the-method">Implementation of the method</a>
  <ul class="collapse">
  <li><a href="#importing-some-packages" id="toc-importing-some-packages" class="nav-link" data-scroll-target="#importing-some-packages">Importing some packages</a></li>
  <li><a href="#gradientcobra-on-simulated-data" id="toc-gradientcobra-on-simulated-data" class="nav-link" data-scroll-target="#gradientcobra-on-simulated-data"><code>GradientCOBRA</code> on simulated data</a></li>
  <li><a href="#gradientcobra-on-real-dataset" id="toc-gradientcobra-on-real-dataset" class="nav-link" data-scroll-target="#gradientcobra-on-real-dataset"><code>GradientCOBRA</code> on real dataset</a></li>
  <li><a href="#a-comparison-with-adaboost" id="toc-a-comparison-with-adaboost" class="nav-link" data-scroll-target="#a-comparison-with-adaboost">A comparison with <code>Adaboost</code></a></li>
  <li><a href="#pretrained-basic-estimators" id="toc-pretrained-basic-estimators" class="nav-link" data-scroll-target="#pretrained-basic-estimators">Pretrained basic estimators</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a>
  <ul class="collapse">
  <li><a href="#read-also" id="toc-read-also" class="nav-link" data-scroll-target="#read-also">Read also:</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  

<section id="introduction-to-gradientcobra-method" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-gradientcobra-method">Introduction to <a href="https://jdssv.org/index.php/jdssv/article/view/70">GradientCOBRA</a> method</h2>
<p><code>GradientCOBRA</code> is a consensual aggregation method that combines a given number of regressors based on their predicted features (<a href="https://jdssv.org/index.php/jdssv/article/view/70">Has, 2023</a>). The method is summarized in the following figure.</p>
<p><img src="gradientcobra_summary.jpg" class="img-fluid" style="width:6.25in"></p>
<p>where</p>
<ul>
<li><span class="math inline">\({\bf r}(x)=(r_1(x),\dots, r_M(x))\)</span> is the predicted features of observation <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(K:\mathbb{R}_+\to\mathbb{R}_+\)</span> is a regular kernel function that converts the “closeness” between predicted features of observation <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x\)</span> into the associated weight for the aggregation. For any smoothing parameter <span class="math inline">\(h&gt;0\)</span>, <span class="math inline">\(K_h(t)=K(t/h)\)</span>.</li>
</ul>
<p>Constructing a consensual aggregation method is equivalent to estimating an appropriate smoothing parameter <span class="math inline">\(h\)</span> that minimizes the so-called <span class="math inline">\(\kappa\)</span>-fold cross validation error:</p>
<p><span class="math display">\[\phi(h)=\frac{1}{\kappa}\sum_{j=1}^{\kappa}\sum_{(x_i,y_i)\in F_j}\ell(\hat{y}_{-F_j}(x_i),y_i)\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\ell\)</span> is any regression loss function. By default, <span class="math inline">\(\ell(y_1,y_2)=(y_1-y_2)^2\)</span>.</li>
<li><span class="math inline">\((F_j)_{j=1,2,\dots,\kappa}\)</span> are the <span class="math inline">\(\kappa\)</span> folds of the second of the training data used for aggregation.</li>
<li><span class="math inline">\(\hat{y}_{-F_j}(x)\)</span> is the prediction of <span class="math inline">\(x\)</span> by aggregating predicted features on all folds <span class="math inline">\((F_k)_{k}\)</span> except for <span class="math inline">\(F_j\)</span>.</li>
</ul>
<hr>
</section>
<section id="gradientcobra-method" class="level2">
<h2 class="anchored" data-anchor-id="gradientcobra-method">GradientCOBRA method</h2>
<p><code>class</code> <strong>GradientCOBRA</strong>(<em>random_state = None, learning_rate = 0.01, bandwidth_list = None, speed = ‘constant’, estimator_list = None, estimator_params = None, opt_method = “grad”, max_iter = int(300), opt_params = None, kernel = ‘radial’, kernel_exponent = 1.0, show_progress = True, loss_function = None, loss_weight = None, norm_constant = None</em>):</p>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">Parameters</h3>
<hr>
<ul>
<li><p><code>random_state</code>: (default is <code>None</code>) for setting the random state of all the random generators in the class. This allows the method to produce the same result when the same <code>random_state</code> is used.</p></li>
<li><p><code>learning_rate</code>: (default is <code>0.1</code>) the learning rate in gradient descent algorithm for estimating the optimal bandwidth.</p></li>
<li><p><code>bandwidth_list</code>: a list of bandwidth parameters for grid search algorithm (<code>default = np.linspace(0.00001, 10, 300)</code>).</p></li>
<li><p><code>speed</code>: (default is <code>constant</code>) for adjusting the speed of the learning rate. It is helpful when the cost function is flat around the optimal value, changing the learning speed might help the algorithm to converge faster. It should be an element of <em>[‘constant’, ‘linear’, ‘log’, ‘sqrt_root’, ‘quad’, ‘exp’]</em>.</p></li>
<li><p><code>estimator_list</code>: (default is None) the list of intial estimators (machines as addressed in <a href="https://www.sciencedirect.com/science/article/pii/S0047259X15000950">Biau et al.&nbsp;(2016)</a>). If it is <code>None</code>, the intial learners including <em>‘linear_regression’, ‘ridge’, ‘lasso’, ‘tree’</em>, and <em>‘random_forest’</em> are used with their default parameters. This argument should be a sublist of the following list: <em>[‘linear_regression’, ‘knn’, ‘ridge’, ‘lasso’, ‘tree’, ‘random_forest’, ‘svm’, ‘sgd’, ‘bayesian_ridge’, ‘adaboost’, ‘gradient_boost’]</em>.</p></li>
<li><p><code>estimator_params</code>: (default is <code>None</code>) is a dictionary containing the parameters of the basic estimators given in the <code>estimator_list</code> argument. It must be a dictionary with:</p>
<ul>
<li><code>key</code> : the name of the basic estimator defined in <code>estimator_list</code>,</li>
<li><code>value</code> : a dictionary with <em>(key, value) = (parameter, value)</em>.</li>
</ul></li>
<li><p><code>opt_method</code>: (default is “<code>grad</code>”) is an optimization algorithm for estimating the bandwidth parameter. It should be either “<code>grid</code>” (grid search) or “<code>grad</code>” (gradient descent for non-compactly supported kernels).</p></li>
<li><p><code>max_iter</code>: (default = <code>100</code>) maximum iteration of gradient descent algorithm.</p></li>
<li><p><code>opt_params</code>: (default is <code>None</code>) is a dictionary of additional parameters for the optimization algorithm (both grid search and gradient descent). Its should contain some of the following keys:</p>
<ul>
<li>‘<em>epsilon</em>’: stopping criterion for gradient descent algorithm (<code>default =</code> <span class="math inline">\(10^{-6}\)</span>).</li>
<li>‘<em>n_tries</em>’: the number of tries for selecting initial position of gradient descent algorithm (<code>default = 10</code>)</li>
<li>‘<em>start</em>’: the initial value of the bandwidth parameter (<code>default = None</code>)</li>
<li>‘<em>n_cv</em>’: number of cross-validation folds (<code>default = 10</code>)</li>
<li>‘precision’ : the precision to estimate the gradient for gradient descent algorithm (<code>default =</code> <span class="math inline">\(10^{-10}\)</span>).</li>
</ul></li>
<li><p><code>kernel</code>: (default is <code>'radial'</code>) the kernel function used for the aggregation. It should be an element of the list <em>[‘exponential’, ‘gaussian’, ‘radial’, ‘cauchy’, ‘reverse_cosh’,‘epanechnikov’,‘biweight’, ‘triweight’, ‘triangular’, ‘cobra’, ‘naive’]</em>. Some options such as <code>'gaussian'</code> and <code>'radial'</code> lead to the same radial kernel function. For <code>'cobra'</code> or <code>'naive'</code>, they correspond to COBRA method by <a href="https://www.sciencedirect.com/science/article/pii/S0047259X15000950">Biau et al.&nbsp;(2016)</a>.</p></li>
<li><p><code>kernel_exponent</code>: (default is <code>1.0</code>) is an exponential <span class="math inline">\(\alpha\)</span> of the exponential and radial kernel function i.e., <span class="math inline">\(K(x) = \exp(|x|^{2\alpha})\)</span>. By default, <code>alpha = 1.0</code>.</p></li>
<li><p><code>show_progress</code>: (default is <code>True</code>) a boolean defining whether or not to show the progress of the optimization algorithm for both grid search and gradient descent.</p></li>
<li><p><code>loss_function</code>: (default is <code>None</code>) a function or string defining the cost function to be optimized for estimating the optimal bandwidth parameter. By defalut, the K-Fold cross-validation MSE is used. Otherwise, it must be either:</p>
<ul>
<li>a function of two argumetns (y_true, y_pred) or</li>
<li>a string element of the list <em>[‘mse’, ‘mae’, ‘mape’, ‘weighted_mse’]</em>. If it is <code>weighted_mse</code>, one can define the weight for each training point using <code>loss_weight</code> argument below.
<ul>
<li><code>loss_weight</code>: (default is <code>None</code>) a list of size <span class="math inline">\(n\)</span> (number of training observations) defining the weight for each individual data point for the loss function. If it is <code>None</code> and the <code>loss_function = weighted_mse</code>, then a normalized weight <span class="math inline">\(W(i) = 1/\text{PDF}(i)\)</span> is assigned to the individual <span class="math inline">\(i\)</span> of the training data.</li>
</ul></li>
</ul></li>
<li><p><code>norm_constant</code>: (default is <code>None</code>) a normalized constant used to scale the features in optimization algorithm. By defalut, they are</p></li>
</ul>
</section>
<section id="returns" class="level3">
<h3 class="anchored" data-anchor-id="returns">Returns:</h3>
<hr>
<ul>
<li><code>self</code> : returns an instance of self containing the optimal estimated bandwidth and other results of the algorithm.</li>
</ul>
</section>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">Methods:</h3>
<hr>
<ul>
<li><code>fit</code> : fitting the aggregation method on the design features (original data or predicted features).</li>
<li><code>split_data</code> : to split the data into <span class="math inline">\(D_k = \{(X_k,y_k)\}\)</span> and <span class="math inline">\(D_{\ell} = \{(X_\ell,y_\ell)\}\)</span> to train the basic estimators and perform aggregation respectively.</li>
<li><code>build_basic_estimators</code> : build basic estimators for the aggregation. It is also possible to set the values of (hyper)parameters for each estimators.</li>
<li><code>load_predictions</code> : to make predictions using the constructed basic estimators.</li>
<li><code>distances</code> : to construct distance matrix according to the kernel function used for the aggregation.</li>
<li><code>kappa_cross_validation_error</code> : the objective function to be minimized.</li>
<li><code>optimize_bandwidth</code> : the optimization method used to estimate the optimal bendwidth parameter.</li>
<li><code>predict</code> : for building prediction on the new observations using any given bendwidth or the estimated one.</li>
<li><code>draw_learning_curve</code> : for plotting the graphic of learning algorithm (error vs parameter).</li>
</ul>
<hr>
</section>
</section>
<section id="installation-of-the-library-from-pypi" class="level2">
<h2 class="anchored" data-anchor-id="installation-of-the-library-from-pypi">Installation of the library from <code>pypi</code></h2>
<p><a href="https://pypi.org/project/gradientcobra/">gradientcobra</a> can be installed from <a href="https://pypi.org/">pypi</a> using <code>pip</code>:</p>
<blockquote class="blockquote">
<p><code>pip install gradientcobra</code></p>
</blockquote>
<hr>
</section>
<section id="implementation-of-the-method" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-the-method">Implementation of the method</h2>
<section id="importing-some-packages" class="level3">
<h3 class="anchored" data-anchor-id="importing-some-packages">Importing some packages</h3>
<div id="eb3329c3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Metric of error</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, mean_absolute_percentage_error</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting figures</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Import class GradientCOBRA from the gradientcobra library</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gradientcobra.gradientcobra <span class="im">import</span> GradientCOBRA</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gradientcobra-on-simulated-data" class="level3">
<h3 class="anchored" data-anchor-id="gradientcobra-on-simulated-data"><code>GradientCOBRA</code> on simulated data</h3>
<p>We simulate a regression data with <span class="math inline">\(1000\)</span> observations and <span class="math inline">\(10\)</span> inputs variables.</p>
<div id="a2fa4230" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For simulating dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_regression</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>X1, y1 <span class="op">=</span> make_regression(n_samples<span class="op">=</span><span class="dv">1000</span>, n_features<span class="op">=</span><span class="dv">10</span>, noise<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s randomly split the simulated data into <span class="math inline">\(80\%-20\%\)</span> training-testing data.</p>
<div id="1ec96a8f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>X_train1, X_test1, y_train1, y_test1 <span class="op">=</span> train_test_split(X1, y1, test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'shape: x_train = </span><span class="sc">{}</span><span class="st"> , x_train = </span><span class="sc">{}</span><span class="st"> , y_train = </span><span class="sc">{}</span><span class="st"> , y_test = </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    X_train1.shape, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    X_test1.shape, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    y_train1.shape, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    y_test1.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: x_train = (800, 10) , x_train = (200, 10) , y_train = (800,) , y_test = (200,)</code></pre>
</div>
</div>
<section id="bullet-gradientcobra-with-default-parameters" class="level4">
<h4 class="anchored" data-anchor-id="bullet-gradientcobra-with-default-parameters"><span class="math inline">\(\bullet\)</span> <code>GradientCOBRA</code> with default parameters</h4>
<p>We create <code>GradientCOBRA</code> object called <code>gc1</code> using <code>GradientCOBRA</code> class with the default parameters, then fit it to the training data.</p>
<div id="32ff518a" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gc1 <span class="op">=</span> GradientCOBRA()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>gc1_fit <span class="op">=</span> gc1.fit(X_train1, y_train1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: -26.306 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.100 / grad: -26.306 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.100 / grad: 128.356 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.100 / grad: 128.356 / stop criter: 26.306 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 2.612 / grad: 28.396 / stop criter: 128.356 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 2.612 / grad: 28.396 / stop criter: 128.356 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.505 / grad: 10.042 / stop criter: 28.396 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 7 / bw: 2.505 / grad: 10.042 / stop criter: 28.396 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.467 / grad: 55.416 / stop criter: 10.042 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.467 / grad: 55.416 / stop criter: 10.042 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.467 / grad: 55.416 / stop criter: 10.042 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 9 / bw: 2.259 / grad: 49.916 / stop criter: 55.416 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 9 / bw: 2.259 / grad: 49.916 / stop criter: 55.416 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 10 / bw: 2.071 / grad: -90.447 / stop criter: 49.916 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 10 / bw: 2.071 / grad: -90.447 / stop criter: 49.916 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 11 / bw: 2.411 / grad: -129.252 / stop criter: 90.447 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 11 / bw: 2.411 / grad: -129.252 / stop criter: 90.447 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 12 / bw: 2.893 / grad: -53.371 / stop criter: 129.252 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 12 / bw: 2.893 / grad: -53.371 / stop criter: 129.252 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 13 / bw: 3.092 / grad: 19.150 / stop criter: 53.371 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]  * GD progress: iter: 13 / bw: 3.092 / grad: 19.150 / stop criter: 53.371 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 14 / bw: 3.020 / grad: -280.491 / stop criter: 19.150 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 14 / bw: 3.020 / grad: -280.491 / stop criter: 19.150 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 15 / bw: 4.055 / grad: 159.707 / stop criter: 280.491 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 15 / bw: 4.055 / grad: 159.707 / stop criter: 280.491 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 16 / bw: 3.472 / grad: -100.680 / stop criter: 159.707 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 16 / bw: 3.472 / grad: -100.680 / stop criter: 159.707 :   3%|▎         | 8/300 [00:00&lt;00:04, 72.07it/s]* GD progress: iter: 16 / bw: 3.472 / grad: -100.680 / stop criter: 159.707 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 17 / bw: 3.836 / grad: 4.594 / stop criter: 100.680 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]   * GD progress: iter: 17 / bw: 3.836 / grad: 4.594 / stop criter: 100.680 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 18 / bw: 3.819 / grad: -69.075 / stop criter: 4.594 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 18 / bw: 3.819 / grad: -69.075 / stop criter: 4.594 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 19 / bw: 4.064 / grad: -8.764 / stop criter: 69.075 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 19 / bw: 4.064 / grad: -8.764 / stop criter: 69.075 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 20 / bw: 4.095 / grad: -92.812 / stop criter: 8.764 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 20 / bw: 4.095 / grad: -92.812 / stop criter: 8.764 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 21 / bw: 4.420 / grad: 157.962 / stop criter: 92.812 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 21 / bw: 4.420 / grad: 157.962 / stop criter: 92.812 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 22 / bw: 3.866 / grad: -46.266 / stop criter: 157.962 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 22 / bw: 3.866 / grad: -46.266 / stop criter: 157.962 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 23 / bw: 4.027 / grad: 15.219 / stop criter: 46.266 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]  * GD progress: iter: 23 / bw: 4.027 / grad: 15.219 / stop criter: 46.266 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 24 / bw: 3.975 / grad: -36.188 / stop criter: 15.219 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 24 / bw: 3.975 / grad: -36.188 / stop criter: 15.219 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 25 / bw: 4.098 / grad: -92.650 / stop criter: 36.188 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 25 / bw: 4.098 / grad: -92.650 / stop criter: 36.188 :   5%|▌         | 16/300 [00:00&lt;00:03, 75.42it/s]* GD progress: iter: 25 / bw: 4.098 / grad: -92.650 / stop criter: 36.188 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 26 / bw: 4.410 / grad: 79.300 / stop criter: 92.650 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s] * GD progress: iter: 26 / bw: 4.410 / grad: 79.300 / stop criter: 92.650 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 27 / bw: 4.143 / grad: 190.957 / stop criter: 79.300 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 27 / bw: 4.143 / grad: 190.957 / stop criter: 79.300 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 28 / bw: 3.506 / grad: -34.380 / stop criter: 190.957 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 28 / bw: 3.506 / grad: -34.380 / stop criter: 190.957 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 29 / bw: 3.621 / grad: 126.892 / stop criter: 34.380 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s] * GD progress: iter: 29 / bw: 3.621 / grad: 126.892 / stop criter: 34.380 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 30 / bw: 3.201 / grad: 70.139 / stop criter: 126.892 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 30 / bw: 3.201 / grad: 70.139 / stop criter: 126.892 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 31 / bw: 2.972 / grad: 28.802 / stop criter: 70.139 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s] * GD progress: iter: 31 / bw: 2.972 / grad: 28.802 / stop criter: 70.139 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 32 / bw: 2.878 / grad: 81.526 / stop criter: 28.802 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 32 / bw: 2.878 / grad: 81.526 / stop criter: 28.802 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 33 / bw: 2.611 / grad: -51.967 / stop criter: 81.526 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 33 / bw: 2.611 / grad: -51.967 / stop criter: 81.526 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 34 / bw: 2.781 / grad: -140.370 / stop criter: 51.967 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 34 / bw: 2.781 / grad: -140.370 / stop criter: 51.967 :   8%|▊         | 25/300 [00:00&lt;00:03, 80.46it/s]* GD progress: iter: 34 / bw: 2.781 / grad: -140.370 / stop criter: 51.967 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 35 / bw: 3.236 / grad: 100.179 / stop criter: 140.370 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 35 / bw: 3.236 / grad: 100.179 / stop criter: 140.370 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 36 / bw: 2.911 / grad: -57.622 / stop criter: 100.179 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 36 / bw: 2.911 / grad: -57.622 / stop criter: 100.179 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 37 / bw: 3.096 / grad: -125.374 / stop criter: 57.622 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 37 / bw: 3.096 / grad: -125.374 / stop criter: 57.622 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 38 / bw: 3.494 / grad: 52.032 / stop criter: 125.374 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s] * GD progress: iter: 38 / bw: 3.494 / grad: 52.032 / stop criter: 125.374 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 39 / bw: 3.329 / grad: -90.651 / stop criter: 52.032 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 39 / bw: 3.329 / grad: -90.651 / stop criter: 52.032 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 40 / bw: 3.613 / grad: -220.469 / stop criter: 90.651 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 40 / bw: 3.613 / grad: -220.469 / stop criter: 90.651 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 41 / bw: 4.299 / grad: -10.159 / stop criter: 220.469 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 41 / bw: 4.299 / grad: -10.159 / stop criter: 220.469 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 42 / bw: 4.331 / grad: 17.801 / stop criter: 10.159 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]  * GD progress: iter: 42 / bw: 4.331 / grad: 17.801 / stop criter: 10.159 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 43 / bw: 4.275 / grad: -90.448 / stop criter: 17.801 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 43 / bw: 4.275 / grad: -90.448 / stop criter: 17.801 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 44 / bw: 4.554 / grad: -168.250 / stop criter: 90.448 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 44 / bw: 4.554 / grad: -168.250 / stop criter: 90.448 :  11%|█▏        | 34/300 [00:00&lt;00:03, 79.33it/s]* GD progress: iter: 44 / bw: 4.554 / grad: -168.250 / stop criter: 90.448 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 45 / bw: 5.066 / grad: 78.884 / stop criter: 168.250 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s] * GD progress: iter: 45 / bw: 5.066 / grad: 78.884 / stop criter: 168.250 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 46 / bw: 4.826 / grad: -165.897 / stop criter: 78.884 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 46 / bw: 4.826 / grad: -165.897 / stop criter: 78.884 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 47 / bw: 5.326 / grad: 158.954 / stop criter: 165.897 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 47 / bw: 5.326 / grad: 158.954 / stop criter: 165.897 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 48 / bw: 4.852 / grad: -143.880 / stop criter: 158.954 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 48 / bw: 4.852 / grad: -143.880 / stop criter: 158.954 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 49 / bw: 5.277 / grad: -40.236 / stop criter: 143.880 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s] * GD progress: iter: 49 / bw: 5.277 / grad: -40.236 / stop criter: 143.880 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 50 / bw: 5.395 / grad: -115.308 / stop criter: 40.236 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 50 / bw: 5.395 / grad: -115.308 / stop criter: 40.236 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 51 / bw: 5.732 / grad: 140.253 / stop criter: 115.308 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 51 / bw: 5.732 / grad: 140.253 / stop criter: 115.308 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 52 / bw: 5.322 / grad: -178.598 / stop criter: 140.253 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 52 / bw: 5.322 / grad: -178.598 / stop criter: 140.253 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 53 / bw: 5.839 / grad: -84.206 / stop criter: 178.598 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s] * GD progress: iter: 53 / bw: 5.839 / grad: -84.206 / stop criter: 178.598 :  15%|█▍        | 44/300 [00:00&lt;00:02, 86.33it/s]* GD progress: iter: 53 / bw: 5.839 / grad: -84.206 / stop criter: 178.598 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 54 / bw: 6.081 / grad: -33.571 / stop criter: 84.206 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s] * GD progress: iter: 54 / bw: 6.081 / grad: -33.571 / stop criter: 84.206 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 55 / bw: 6.177 / grad: 33.531 / stop criter: 33.571 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s] * GD progress: iter: 55 / bw: 6.177 / grad: 33.531 / stop criter: 33.571 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 56 / bw: 6.081 / grad: 69.052 / stop criter: 33.531 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 56 / bw: 6.081 / grad: 69.052 / stop criter: 33.531 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 57 / bw: 5.885 / grad: -22.549 / stop criter: 69.052 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 57 / bw: 5.885 / grad: -22.549 / stop criter: 69.052 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 58 / bw: 5.949 / grad: 9.732 / stop criter: 22.549 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]  * GD progress: iter: 58 / bw: 5.949 / grad: 9.732 / stop criter: 22.549 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 59 / bw: 5.922 / grad: 123.023 / stop criter: 9.732 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 59 / bw: 5.922 / grad: 123.023 / stop criter: 9.732 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 60 / bw: 5.579 / grad: 77.229 / stop criter: 123.023 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 60 / bw: 5.579 / grad: 77.229 / stop criter: 123.023 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 61 / bw: 5.364 / grad: -32.236 / stop criter: 77.229 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 61 / bw: 5.364 / grad: -32.236 / stop criter: 77.229 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 62 / bw: 5.454 / grad: -98.447 / stop criter: 32.236 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 62 / bw: 5.454 / grad: -98.447 / stop criter: 32.236 :  18%|█▊        | 53/300 [00:00&lt;00:02, 84.74it/s]* GD progress: iter: 62 / bw: 5.454 / grad: -98.447 / stop criter: 32.236 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 63 / bw: 5.725 / grad: 101.111 / stop criter: 98.447 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 63 / bw: 5.725 / grad: 101.111 / stop criter: 98.447 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 64 / bw: 5.447 / grad: 44.196 / stop criter: 101.111 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 64 / bw: 5.447 / grad: 44.196 / stop criter: 101.111 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 65 / bw: 5.326 / grad: -53.779 / stop criter: 44.196 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 65 / bw: 5.326 / grad: -53.779 / stop criter: 44.196 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 66 / bw: 5.473 / grad: -45.760 / stop criter: 53.779 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 66 / bw: 5.473 / grad: -45.760 / stop criter: 53.779 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 67 / bw: 5.596 / grad: -14.643 / stop criter: 45.760 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 67 / bw: 5.596 / grad: -14.643 / stop criter: 45.760 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 68 / bw: 5.636 / grad: 5.100 / stop criter: 14.643 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]  * GD progress: iter: 68 / bw: 5.636 / grad: 5.100 / stop criter: 14.643 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 69 / bw: 5.622 / grad: -36.486 / stop criter: 5.100 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 69 / bw: 5.622 / grad: -36.486 / stop criter: 5.100 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 70 / bw: 5.720 / grad: 109.553 / stop criter: 36.486 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 70 / bw: 5.720 / grad: 109.553 / stop criter: 36.486 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 71 / bw: 5.430 / grad: -1.138 / stop criter: 109.553 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 71 / bw: 5.430 / grad: -1.138 / stop criter: 109.553 :  21%|██        | 62/300 [00:00&lt;00:02, 84.19it/s]* GD progress: iter: 71 / bw: 5.430 / grad: -1.138 / stop criter: 109.553 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]* GD progress: iter: 72 / bw: 5.433 / grad: 34.203 / stop criter: 1.138 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]  * GD progress: iter: 72 / bw: 5.433 / grad: 34.203 / stop criter: 1.138 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]* GD progress: iter: 73 / bw: 5.344 / grad: -209.600 / stop criter: 34.203 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]* GD progress: iter: 73 / bw: 5.344 / grad: -209.600 / stop criter: 34.203 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]* GD progress: iter: 74 / bw: 5.882 / grad: 65.372 / stop criter: 209.600 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s] * GD progress: iter: 74 / bw: 5.882 / grad: 65.372 / stop criter: 209.600 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]* GD progress: iter: 75 / bw: 5.716 / grad: -137.753 / stop criter: 65.372 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]* GD progress: iter: 75 / bw: 5.716 / grad: -137.753 / stop criter: 65.372 :  24%|██▎       | 71/300 [00:00&lt;00:03, 74.70it/s]* GD progress: iter: 76 / bw: 6.063 / grad: 178.385 / stop criter: 137.753 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s]* GD progress: iter: 76 / bw: 6.063 / grad: 178.385 / stop criter: 137.753 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s]* GD progress: iter: 77 / bw: 5.618 / grad: -88.311 / stop criter: 178.385 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s]* GD progress: iter: 77 / bw: 5.618 / grad: -88.311 / stop criter: 178.385 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s]* GD progress: iter: 78 / bw: 5.836 / grad: -154.952 / stop criter: 88.311 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s]* GD progress: iter: 78 / bw: 5.836 / grad: -154.952 / stop criter: 88.311 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s]* GD progress: iter: 79 / bw: 6.215 / grad: -7.427 / stop criter: 154.952 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s] * GD progress: iter: 79 / bw: 6.215 / grad: -7.427 / stop criter: 154.952 :  24%|██▎       | 71/300 [00:01&lt;00:03, 74.70it/s]* GD progress: iter: 79 / bw: 6.215 / grad: -7.427 / stop criter: 154.952 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 80 / bw: 6.233 / grad: 75.369 / stop criter: 7.427 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]  * GD progress: iter: 80 / bw: 6.233 / grad: 75.369 / stop criter: 7.427 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 81 / bw: 6.049 / grad: -45.054 / stop criter: 75.369 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 81 / bw: 6.049 / grad: -45.054 / stop criter: 75.369 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 82 / bw: 6.158 / grad: 33.833 / stop criter: 45.054 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s] * GD progress: iter: 82 / bw: 6.158 / grad: 33.833 / stop criter: 45.054 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 83 / bw: 6.077 / grad: -21.859 / stop criter: 33.833 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 83 / bw: 6.077 / grad: -21.859 / stop criter: 33.833 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 84 / bw: 6.129 / grad: 89.837 / stop criter: 21.859 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s] * GD progress: iter: 84 / bw: 6.129 / grad: 89.837 / stop criter: 21.859 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 85 / bw: 5.918 / grad: -99.796 / stop criter: 89.837 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 85 / bw: 5.918 / grad: -99.796 / stop criter: 89.837 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 86 / bw: 6.150 / grad: 187.782 / stop criter: 99.796 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 86 / bw: 6.150 / grad: 187.782 / stop criter: 99.796 :  26%|██▋       | 79/300 [00:01&lt;00:03, 62.27it/s]* GD progress: iter: 86 / bw: 6.150 / grad: 187.782 / stop criter: 99.796 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 87 / bw: 5.718 / grad: 59.068 / stop criter: 187.782 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 87 / bw: 5.718 / grad: 59.068 / stop criter: 187.782 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 88 / bw: 5.583 / grad: 16.371 / stop criter: 59.068 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s] * GD progress: iter: 88 / bw: 5.583 / grad: 16.371 / stop criter: 59.068 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 89 / bw: 5.546 / grad: -252.343 / stop criter: 16.371 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 89 / bw: 5.546 / grad: -252.343 / stop criter: 16.371 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 90 / bw: 6.120 / grad: 145.822 / stop criter: 252.343 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 90 / bw: 6.120 / grad: 145.822 / stop criter: 252.343 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 91 / bw: 5.792 / grad: 30.679 / stop criter: 145.822 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s] * GD progress: iter: 91 / bw: 5.792 / grad: 30.679 / stop criter: 145.822 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 92 / bw: 5.723 / grad: 268.080 / stop criter: 30.679 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 92 / bw: 5.723 / grad: 268.080 / stop criter: 30.679 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 93 / bw: 5.125 / grad: 157.522 / stop criter: 268.080 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 93 / bw: 5.125 / grad: 157.522 / stop criter: 268.080 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 94 / bw: 4.774 / grad: -220.549 / stop criter: 157.522 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 94 / bw: 4.774 / grad: -220.549 / stop criter: 157.522 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 95 / bw: 5.266 / grad: -102.911 / stop criter: 220.549 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 95 / bw: 5.266 / grad: -102.911 / stop criter: 220.549 :  29%|██▊       | 86/300 [00:01&lt;00:03, 61.62it/s]* GD progress: iter: 95 / bw: 5.266 / grad: -102.911 / stop criter: 220.549 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 96 / bw: 5.493 / grad: 33.570 / stop criter: 102.911 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]  * GD progress: iter: 96 / bw: 5.493 / grad: 33.570 / stop criter: 102.911 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 97 / bw: 5.419 / grad: 87.952 / stop criter: 33.570 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s] * GD progress: iter: 97 / bw: 5.419 / grad: 87.952 / stop criter: 33.570 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 98 / bw: 5.227 / grad: 266.181 / stop criter: 87.952 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 98 / bw: 5.227 / grad: 266.181 / stop criter: 87.952 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 99 / bw: 4.644 / grad: -99.543 / stop criter: 266.181 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 99 / bw: 4.644 / grad: -99.543 / stop criter: 266.181 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 100 / bw: 4.862 / grad: -17.591 / stop criter: 99.543 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 100 / bw: 4.862 / grad: -17.591 / stop criter: 99.543 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 101 / bw: 4.900 / grad: -214.269 / stop criter: 17.591 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 101 / bw: 4.900 / grad: -214.269 / stop criter: 17.591 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 102 / bw: 5.364 / grad: 165.417 / stop criter: 214.269 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 102 / bw: 5.364 / grad: 165.417 / stop criter: 214.269 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 103 / bw: 5.006 / grad: 122.717 / stop criter: 165.417 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 103 / bw: 5.006 / grad: 122.717 / stop criter: 165.417 :  32%|███▏      | 95/300 [00:01&lt;00:03, 67.44it/s]* GD progress: iter: 103 / bw: 5.006 / grad: 122.717 / stop criter: 165.417 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 104 / bw: 4.743 / grad: -96.578 / stop criter: 122.717 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 104 / bw: 4.743 / grad: -96.578 / stop criter: 122.717 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 105 / bw: 4.950 / grad: -120.068 / stop criter: 96.578 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 105 / bw: 4.950 / grad: -120.068 / stop criter: 96.578 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 106 / bw: 5.205 / grad: -62.619 / stop criter: 120.068 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 106 / bw: 5.205 / grad: -62.619 / stop criter: 120.068 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 107 / bw: 5.338 / grad: -239.014 / stop criter: 62.619 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 107 / bw: 5.338 / grad: -239.014 / stop criter: 62.619 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 108 / bw: 5.845 / grad: 15.942 / stop criter: 239.014 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s] * GD progress: iter: 108 / bw: 5.845 / grad: 15.942 / stop criter: 239.014 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 109 / bw: 5.811 / grad: -237.221 / stop criter: 15.942 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 109 / bw: 5.811 / grad: -237.221 / stop criter: 15.942 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 110 / bw: 6.309 / grad: -217.566 / stop criter: 237.221 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 110 / bw: 6.309 / grad: -217.566 / stop criter: 237.221 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 111 / bw: 6.762 / grad: 77.081 / stop criter: 217.566 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]  * GD progress: iter: 111 / bw: 6.762 / grad: 77.081 / stop criter: 217.566 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 112 / bw: 6.602 / grad: -39.334 / stop criter: 77.081 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 112 / bw: 6.602 / grad: -39.334 / stop criter: 77.081 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 113 / bw: 6.683 / grad: 130.074 / stop criter: 39.334 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 113 / bw: 6.683 / grad: 130.074 / stop criter: 39.334 :  34%|███▍      | 103/300 [00:01&lt;00:02, 66.25it/s]* GD progress: iter: 113 / bw: 6.683 / grad: 130.074 / stop criter: 39.334 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 114 / bw: 6.417 / grad: -103.932 / stop criter: 130.074 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 114 / bw: 6.417 / grad: -103.932 / stop criter: 130.074 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 115 / bw: 6.627 / grad: -221.628 / stop criter: 103.932 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 115 / bw: 6.627 / grad: -221.628 / stop criter: 103.932 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 116 / bw: 7.070 / grad: 143.353 / stop criter: 221.628 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s] * GD progress: iter: 116 / bw: 7.070 / grad: 143.353 / stop criter: 221.628 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 117 / bw: 6.784 / grad: -142.053 / stop criter: 143.353 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 117 / bw: 6.784 / grad: -142.053 / stop criter: 143.353 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 118 / bw: 7.065 / grad: 127.399 / stop criter: 142.053 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s] * GD progress: iter: 118 / bw: 7.065 / grad: 127.399 / stop criter: 142.053 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 119 / bw: 6.815 / grad: 70.998 / stop criter: 127.399 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s] * GD progress: iter: 119 / bw: 6.815 / grad: 70.998 / stop criter: 127.399 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 120 / bw: 6.677 / grad: 152.601 / stop criter: 70.998 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 120 / bw: 6.677 / grad: 152.601 / stop criter: 70.998 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 121 / bw: 6.382 / grad: -342.450 / stop criter: 152.601 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 121 / bw: 6.382 / grad: -342.450 / stop criter: 152.601 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 122 / bw: 7.046 / grad: -90.184 / stop criter: 342.450 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s] * GD progress: iter: 122 / bw: 7.046 / grad: -90.184 / stop criter: 342.450 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 123 / bw: 7.219 / grad: -238.491 / stop criter: 90.184 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 123 / bw: 7.219 / grad: -238.491 / stop criter: 90.184 :  38%|███▊      | 113/300 [00:01&lt;00:02, 73.36it/s]* GD progress: iter: 123 / bw: 7.219 / grad: -238.491 / stop criter: 90.184 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 124 / bw: 7.676 / grad: 207.090 / stop criter: 238.491 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 124 / bw: 7.676 / grad: 207.090 / stop criter: 238.491 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 125 / bw: 7.279 / grad: 78.937 / stop criter: 207.090 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s] * GD progress: iter: 125 / bw: 7.279 / grad: 78.937 / stop criter: 207.090 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 126 / bw: 7.129 / grad: 131.022 / stop criter: 78.937 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 126 / bw: 7.129 / grad: 131.022 / stop criter: 78.937 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 127 / bw: 6.880 / grad: 43.907 / stop criter: 131.022 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 127 / bw: 6.880 / grad: 43.907 / stop criter: 131.022 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 128 / bw: 6.796 / grad: -29.351 / stop criter: 43.907 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 128 / bw: 6.796 / grad: -29.351 / stop criter: 43.907 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 129 / bw: 6.852 / grad: -12.140 / stop criter: 29.351 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 129 / bw: 6.852 / grad: -12.140 / stop criter: 29.351 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 130 / bw: 6.875 / grad: 30.047 / stop criter: 12.140 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s] * GD progress: iter: 130 / bw: 6.875 / grad: 30.047 / stop criter: 12.140 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 131 / bw: 6.819 / grad: 32.725 / stop criter: 30.047 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 131 / bw: 6.819 / grad: 32.725 / stop criter: 30.047 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 132 / bw: 6.758 / grad: -98.945 / stop criter: 32.725 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 132 / bw: 6.758 / grad: -98.945 / stop criter: 32.725 :  41%|████      | 123/300 [00:01&lt;00:02, 79.68it/s]* GD progress: iter: 132 / bw: 6.758 / grad: -98.945 / stop criter: 32.725 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 133 / bw: 6.942 / grad: -83.748 / stop criter: 98.945 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 133 / bw: 6.942 / grad: -83.748 / stop criter: 98.945 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 134 / bw: 7.096 / grad: 44.525 / stop criter: 83.748 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s] * GD progress: iter: 134 / bw: 7.096 / grad: 44.525 / stop criter: 83.748 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 135 / bw: 7.014 / grad: -133.431 / stop criter: 44.525 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 135 / bw: 7.014 / grad: -133.431 / stop criter: 44.525 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 136 / bw: 7.258 / grad: -19.101 / stop criter: 133.431 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 136 / bw: 7.258 / grad: -19.101 / stop criter: 133.431 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 137 / bw: 7.292 / grad: 11.152 / stop criter: 19.101 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]  * GD progress: iter: 137 / bw: 7.292 / grad: 11.152 / stop criter: 19.101 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 138 / bw: 7.272 / grad: 24.977 / stop criter: 11.152 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 138 / bw: 7.272 / grad: 24.977 / stop criter: 11.152 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 139 / bw: 7.227 / grad: 65.267 / stop criter: 24.977 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 139 / bw: 7.227 / grad: 65.267 / stop criter: 24.977 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 140 / bw: 7.111 / grad: 146.758 / stop criter: 65.267 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 140 / bw: 7.111 / grad: 146.758 / stop criter: 65.267 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 141 / bw: 6.848 / grad: -105.617 / stop criter: 146.758 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 141 / bw: 6.848 / grad: -105.617 / stop criter: 146.758 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 142 / bw: 7.037 / grad: -35.572 / stop criter: 105.617 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s] * GD progress: iter: 142 / bw: 7.037 / grad: -35.572 / stop criter: 105.617 :  44%|████▍     | 132/300 [00:01&lt;00:02, 81.50it/s]* GD progress: iter: 142 / bw: 7.037 / grad: -35.572 / stop criter: 105.617 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 143 / bw: 7.100 / grad: 78.114 / stop criter: 35.572 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]  * GD progress: iter: 143 / bw: 7.100 / grad: 78.114 / stop criter: 35.572 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 144 / bw: 6.962 / grad: 151.373 / stop criter: 78.114 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 144 / bw: 6.962 / grad: 151.373 / stop criter: 78.114 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 145 / bw: 6.696 / grad: 39.127 / stop criter: 151.373 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 145 / bw: 6.696 / grad: 39.127 / stop criter: 151.373 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 146 / bw: 6.628 / grad: -17.509 / stop criter: 39.127 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 146 / bw: 6.628 / grad: -17.509 / stop criter: 39.127 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 147 / bw: 6.658 / grad: 62.070 / stop criter: 17.509 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s] * GD progress: iter: 147 / bw: 6.658 / grad: 62.070 / stop criter: 17.509 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 148 / bw: 6.551 / grad: 67.325 / stop criter: 62.070 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 148 / bw: 6.551 / grad: 67.325 / stop criter: 62.070 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 149 / bw: 6.435 / grad: 116.948 / stop criter: 67.325 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 149 / bw: 6.435 / grad: 116.948 / stop criter: 67.325 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 150 / bw: 6.234 / grad: 159.892 / stop criter: 116.948 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 150 / bw: 6.234 / grad: 159.892 / stop criter: 116.948 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 151 / bw: 5.959 / grad: 24.525 / stop criter: 159.892 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s] * GD progress: iter: 151 / bw: 5.959 / grad: 24.525 / stop criter: 159.892 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 152 / bw: 5.917 / grad: 18.531 / stop criter: 24.525 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s] * GD progress: iter: 152 / bw: 5.917 / grad: 18.531 / stop criter: 24.525 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 153 / bw: 5.885 / grad: 118.354 / stop criter: 18.531 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 153 / bw: 5.885 / grad: 118.354 / stop criter: 18.531 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 154 / bw: 5.682 / grad: 105.508 / stop criter: 118.354 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 154 / bw: 5.682 / grad: 105.508 / stop criter: 118.354 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 155 / bw: 5.501 / grad: 108.074 / stop criter: 105.508 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 155 / bw: 5.501 / grad: 108.074 / stop criter: 105.508 :  47%|████▋     | 142/300 [00:01&lt;00:01, 84.10it/s]* GD progress: iter: 155 / bw: 5.501 / grad: 108.074 / stop criter: 105.508 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 156 / bw: 5.315 / grad: 43.242 / stop criter: 108.074 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s] * GD progress: iter: 156 / bw: 5.315 / grad: 43.242 / stop criter: 108.074 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 157 / bw: 5.241 / grad: -225.629 / stop criter: 43.242 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 157 / bw: 5.241 / grad: -225.629 / stop criter: 43.242 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 158 / bw: 5.628 / grad: 110.111 / stop criter: 225.629 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 158 / bw: 5.628 / grad: 110.111 / stop criter: 225.629 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 159 / bw: 5.441 / grad: -157.832 / stop criter: 110.111 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 159 / bw: 5.441 / grad: -157.832 / stop criter: 110.111 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s]* GD progress: iter: 160 / bw: 5.707 / grad: 149.315 / stop criter: 157.832 :  52%|█████▏    | 155/300 [00:01&lt;00:01, 95.06it/s] * GD progress: iter: 160 / bw: 5.707 / grad: 149.315 / stop criter: 157.832 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 161 / bw: 5.458 / grad: 156.112 / stop criter: 149.315 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 161 / bw: 5.458 / grad: 156.112 / stop criter: 149.315 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 162 / bw: 5.200 / grad: -7.752 / stop criter: 156.112 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s] * GD progress: iter: 162 / bw: 5.200 / grad: -7.752 / stop criter: 156.112 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 163 / bw: 5.213 / grad: -78.201 / stop criter: 7.752 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s] * GD progress: iter: 163 / bw: 5.213 / grad: -78.201 / stop criter: 7.752 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 164 / bw: 5.341 / grad: -79.861 / stop criter: 78.201 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 164 / bw: 5.341 / grad: -79.861 / stop criter: 78.201 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 165 / bw: 5.471 / grad: 1.867 / stop criter: 79.861 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]  * GD progress: iter: 165 / bw: 5.471 / grad: 1.867 / stop criter: 79.861 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 166 / bw: 5.468 / grad: -2.683 / stop criter: 1.867 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 166 / bw: 5.468 / grad: -2.683 / stop criter: 1.867 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 167 / bw: 5.473 / grad: -194.413 / stop criter: 2.683 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 167 / bw: 5.473 / grad: -194.413 / stop criter: 2.683 :  52%|█████▏    | 155/300 [00:02&lt;00:01, 95.06it/s]* GD progress: iter: 167 / bw: 5.473 / grad: -194.413 / stop criter: 2.683 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 168 / bw: 5.784 / grad: -65.613 / stop criter: 194.413 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 168 / bw: 5.784 / grad: -65.613 / stop criter: 194.413 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 169 / bw: 5.889 / grad: -130.916 / stop criter: 65.613 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 169 / bw: 5.889 / grad: -130.916 / stop criter: 65.613 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 170 / bw: 6.099 / grad: 274.525 / stop criter: 130.916 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 170 / bw: 6.099 / grad: 274.525 / stop criter: 130.916 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 171 / bw: 5.659 / grad: 52.343 / stop criter: 274.525 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s] * GD progress: iter: 171 / bw: 5.659 / grad: 52.343 / stop criter: 274.525 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 172 / bw: 5.576 / grad: -62.908 / stop criter: 52.343 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 172 / bw: 5.576 / grad: -62.908 / stop criter: 52.343 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 173 / bw: 5.676 / grad: 107.296 / stop criter: 62.908 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 173 / bw: 5.676 / grad: 107.296 / stop criter: 62.908 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 174 / bw: 5.507 / grad: 0.721 / stop criter: 107.296 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s] * GD progress: iter: 174 / bw: 5.507 / grad: 0.721 / stop criter: 107.296 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 175 / bw: 5.506 / grad: -175.566 / stop criter: 0.721 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 175 / bw: 5.506 / grad: -175.566 / stop criter: 0.721 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 176 / bw: 5.779 / grad: 124.085 / stop criter: 175.566 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 176 / bw: 5.779 / grad: 124.085 / stop criter: 175.566 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 177 / bw: 5.588 / grad: -81.974 / stop criter: 124.085 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 177 / bw: 5.588 / grad: -81.974 / stop criter: 124.085 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 178 / bw: 5.713 / grad: 172.011 / stop criter: 81.974 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s] * GD progress: iter: 178 / bw: 5.713 / grad: 172.011 / stop criter: 81.974 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 179 / bw: 5.454 / grad: 13.807 / stop criter: 172.011 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 179 / bw: 5.454 / grad: 13.807 / stop criter: 172.011 :  56%|█████▌    | 167/300 [00:02&lt;00:01, 101.96it/s]* GD progress: iter: 179 / bw: 5.454 / grad: 13.807 / stop criter: 172.011 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 180 / bw: 5.433 / grad: -0.940 / stop criter: 13.807 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s] * GD progress: iter: 180 / bw: 5.433 / grad: -0.940 / stop criter: 13.807 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 181 / bw: 5.434 / grad: 15.126 / stop criter: 0.940 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s] * GD progress: iter: 181 / bw: 5.434 / grad: 15.126 / stop criter: 0.940 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 182 / bw: 5.412 / grad: -129.078 / stop criter: 15.126 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 182 / bw: 5.412 / grad: -129.078 / stop criter: 15.126 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 183 / bw: 5.601 / grad: -139.825 / stop criter: 129.078 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 183 / bw: 5.601 / grad: -139.825 / stop criter: 129.078 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 184 / bw: 5.803 / grad: -132.702 / stop criter: 139.825 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 184 / bw: 5.803 / grad: -132.702 / stop criter: 139.825 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 185 / bw: 5.996 / grad: 129.594 / stop criter: 132.702 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s] * GD progress: iter: 185 / bw: 5.996 / grad: 129.594 / stop criter: 132.702 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 186 / bw: 5.808 / grad: 30.519 / stop criter: 129.594 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s] * GD progress: iter: 186 / bw: 5.808 / grad: 30.519 / stop criter: 129.594 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 187 / bw: 5.764 / grad: -2.166 / stop criter: 30.519 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s] * GD progress: iter: 187 / bw: 5.764 / grad: -2.166 / stop criter: 30.519 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 188 / bw: 5.767 / grad: 206.132 / stop criter: 2.166 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 188 / bw: 5.767 / grad: 206.132 / stop criter: 2.166 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 189 / bw: 5.475 / grad: 82.967 / stop criter: 206.132 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 189 / bw: 5.475 / grad: 82.967 / stop criter: 206.132 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 190 / bw: 5.358 / grad: -68.424 / stop criter: 82.967 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 190 / bw: 5.358 / grad: -68.424 / stop criter: 82.967 :  60%|█████▉    | 179/300 [00:02&lt;00:01, 102.52it/s]* GD progress: iter: 190 / bw: 5.358 / grad: -68.424 / stop criter: 82.967 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 191 / bw: 5.454 / grad: -127.950 / stop criter: 68.424 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 191 / bw: 5.454 / grad: -127.950 / stop criter: 68.424 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 192 / bw: 5.632 / grad: 0.844 / stop criter: 127.950 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]  * GD progress: iter: 192 / bw: 5.632 / grad: 0.844 / stop criter: 127.950 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 193 / bw: 5.631 / grad: -173.025 / stop criter: 0.844 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 193 / bw: 5.631 / grad: -173.025 / stop criter: 0.844 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 194 / bw: 5.869 / grad: 179.265 / stop criter: 173.025 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 194 / bw: 5.869 / grad: 179.265 / stop criter: 173.025 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 195 / bw: 5.625 / grad: -82.556 / stop criter: 179.265 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 195 / bw: 5.625 / grad: -82.556 / stop criter: 179.265 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 196 / bw: 5.736 / grad: 144.252 / stop criter: 82.556 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s] * GD progress: iter: 196 / bw: 5.736 / grad: 144.252 / stop criter: 82.556 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 197 / bw: 5.544 / grad: -14.350 / stop criter: 144.252 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 197 / bw: 5.544 / grad: -14.350 / stop criter: 144.252 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 198 / bw: 5.563 / grad: -103.269 / stop criter: 14.350 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 198 / bw: 5.563 / grad: -103.269 / stop criter: 14.350 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 199 / bw: 5.698 / grad: 40.812 / stop criter: 103.269 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s] * GD progress: iter: 199 / bw: 5.698 / grad: 40.812 / stop criter: 103.269 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 200 / bw: 5.644 / grad: -129.579 / stop criter: 40.812 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 200 / bw: 5.644 / grad: -129.579 / stop criter: 40.812 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 201 / bw: 5.812 / grad: -57.843 / stop criter: 129.579 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 201 / bw: 5.812 / grad: -57.843 / stop criter: 129.579 :  63%|██████▎   | 190/300 [00:02&lt;00:01, 104.48it/s]* GD progress: iter: 201 / bw: 5.812 / grad: -57.843 / stop criter: 129.579 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s] * GD progress: iter: 202 / bw: 5.887 / grad: 56.723 / stop criter: 57.843 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]  * GD progress: iter: 202 / bw: 5.887 / grad: 56.723 / stop criter: 57.843 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 203 / bw: 5.814 / grad: 101.647 / stop criter: 56.723 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 203 / bw: 5.814 / grad: 101.647 / stop criter: 56.723 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 204 / bw: 5.685 / grad: 177.864 / stop criter: 101.647 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 204 / bw: 5.685 / grad: 177.864 / stop criter: 101.647 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 205 / bw: 5.459 / grad: -113.342 / stop criter: 177.864 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 205 / bw: 5.459 / grad: -113.342 / stop criter: 177.864 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 206 / bw: 5.603 / grad: -155.040 / stop criter: 113.342 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 206 / bw: 5.603 / grad: -155.040 / stop criter: 113.342 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 207 / bw: 5.798 / grad: -215.229 / stop criter: 155.040 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 207 / bw: 5.798 / grad: -215.229 / stop criter: 155.040 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 208 / bw: 6.069 / grad: 7.625 / stop criter: 215.229 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]   * GD progress: iter: 208 / bw: 6.069 / grad: 7.625 / stop criter: 215.229 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 209 / bw: 6.059 / grad: 115.324 / stop criter: 7.625 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 209 / bw: 6.059 / grad: 115.324 / stop criter: 7.625 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 210 / bw: 5.915 / grad: -15.096 / stop criter: 115.324 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 210 / bw: 5.915 / grad: -15.096 / stop criter: 115.324 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 211 / bw: 5.934 / grad: -82.492 / stop criter: 15.096 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s] * GD progress: iter: 211 / bw: 5.934 / grad: -82.492 / stop criter: 15.096 :  67%|██████▋   | 201/300 [00:02&lt;00:01, 96.72it/s]* GD progress: iter: 211 / bw: 5.934 / grad: -82.492 / stop criter: 15.096 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 212 / bw: 6.036 / grad: -270.990 / stop criter: 82.492 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 212 / bw: 6.036 / grad: -270.990 / stop criter: 82.492 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 213 / bw: 6.370 / grad: 100.863 / stop criter: 270.990 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 213 / bw: 6.370 / grad: 100.863 / stop criter: 270.990 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 214 / bw: 6.246 / grad: -320.825 / stop criter: 100.863 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 214 / bw: 6.246 / grad: -320.825 / stop criter: 100.863 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 215 / bw: 6.637 / grad: -3.941 / stop criter: 320.825 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]  * GD progress: iter: 215 / bw: 6.637 / grad: -3.941 / stop criter: 320.825 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 216 / bw: 6.642 / grad: 215.161 / stop criter: 3.941 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s] * GD progress: iter: 216 / bw: 6.642 / grad: 215.161 / stop criter: 3.941 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 217 / bw: 6.382 / grad: 140.407 / stop criter: 215.161 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 217 / bw: 6.382 / grad: 140.407 / stop criter: 215.161 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 218 / bw: 6.214 / grad: 72.837 / stop criter: 140.407 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s] * GD progress: iter: 218 / bw: 6.214 / grad: 72.837 / stop criter: 140.407 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 219 / bw: 6.127 / grad: -73.000 / stop criter: 72.837 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 219 / bw: 6.127 / grad: -73.000 / stop criter: 72.837 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 220 / bw: 6.214 / grad: -49.542 / stop criter: 73.000 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 220 / bw: 6.214 / grad: -49.542 / stop criter: 73.000 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 221 / bw: 6.273 / grad: 19.428 / stop criter: 49.542 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s] * GD progress: iter: 221 / bw: 6.273 / grad: 19.428 / stop criter: 49.542 :  70%|███████   | 211/300 [00:02&lt;00:00, 91.19it/s]* GD progress: iter: 221 / bw: 6.273 / grad: 19.428 / stop criter: 49.542 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 222 / bw: 6.250 / grad: -78.365 / stop criter: 19.428 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 222 / bw: 6.250 / grad: -78.365 / stop criter: 19.428 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 223 / bw: 6.342 / grad: -77.334 / stop criter: 78.365 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 223 / bw: 6.342 / grad: -77.334 / stop criter: 78.365 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 224 / bw: 6.432 / grad: 30.656 / stop criter: 77.334 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s] * GD progress: iter: 224 / bw: 6.432 / grad: 30.656 / stop criter: 77.334 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 225 / bw: 6.396 / grad: 59.344 / stop criter: 30.656 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 225 / bw: 6.396 / grad: 59.344 / stop criter: 30.656 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 226 / bw: 6.328 / grad: -87.608 / stop criter: 59.344 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 226 / bw: 6.328 / grad: -87.608 / stop criter: 59.344 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 227 / bw: 6.429 / grad: 45.542 / stop criter: 87.608 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s] * GD progress: iter: 227 / bw: 6.429 / grad: 45.542 / stop criter: 87.608 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 228 / bw: 6.377 / grad: 64.305 / stop criter: 45.542 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 228 / bw: 6.377 / grad: 64.305 / stop criter: 45.542 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 229 / bw: 6.304 / grad: -6.446 / stop criter: 64.305 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 229 / bw: 6.304 / grad: -6.446 / stop criter: 64.305 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 230 / bw: 6.312 / grad: 296.656 / stop criter: 6.446 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 230 / bw: 6.312 / grad: 296.656 / stop criter: 6.446 :  74%|███████▎  | 221/300 [00:02&lt;00:00, 85.45it/s]* GD progress: iter: 230 / bw: 6.312 / grad: 296.656 / stop criter: 6.446 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 231 / bw: 5.981 / grad: 62.628 / stop criter: 296.656 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 231 / bw: 5.981 / grad: 62.628 / stop criter: 296.656 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 232 / bw: 5.912 / grad: -105.383 / stop criter: 62.628 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 232 / bw: 5.912 / grad: -105.383 / stop criter: 62.628 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 233 / bw: 6.028 / grad: -242.399 / stop criter: 105.383 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 233 / bw: 6.028 / grad: -242.399 / stop criter: 105.383 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 234 / bw: 6.293 / grad: 2.763 / stop criter: 242.399 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]   * GD progress: iter: 234 / bw: 6.293 / grad: 2.763 / stop criter: 242.399 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 235 / bw: 6.290 / grad: 76.228 / stop criter: 2.763 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s] * GD progress: iter: 235 / bw: 6.290 / grad: 76.228 / stop criter: 2.763 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 236 / bw: 6.207 / grad: 108.131 / stop criter: 76.228 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 236 / bw: 6.207 / grad: 108.131 / stop criter: 76.228 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 237 / bw: 6.090 / grad: 51.036 / stop criter: 108.131 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 237 / bw: 6.090 / grad: 51.036 / stop criter: 108.131 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 238 / bw: 6.035 / grad: 6.856 / stop criter: 51.036 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]  * GD progress: iter: 238 / bw: 6.035 / grad: 6.856 / stop criter: 51.036 :  77%|███████▋  | 230/300 [00:02&lt;00:00, 75.85it/s]* GD progress: iter: 238 / bw: 6.035 / grad: 6.856 / stop criter: 51.036 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 239 / bw: 6.028 / grad: -87.091 / stop criter: 6.856 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 239 / bw: 6.028 / grad: -87.091 / stop criter: 6.856 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 240 / bw: 6.122 / grad: 25.440 / stop criter: 87.091 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 240 / bw: 6.122 / grad: 25.440 / stop criter: 87.091 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 241 / bw: 6.095 / grad: 31.610 / stop criter: 25.440 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 241 / bw: 6.095 / grad: 31.610 / stop criter: 25.440 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 242 / bw: 6.061 / grad: -71.360 / stop criter: 31.610 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 242 / bw: 6.061 / grad: -71.360 / stop criter: 31.610 :  79%|███████▉  | 238/300 [00:02&lt;00:00, 75.62it/s]* GD progress: iter: 243 / bw: 6.137 / grad: 42.381 / stop criter: 71.360 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s] * GD progress: iter: 243 / bw: 6.137 / grad: 42.381 / stop criter: 71.360 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 244 / bw: 6.092 / grad: 168.585 / stop criter: 42.381 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 244 / bw: 6.092 / grad: 168.585 / stop criter: 42.381 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 245 / bw: 5.917 / grad: 100.243 / stop criter: 168.585 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 245 / bw: 5.917 / grad: 100.243 / stop criter: 168.585 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 246 / bw: 5.813 / grad: -115.870 / stop criter: 100.243 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 246 / bw: 5.813 / grad: -115.870 / stop criter: 100.243 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 247 / bw: 5.933 / grad: -124.897 / stop criter: 115.870 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 247 / bw: 5.933 / grad: -124.897 / stop criter: 115.870 :  79%|███████▉  | 238/300 [00:03&lt;00:00, 75.62it/s]* GD progress: iter: 247 / bw: 5.933 / grad: -124.897 / stop criter: 115.870 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 248 / bw: 6.062 / grad: 20.357 / stop criter: 124.897 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]  * GD progress: iter: 248 / bw: 6.062 / grad: 20.357 / stop criter: 124.897 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 249 / bw: 6.041 / grad: 205.181 / stop criter: 20.357 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 249 / bw: 6.041 / grad: 205.181 / stop criter: 20.357 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 250 / bw: 5.832 / grad: -191.454 / stop criter: 205.181 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 250 / bw: 5.832 / grad: -191.454 / stop criter: 205.181 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 251 / bw: 6.027 / grad: 245.195 / stop criter: 191.454 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s] * GD progress: iter: 251 / bw: 6.027 / grad: 245.195 / stop criter: 191.454 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 252 / bw: 5.780 / grad: -25.546 / stop criter: 245.195 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 252 / bw: 5.780 / grad: -25.546 / stop criter: 245.195 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 253 / bw: 5.805 / grad: -302.118 / stop criter: 25.546 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 253 / bw: 5.805 / grad: -302.118 / stop criter: 25.546 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 254 / bw: 6.104 / grad: -2.182 / stop criter: 302.118 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s] * GD progress: iter: 254 / bw: 6.104 / grad: -2.182 / stop criter: 302.118 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 255 / bw: 6.106 / grad: 56.439 / stop criter: 2.182 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]  * GD progress: iter: 255 / bw: 6.106 / grad: 56.439 / stop criter: 2.182 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 256 / bw: 6.050 / grad: 91.487 / stop criter: 56.439 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 256 / bw: 6.050 / grad: 91.487 / stop criter: 56.439 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 257 / bw: 5.961 / grad: -46.561 / stop criter: 91.487 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 257 / bw: 5.961 / grad: -46.561 / stop criter: 91.487 :  82%|████████▏ | 247/300 [00:03&lt;00:00, 77.36it/s]* GD progress: iter: 257 / bw: 5.961 / grad: -46.561 / stop criter: 91.487 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 258 / bw: 6.006 / grad: 28.323 / stop criter: 46.561 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s] * GD progress: iter: 258 / bw: 6.006 / grad: 28.323 / stop criter: 46.561 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 259 / bw: 5.979 / grad: -169.128 / stop criter: 28.323 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 259 / bw: 5.979 / grad: -169.128 / stop criter: 28.323 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 260 / bw: 6.141 / grad: 25.650 / stop criter: 169.128 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s] * GD progress: iter: 260 / bw: 6.141 / grad: 25.650 / stop criter: 169.128 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 261 / bw: 6.117 / grad: -49.348 / stop criter: 25.650 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 261 / bw: 6.117 / grad: -49.348 / stop criter: 25.650 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 262 / bw: 6.163 / grad: -20.992 / stop criter: 49.348 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 262 / bw: 6.163 / grad: -20.992 / stop criter: 49.348 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 263 / bw: 6.183 / grad: 28.480 / stop criter: 20.992 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s] * GD progress: iter: 263 / bw: 6.183 / grad: 28.480 / stop criter: 20.992 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 264 / bw: 6.156 / grad: -182.134 / stop criter: 28.480 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 264 / bw: 6.156 / grad: -182.134 / stop criter: 28.480 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 265 / bw: 6.324 / grad: -307.695 / stop criter: 182.134 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 265 / bw: 6.324 / grad: -307.695 / stop criter: 182.134 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 266 / bw: 6.605 / grad: 20.787 / stop criter: 307.695 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]  * GD progress: iter: 266 / bw: 6.605 / grad: 20.787 / stop criter: 307.695 :  86%|████████▌ | 257/300 [00:03&lt;00:00, 80.49it/s]* GD progress: iter: 266 / bw: 6.605 / grad: 20.787 / stop criter: 307.695 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 267 / bw: 6.586 / grad: 34.771 / stop criter: 20.787 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s] * GD progress: iter: 267 / bw: 6.586 / grad: 34.771 / stop criter: 20.787 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 268 / bw: 6.554 / grad: 130.199 / stop criter: 34.771 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 268 / bw: 6.554 / grad: 130.199 / stop criter: 34.771 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 269 / bw: 6.437 / grad: -15.178 / stop criter: 130.199 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 269 / bw: 6.437 / grad: -15.178 / stop criter: 130.199 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 270 / bw: 6.450 / grad: -7.770 / stop criter: 15.178 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]  * GD progress: iter: 270 / bw: 6.450 / grad: -7.770 / stop criter: 15.178 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 271 / bw: 6.457 / grad: 81.926 / stop criter: 7.770 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s] * GD progress: iter: 271 / bw: 6.457 / grad: 81.926 / stop criter: 7.770 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 272 / bw: 6.384 / grad: -44.748 / stop criter: 81.926 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 272 / bw: 6.384 / grad: -44.748 / stop criter: 81.926 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 273 / bw: 6.424 / grad: 59.409 / stop criter: 44.748 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s] * GD progress: iter: 273 / bw: 6.424 / grad: 59.409 / stop criter: 44.748 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 274 / bw: 6.372 / grad: 6.971 / stop criter: 59.409 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s] * GD progress: iter: 274 / bw: 6.372 / grad: 6.971 / stop criter: 59.409 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 275 / bw: 6.366 / grad: 252.662 / stop criter: 6.971 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 275 / bw: 6.366 / grad: 252.662 / stop criter: 6.971 :  89%|████████▊ | 266/300 [00:03&lt;00:00, 75.91it/s]* GD progress: iter: 275 / bw: 6.366 / grad: 252.662 / stop criter: 6.971 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 276 / bw: 6.146 / grad: -136.433 / stop criter: 252.662 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 276 / bw: 6.146 / grad: -136.433 / stop criter: 252.662 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 277 / bw: 6.265 / grad: 27.530 / stop criter: 136.433 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]  * GD progress: iter: 277 / bw: 6.265 / grad: 27.530 / stop criter: 136.433 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 278 / bw: 6.241 / grad: -194.486 / stop criter: 27.530 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 278 / bw: 6.241 / grad: -194.486 / stop criter: 27.530 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 279 / bw: 6.406 / grad: -3.730 / stop criter: 194.486 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s] * GD progress: iter: 279 / bw: 6.406 / grad: -3.730 / stop criter: 194.486 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 280 / bw: 6.410 / grad: 122.413 / stop criter: 3.730 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s] * GD progress: iter: 280 / bw: 6.410 / grad: 122.413 / stop criter: 3.730 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 281 / bw: 6.307 / grad: 185.867 / stop criter: 122.413 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 281 / bw: 6.307 / grad: 185.867 / stop criter: 122.413 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 282 / bw: 6.152 / grad: -80.013 / stop criter: 185.867 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 282 / bw: 6.152 / grad: -80.013 / stop criter: 185.867 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 283 / bw: 6.218 / grad: 102.451 / stop criter: 80.013 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s] * GD progress: iter: 283 / bw: 6.218 / grad: 102.451 / stop criter: 80.013 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 284 / bw: 6.134 / grad: 63.982 / stop criter: 102.451 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 284 / bw: 6.134 / grad: 63.982 / stop criter: 102.451 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 285 / bw: 6.081 / grad: -142.696 / stop criter: 63.982 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 285 / bw: 6.081 / grad: -142.696 / stop criter: 63.982 :  92%|█████████▏| 275/300 [00:03&lt;00:00, 79.25it/s]* GD progress: iter: 285 / bw: 6.081 / grad: -142.696 / stop criter: 63.982 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 286 / bw: 6.198 / grad: -153.223 / stop criter: 142.696 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 286 / bw: 6.198 / grad: -153.223 / stop criter: 142.696 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 287 / bw: 6.322 / grad: -22.068 / stop criter: 153.223 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s] * GD progress: iter: 287 / bw: 6.322 / grad: -22.068 / stop criter: 153.223 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 288 / bw: 6.340 / grad: 217.453 / stop criter: 22.068 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s] * GD progress: iter: 288 / bw: 6.340 / grad: 217.453 / stop criter: 22.068 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 289 / bw: 6.164 / grad: -194.913 / stop criter: 217.453 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 289 / bw: 6.164 / grad: -194.913 / stop criter: 217.453 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 290 / bw: 6.320 / grad: -19.462 / stop criter: 194.913 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s] * GD progress: iter: 290 / bw: 6.320 / grad: -19.462 / stop criter: 194.913 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 291 / bw: 6.335 / grad: 139.137 / stop criter: 19.462 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s] * GD progress: iter: 291 / bw: 6.335 / grad: 139.137 / stop criter: 19.462 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 292 / bw: 6.225 / grad: 176.398 / stop criter: 139.137 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 292 / bw: 6.225 / grad: 176.398 / stop criter: 139.137 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 293 / bw: 6.087 / grad: 9.538 / stop criter: 176.398 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]  * GD progress: iter: 293 / bw: 6.087 / grad: 9.538 / stop criter: 176.398 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 294 / bw: 6.079 / grad: 1.077 / stop criter: 9.538 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]  * GD progress: iter: 294 / bw: 6.079 / grad: 1.077 / stop criter: 9.538 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 295 / bw: 6.078 / grad: 96.985 / stop criter: 1.077 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 295 / bw: 6.078 / grad: 96.985 / stop criter: 1.077 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 296 / bw: 6.002 / grad: 10.792 / stop criter: 96.985 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 296 / bw: 6.002 / grad: 10.792 / stop criter: 96.985 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 297 / bw: 5.994 / grad: 78.838 / stop criter: 10.792 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 297 / bw: 5.994 / grad: 78.838 / stop criter: 10.792 :  95%|█████████▌| 285/300 [00:03&lt;00:00, 81.23it/s]* GD progress: iter: 297 / bw: 5.994 / grad: 78.838 / stop criter: 10.792 :  99%|█████████▉| 297/300 [00:03&lt;00:00, 87.63it/s]* GD progress: iter: 298 / bw: 5.932 / grad: -17.450 / stop criter: 78.838 :  99%|█████████▉| 297/300 [00:03&lt;00:00, 87.63it/s]* GD progress: iter: 298 / bw: 5.932 / grad: -17.450 / stop criter: 78.838 :  99%|█████████▉| 297/300 [00:03&lt;00:00, 87.63it/s]* GD progress: iter: 299 / bw: 5.946 / grad: 35.293 / stop criter: 17.450 :  99%|█████████▉| 297/300 [00:03&lt;00:00, 87.63it/s] * GD progress: iter: 299 / bw: 5.946 / grad: 35.293 / stop criter: 17.450 :  99%|█████████▉| 297/300 [00:03&lt;00:00, 87.63it/s]* GD progress: iter: 300 / bw: 5.918 / grad: -86.568 / stop criter: 35.293 :  99%|█████████▉| 297/300 [00:03&lt;00:00, 87.63it/s]* GD progress: iter: 300 / bw: 5.918 / grad: -86.568 / stop criter: 35.293 :  99%|█████████▉| 297/300 [00:03&lt;00:00, 87.63it/s]* GD progress: iter: 300 / bw: 5.918 / grad: -86.568 / stop criter: 35.293 : 100%|██████████| 300/300 [00:03&lt;00:00, 81.89it/s]</code></pre>
</div>
</div>
<p>The estimated optimal bandwidth is given by <code>gc1.optimization_outputs['opt_bandwidth']</code>.</p>
<div id="12406d26" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient COBRA with default parameter</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(gc1_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :5.9182619785634</code></pre>
</div>
</div>
<p>We can look at the learning curve of the algorithm using <code>draw_learning_curve()</code> method.</p>
<div id="873737aa" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gc1_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="7298a775-c056-4055-97db-2e3473df052a" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7298a775-c056-4055-97db-2e3473df052a")) {                    Plotly.newPlot(                        "7298a775-c056-4055-97db-2e3473df052a",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299],"y":[3.1,3.1,3.1,3.1,3.1,2.6120627949128457,2.5051965806687835,2.4674058724542065,2.2588518764549863,2.070996493838442,2.4113886819838424,2.8929541485373735,3.0918022631697064,3.0204536992081845,4.0550547446682,3.471858315781624,3.8358319102651253,3.819389758439082,4.0641372866107055,4.094879106460729,4.420442350130617,3.8663470304954934,4.027016054933702,3.974695162626197,4.097863110016132,4.4100510195536895,4.142844952722096,3.5058411530017506,3.6205273139031093,3.201467595761507,2.9721514393378534,2.8779839292378977,2.6114375518200608,2.781342141583315,3.235686696050907,2.91143001810388,3.096073722833428,3.4938047166121318,3.328739255622181,3.613442413118112,4.298932458647778,4.33051899950958,4.275171908108239,4.553583724802205,5.066300123742356,4.825911655642039,5.326402587496953,4.851651956591166,5.277083871943813,5.394865497633476,5.732403485917653,5.321845167244302,5.839422035645343,6.0810116953675175,6.1773284697350554,6.0811260119899515,5.8849951215509275,5.949042740684192,5.9216778034158795,5.579205735616585,5.36421358474031,5.453953531575781,5.725271514821084,5.446611899365071,5.326025839879587,5.472758426406997,5.596363351031295,5.635917176538834,5.622140822054285,5.719708519803281,5.429681308736379,5.432663806152583,5.3439184005462605,5.882327465666839,5.716082076863581,6.062893239715098,5.618276037305115,5.836184994095196,6.214711099387119,6.232853306433468,6.048738568430675,6.157697974663367,6.076694256464126,6.128507626263155,5.9176965923736065,6.149535996050124,5.717656824242809,5.583165661398739,5.54589092958792,6.120449520905216,5.791748180091438,5.723285525179914,5.1250421048621595,4.773518537524284,5.265693978798005,5.493052837924723,5.4188871115669714,5.226519946159768,4.6443349484822125,4.86205399742865,4.900144590373721,5.3641025380402105,5.005923388800676,4.742860534483982,4.949889858026003,5.204699673717575,5.3375916344969765,5.8448313579503015,5.810998049797563,6.309399331169436,6.761933937018234,6.601606121149569,6.682601267541551,6.41743335683692,6.627190045886541,7.070008730720823,6.783584961143805,7.0645733064706215,6.815091391654751,6.677448481586356,6.381602472964547,7.04550545039001,7.218594506428536,7.676329507083804,7.278862702182321,7.128874175858626,6.879919673513033,6.796491598529752,6.852260944615778,6.875097485243895,6.818576684247829,6.7576323787509285,6.941896629930367,7.096300482401294,7.014210580615185,7.257753028994025,7.292267355693726,7.272116039753439,7.227434692654246,7.110678508927793,6.84814171044668,7.037080550602688,7.100078579877153,6.961737365948577,6.6963333436934915,6.627730770005652,6.658429622624119,6.550690189318289,6.434996926940406,6.23403163183795,5.959269612703266,5.917124945897112,5.8852807779923255,5.6818994635147355,5.500592702341982,5.314876760712365,5.24056856523085,5.628294444911226,5.440970465786671,5.706794562690935,5.457830013246632,5.200135434053468,5.212931729128732,5.3407281395116195,5.471236614083217,5.4681853219745005,5.472526816524977,5.783913651551363,5.889004312465025,6.09869060284128,5.658988972343925,5.575990753778528,5.675742262985705,5.507308294957854,5.50618717033183,5.7790351099635195,5.5881217789009705,5.712983292249839,5.453599672354549,5.432988019370493,5.434392058223419,5.412036213427862,5.600898195612543,5.8034383681524755,5.995660867447602,5.807939967260942,5.764174518765487,5.76728026263993,5.4746338410989175,5.358022616584415,5.454193223956196,5.6322299693295585,5.631056204618601,5.869405416417043,5.624930647786593,5.73639134040703,5.54358017019478,5.5625688806785485,5.6978534836480055,5.644388102786311,5.812442223537363,5.88670994100145,5.813880320247747,5.684674968232566,5.4585889479759,5.602659600420215,5.797762492940744,6.068607428167545,6.059012243299567,5.915339605147133,5.934146162679628,6.035888358688224,6.3701178390412965,6.245716745400515,6.637453086762216,6.642216950607422,6.382125751563489,6.21409678616076,6.1269311230637395,6.214292415029604,6.272987459745554,6.24996931783968,6.3418847412421595,6.431683437109099,6.396086256348578,6.327866149273179,6.428578233435692,6.376748369280363,6.304295494967845,6.311558530153974,5.980659268870791,5.911500357367262,6.027872817096199,6.292872083737805,6.289851324359459,6.2073494631835295,6.090318738674099,6.035082620725244,6.027662197576124,6.121920846863444,6.0946626875896355,6.061131923179831,6.136828384246718,6.092322085893613,5.9170514114983055,5.812832952956976,5.933297822581258,6.061848770881194,6.040895824880582,5.831823347109137,6.026908404119551,5.779561544610294,5.805074120125358,6.103779012518501,6.1059365570864825,6.05013517912811,5.960586594123171,6.006160999390737,5.978715070553096,6.140965133137836,6.1166043199296585,6.163003267434163,6.182543070608814,6.156032982631046,6.323875237104394,6.6045912972713525,6.585627348652039,6.55422234545809,6.436627202242555,6.450336104105934,6.457283819859163,6.384028690199075,6.423640731018165,6.371576822284081,6.3655285229222525,6.146317457396219,6.264687686746372,6.2410412941269655,6.406420687896728,6.409560971979795,6.3065091223885705,6.151604031368277,6.218288594124332,6.133757947216779,6.081494881727859,6.198053768999654,6.321959686310522,6.339805301621873,6.163958923978107,6.320002278709299,6.335426953057443,6.225150684570255,6.086740536433135,6.079256815571252,6.078411698163519,6.002312612144047,5.9938450779276975,5.931985144014801,5.945677528770224,5.9182619785634],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,299],"y":[5.9182619785634,5.9182619785634],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[1.18365239571268,2.678792263981329,4.173932132249977,5.669072000518626,7.164211868787274,8.659351737055923,10.154491605324573,11.649631473593221,13.144771341861869,14.639911210130517,16.135051078399165,17.630190946667813,19.125330814936465,20.620470683205113,22.11561055147376,23.61075041974241,25.105890288011057,26.601030156279705,28.096170024548353,29.591309892817],"y":[315.2045397346011,176.1838056858036,147.01628547370984,139.69394686581145,138.8070314845667,140.28242770105697,142.82398265388753,145.87878938961128,149.13912038942118,152.4145216920643,155.59080522998056,158.60622985073104,161.43390306447304,164.06826763915316,166.51554974450656,168.7878268755025,170.89957190600995,172.86560600401586,174.70000600669368,176.41595505502366],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[5.9182619785634],"y":[139.27328932275273],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,5.9182619785634,5.9182619785634],"y":[139.27328932275273,139.27328932275273,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7298a775-c056-4055-97db-2e3473df052a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We evaluate the performance of the method on the testing data using MSE and MAPE.</p>
<div id="265d4387" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_percentage_error</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span> gc1_fit.predict(X_test1)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test1, y_pred1))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test1, y_pred1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.13639409238371467
77.10625607904514</code></pre>
</div>
</div>
<p>Let’s look at <code>qq-plot</code> of the predictions and the actual response values using <code>draw_learning_curve()</code> method.</p>
<div id="3d027242" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gc1_fit.draw_learning_curve(y_test<span class="op">=</span>y_test1, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="460173ad-bbd0-4e7a-b006-305ec8b7a20e" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("460173ad-bbd0-4e7a-b006-305ec8b7a20e")) {                    Plotly.newPlot(                        "460173ad-bbd0-4e7a-b006-305ec8b7a20e",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[161.98453107884856,-19.642349269977295,-70.95866830925688,-513.4305734686125,376.28901860417153,246.37746561050812,-75.07386286610365,27.72851717198693,-377.5871701553596,257.07760738495716,-122.96653785645215,-65.16082651128357,141.64132959359938,124.29738166400664,5.777095381823217,-65.51830572682393,403.2697855473508,-205.21462081728262,-221.0733944186946,-26.232642594438584,14.306469272282222,-153.5254858037562,92.90687105481358,285.58784629402896,525.2414942043629,16.509009147223722,-205.32244172993717,-298.4582437257728,135.7522949692444,-50.55476158988831,35.21179579116764,100.2896775329707,82.57257416156118,12.923643858857465,64.78011763663359,11.886937752259612,78.79930716473848,425.6330049917283,-135.95283500593598,25.959455879977053,-205.75379843342523,-275.6566410232009,225.4827531553518,-216.09980989650035,-205.66955748340908,-102.88128419077319,116.48203868407265,-11.504643614922662,122.58350765922881,-41.181802332417504,-156.0997066428271,-76.98647827237602,-82.98144886670083,-303.2444073598339,125.39946333906936,-127.01372084128863,-233.4358178876751,88.79478528614386,-34.33650706970383,-125.99490390797388,135.46365296759188,84.8710272249636,-254.58320040146964,124.54588867759023,437.6212007426331,198.2666838237279,-43.16534770264567,74.18975464544599,-341.0698854299217,-239.5683818314627,45.82237301412757,328.9108084029359,-208.21958575944205,173.31161311069033,-21.442500465320492,200.0771504324218,421.55442398488293,-261.6311935113137,12.967447585826198,33.53833683216276,-50.908480961671,18.08366414004453,60.663718323761465,-39.682930587251754,7.5178003339962,-69.40539209827006,115.83025936861547,-248.0245187928838,170.47123403723793,-4.066582640436843,59.587021557586155,264.31498566520236,48.187123408443796,145.1459043210139,-72.14870832027417,288.0066106822105,263.694922356605,-97.64295266659886,149.85627359446102,-134.81475933503916,178.0613249966957,-104.13411744700642,214.12866198603467,71.43398163596123,120.80615968520347,-272.38870145379155,-126.8592297533438,-109.84920381071603,-92.291147798096,125.802168120044,-332.2062983548123,67.95417598465178,-320.3353362207183,-191.92508445746128,0.5011367769558759,-66.14042040825652,327.40014437953505,6.3488855238395026,43.7184397456342,-319.51767955786244,-7.120286864731714,-7.83864221220574,-190.79404676414376,-125.8008346580403,-420.44062057917563,232.61435721767617,-95.86700296119362,-58.55134609477088,169.45450213474956,76.12337300469821,-278.24301894768047,325.98457969646995,-165.95845711207895,-28.916090963966994,47.94255936775441,70.5790446903269,-228.06969066419651,42.28385226762858,186.39042722720137,-55.651214565932975,43.62148420219755,-199.38296762087543,487.04348332171236,39.63426037055296,-153.07435358723149,-66.93890019801692,296.09717314247933,10.257325753486073,-62.59988906676405,14.985251916691658,409.778429138855,324.7711799846804,125.09633015031004,69.17591007178402,-100.24249587537116,314.83982590228356,-153.0633083326136,192.08695969655204,-123.47610082698444,-25.51945987839035,-245.9124716033357,109.30525591506718,-15.39677629540945,-105.68664132821335,110.32664881080979,-110.09287602692817,-99.6464403435494,78.76746939563996,103.64712185842356,250.29547755996856,323.55735622697983,-28.673121228135038,-204.13842273349525,-53.1643012948656,-122.13006971839224,134.1244588761993,-93.74922598810781,-98.99125019110352,542.9754049177257,256.96999988233813,31.988684382285054,-168.95495991536737,-127.71446802629504,404.14922599578654,-232.65480640197248,-26.534330438614006,-24.776003333978327,78.78529812693371,74.35365552751122,210.11141784727945,-225.73711205625978,19.960375538724243,62.08908938811858,60.3372094515358,110.25224027969907,-223.4856107768001,-174.1810081234299,53.903445955362166,-108.06101177605987,217.7362579175546],"xaxis":"x","y":[161.98453107884856,-19.642349269977295,-70.95866830925688,-513.4305734686125,376.28901860417153,246.37746561050812,-75.07386286610365,27.72851717198693,-377.5871701553596,257.07760738495716,-122.96653785645215,-65.16082651128357,141.64132959359938,124.29738166400664,5.777095381823217,-65.51830572682393,403.2697855473508,-205.21462081728262,-221.0733944186946,-26.232642594438584,14.306469272282222,-153.5254858037562,92.90687105481358,285.58784629402896,525.2414942043629,16.509009147223722,-205.32244172993717,-298.4582437257728,135.7522949692444,-50.55476158988831,35.21179579116764,100.2896775329707,82.57257416156118,12.923643858857465,64.78011763663359,11.886937752259612,78.79930716473848,425.6330049917283,-135.95283500593598,25.959455879977053,-205.75379843342523,-275.6566410232009,225.4827531553518,-216.09980989650035,-205.66955748340908,-102.88128419077319,116.48203868407265,-11.504643614922662,122.58350765922881,-41.181802332417504,-156.0997066428271,-76.98647827237602,-82.98144886670083,-303.2444073598339,125.39946333906936,-127.01372084128863,-233.4358178876751,88.79478528614386,-34.33650706970383,-125.99490390797388,135.46365296759188,84.8710272249636,-254.58320040146964,124.54588867759023,437.6212007426331,198.2666838237279,-43.16534770264567,74.18975464544599,-341.0698854299217,-239.5683818314627,45.82237301412757,328.9108084029359,-208.21958575944205,173.31161311069033,-21.442500465320492,200.0771504324218,421.55442398488293,-261.6311935113137,12.967447585826198,33.53833683216276,-50.908480961671,18.08366414004453,60.663718323761465,-39.682930587251754,7.5178003339962,-69.40539209827006,115.83025936861547,-248.0245187928838,170.47123403723793,-4.066582640436843,59.587021557586155,264.31498566520236,48.187123408443796,145.1459043210139,-72.14870832027417,288.0066106822105,263.694922356605,-97.64295266659886,149.85627359446102,-134.81475933503916,178.0613249966957,-104.13411744700642,214.12866198603467,71.43398163596123,120.80615968520347,-272.38870145379155,-126.8592297533438,-109.84920381071603,-92.291147798096,125.802168120044,-332.2062983548123,67.95417598465178,-320.3353362207183,-191.92508445746128,0.5011367769558759,-66.14042040825652,327.40014437953505,6.3488855238395026,43.7184397456342,-319.51767955786244,-7.120286864731714,-7.83864221220574,-190.79404676414376,-125.8008346580403,-420.44062057917563,232.61435721767617,-95.86700296119362,-58.55134609477088,169.45450213474956,76.12337300469821,-278.24301894768047,325.98457969646995,-165.95845711207895,-28.916090963966994,47.94255936775441,70.5790446903269,-228.06969066419651,42.28385226762858,186.39042722720137,-55.651214565932975,43.62148420219755,-199.38296762087543,487.04348332171236,39.63426037055296,-153.07435358723149,-66.93890019801692,296.09717314247933,10.257325753486073,-62.59988906676405,14.985251916691658,409.778429138855,324.7711799846804,125.09633015031004,69.17591007178402,-100.24249587537116,314.83982590228356,-153.0633083326136,192.08695969655204,-123.47610082698444,-25.51945987839035,-245.9124716033357,109.30525591506718,-15.39677629540945,-105.68664132821335,110.32664881080979,-110.09287602692817,-99.6464403435494,78.76746939563996,103.64712185842356,250.29547755996856,323.55735622697983,-28.673121228135038,-204.13842273349525,-53.1643012948656,-122.13006971839224,134.1244588761993,-93.74922598810781,-98.99125019110352,542.9754049177257,256.96999988233813,31.988684382285054,-168.95495991536737,-127.71446802629504,404.14922599578654,-232.65480640197248,-26.534330438614006,-24.776003333978327,78.78529812693371,74.35365552751122,210.11141784727945,-225.73711205625978,19.960375538724243,62.08908938811858,60.3372094515358,110.25224027969907,-223.4856107768001,-174.1810081234299,53.903445955362166,-108.06101177605987,217.7362579175546],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[158.34062971643286,-16.362499308662123,-77.57279829240133,-527.2089852996343,378.99347956299187,238.0200453214047,-74.13362098886853,21.94914738845694,-364.34414846197797,255.7357418604004,-144.52629544687122,-65.5437819254388,139.68095512775872,123.01206193346106,9.641138257004268,-60.10950402727029,389.7825982177906,-177.45043983519906,-205.68147806567663,-26.869399180235725,13.660974937994224,-151.00255009032628,93.48097501541855,279.33906774324254,523.7388456634707,16.254227545832645,-225.99614733358015,-290.31840482907,136.50879322632142,-44.15082018559245,33.09952077536764,102.0204256840212,83.59053704731957,19.73588562911082,69.85363538176023,15.105191220732486,77.23571532969612,427.163738050027,-128.54566761056716,24.537901390346263,-209.65211764966122,-260.4394451987763,223.14263253273222,-213.6681928223908,-203.8581678326891,-99.0909177177465,121.63151183139846,-13.206234206354607,121.33978752055991,-40.99471491717208,-148.4471700858109,-71.01553917565028,-80.97642084756514,-290.60826136211017,124.78367051494085,-116.33153000374315,-225.22076494667334,89.98748924301292,-25.002767307399726,-121.40109689726226,140.82468263354653,90.06474226594459,-236.75141795265478,120.34942059891875,436.5264997171194,195.31975165452198,-52.7526442436727,68.21258343127762,-340.3538828315752,-232.8471151618083,59.516498345944875,325.590368666193,-204.81901702239819,165.89879081784267,-19.748478785412875,198.58361072643277,418.4849591263975,-254.00990480797304,11.117360609950785,35.09150252416815,-48.5190685708054,19.035416992089147,55.89764345231926,-29.47281749890163,-4.99333781268017,-66.14817024572241,119.83868329668859,-240.7243977678544,162.23725961777535,3.3616125846563354,63.85153901975673,246.43013721115636,45.973131035074594,150.33933283070488,-69.47294379142635,296.30543320787325,271.2537536071656,-92.89630974211207,145.55042001898755,-139.42572034944507,174.87789981118843,-101.79178623305197,200.3397684782851,91.32331245812178,118.40049222685099,-261.9853643388537,-117.20135057806368,-112.61302895150497,-97.61662138660341,124.5577768408015,-331.16402065573607,56.823648598726955,-327.43020320231125,-196.72653079133747,-3.047214754245974,-69.38909262717584,325.2483982167575,10.959077502338605,22.80057849436045,-344.32661517309253,7.923884466402969,-2.540204731708352,-194.48809764797065,-123.05039269191087,-439.94852306924173,225.2043391170755,-98.91005619833625,-64.76378698029316,167.6472496017593,72.78891969134499,-262.99112009876734,317.0179101806249,-175.96986791674053,-27.278059451231215,67.79689244248509,58.759840094442566,-232.63472946671828,29.581735809701826,186.0237188545601,-35.24559546743172,46.030479719948644,-191.57090939964573,452.4738511871424,28.43967971452475,-162.54696359481872,-69.34082738726416,304.3527702380141,10.339828287226588,-58.66111306084623,18.87309399660992,383.56508588418103,325.5271902460921,124.2203296045146,70.16795125379814,-94.12869827967427,316.76868188292843,-146.9101246238146,187.54237838099525,-119.66022952174245,-24.45314274830583,-240.66507053361227,86.9865498700569,-18.75643566638078,-101.52588748337936,111.1062814408311,-101.84269772805165,-93.7969001311174,61.79922671945579,97.8263740745883,262.37714747706974,322.2190331416031,-23.07791273764269,-203.62236500179083,-56.01408380693565,-114.55279229239746,129.3905195191652,-91.85029414476374,-100.25878974195165,565.0212533288459,241.99569449381983,34.38800252556488,-169.7992411396724,-117.03942351865138,384.2267612014209,-228.92651567434947,-29.165373561069334,-23.616398574276598,73.86247452528929,74.28656596258583,205.07315431929888,-221.12793383095138,19.22311068872631,57.365139216965645,62.21451256698241,112.4351496286946,-214.65895501367032,-176.88549884652352,55.95153411730991,-103.10088052290763,212.34101875569118],"xaxis":"x","y":[161.98453107884856,-19.642349269977295,-70.95866830925688,-513.4305734686125,376.28901860417153,246.37746561050812,-75.07386286610365,27.72851717198693,-377.5871701553596,257.07760738495716,-122.96653785645215,-65.16082651128357,141.64132959359938,124.29738166400664,5.777095381823217,-65.51830572682393,403.2697855473508,-205.21462081728262,-221.0733944186946,-26.232642594438584,14.306469272282222,-153.5254858037562,92.90687105481358,285.58784629402896,525.2414942043629,16.509009147223722,-205.32244172993717,-298.4582437257728,135.7522949692444,-50.55476158988831,35.21179579116764,100.2896775329707,82.57257416156118,12.923643858857465,64.78011763663359,11.886937752259612,78.79930716473848,425.6330049917283,-135.95283500593598,25.959455879977053,-205.75379843342523,-275.6566410232009,225.4827531553518,-216.09980989650035,-205.66955748340908,-102.88128419077319,116.48203868407265,-11.504643614922662,122.58350765922881,-41.181802332417504,-156.0997066428271,-76.98647827237602,-82.98144886670083,-303.2444073598339,125.39946333906936,-127.01372084128863,-233.4358178876751,88.79478528614386,-34.33650706970383,-125.99490390797388,135.46365296759188,84.8710272249636,-254.58320040146964,124.54588867759023,437.6212007426331,198.2666838237279,-43.16534770264567,74.18975464544599,-341.0698854299217,-239.5683818314627,45.82237301412757,328.9108084029359,-208.21958575944205,173.31161311069033,-21.442500465320492,200.0771504324218,421.55442398488293,-261.6311935113137,12.967447585826198,33.53833683216276,-50.908480961671,18.08366414004453,60.663718323761465,-39.682930587251754,7.5178003339962,-69.40539209827006,115.83025936861547,-248.0245187928838,170.47123403723793,-4.066582640436843,59.587021557586155,264.31498566520236,48.187123408443796,145.1459043210139,-72.14870832027417,288.0066106822105,263.694922356605,-97.64295266659886,149.85627359446102,-134.81475933503916,178.0613249966957,-104.13411744700642,214.12866198603467,71.43398163596123,120.80615968520347,-272.38870145379155,-126.8592297533438,-109.84920381071603,-92.291147798096,125.802168120044,-332.2062983548123,67.95417598465178,-320.3353362207183,-191.92508445746128,0.5011367769558759,-66.14042040825652,327.40014437953505,6.3488855238395026,43.7184397456342,-319.51767955786244,-7.120286864731714,-7.83864221220574,-190.79404676414376,-125.8008346580403,-420.44062057917563,232.61435721767617,-95.86700296119362,-58.55134609477088,169.45450213474956,76.12337300469821,-278.24301894768047,325.98457969646995,-165.95845711207895,-28.916090963966994,47.94255936775441,70.5790446903269,-228.06969066419651,42.28385226762858,186.39042722720137,-55.651214565932975,43.62148420219755,-199.38296762087543,487.04348332171236,39.63426037055296,-153.07435358723149,-66.93890019801692,296.09717314247933,10.257325753486073,-62.59988906676405,14.985251916691658,409.778429138855,324.7711799846804,125.09633015031004,69.17591007178402,-100.24249587537116,314.83982590228356,-153.0633083326136,192.08695969655204,-123.47610082698444,-25.51945987839035,-245.9124716033357,109.30525591506718,-15.39677629540945,-105.68664132821335,110.32664881080979,-110.09287602692817,-99.6464403435494,78.76746939563996,103.64712185842356,250.29547755996856,323.55735622697983,-28.673121228135038,-204.13842273349525,-53.1643012948656,-122.13006971839224,134.1244588761993,-93.74922598810781,-98.99125019110352,542.9754049177257,256.96999988233813,31.988684382285054,-168.95495991536737,-127.71446802629504,404.14922599578654,-232.65480640197248,-26.534330438614006,-24.776003333978327,78.78529812693371,74.35365552751122,210.11141784727945,-225.73711205625978,19.960375538724243,62.08908938811858,60.3372094515358,110.25224027969907,-223.4856107768001,-174.1810081234299,53.903445955362166,-108.06101177605987,217.7362579175546],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('460173ad-bbd0-4e7a-b006-305ec8b7a20e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<hr>
</section>
<section id="bullet-gradientcobra-with-non-default-parameters" class="level4">
<h4 class="anchored" data-anchor-id="bullet-gradientcobra-with-non-default-parameters"><span class="math inline">\(\bullet\)</span> <code>GradientCOBRA</code> with non-default parameters</h4>
<p>We create another object <code>gc2</code> with non-default parameters, then fit it to the same training data as in the previous example.</p>
<div id="dc448878" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gc2 <span class="op">=</span> GradientCOBRA(learning_rate<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                    opt_method<span class="op">=</span><span class="st">'grad'</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                    loss_function<span class="op">=</span><span class="st">"weighted_mse"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                    max_iter<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                    estimator_list<span class="op">=</span>[<span class="st">'random_forest'</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'adaboost'</span>, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'knn'</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'lasso'</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'ridge'</span>],</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                    estimator_params<span class="op">=</span>{</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'random_forest'</span> : {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'n_estimators'</span> : <span class="dv">300</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'min_samples_leaf'</span> : <span class="dv">5</span>},</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'adaboost'</span> : {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'n_estimators'</span> : <span class="dv">300</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'max_depth'</span> : <span class="dv">5</span>},</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'knn'</span> : {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'n_neighbors'</span> : <span class="dv">10</span>}</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>gc2_fit <span class="op">=</span> gc2.fit(X_train1, y_train1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: -7.017 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 3.010 / grad: -7.017 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.010 / grad: -9.084 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 3.010 / grad: -9.084 / stop criter: 7.017 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.023 / grad: -42.455 / stop criter: 9.084 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 3.023 / grad: -42.455 / stop criter: 9.084 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 3.083 / grad: -33.491 / stop criter: 42.455 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 3.083 / grad: -33.491 / stop criter: 42.455 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 3.131 / grad: -5.657 / stop criter: 33.491 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 8 / bw: 3.131 / grad: -5.657 / stop criter: 33.491 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 3.139 / grad: -13.805 / stop criter: 5.657 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 9 / bw: 3.139 / grad: -13.805 / stop criter: 5.657 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 3.159 / grad: -11.947 / stop criter: 13.805 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 10 / bw: 3.159 / grad: -11.947 / stop criter: 13.805 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 11 / bw: 3.176 / grad: 27.805 / stop criter: 11.947 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 11 / bw: 3.176 / grad: 27.805 / stop criter: 11.947 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 11 / bw: 3.176 / grad: 27.805 / stop criter: 11.947 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 12 / bw: 3.136 / grad: -6.482 / stop criter: 27.805 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 12 / bw: 3.136 / grad: -6.482 / stop criter: 27.805 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 13 / bw: 3.145 / grad: 20.481 / stop criter: 6.482 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s] * GD progress: iter: 13 / bw: 3.145 / grad: 20.481 / stop criter: 6.482 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 14 / bw: 3.117 / grad: -0.323 / stop criter: 20.481 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 14 / bw: 3.117 / grad: -0.323 / stop criter: 20.481 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 15 / bw: 3.117 / grad: 28.905 / stop criter: 0.323 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s] * GD progress: iter: 15 / bw: 3.117 / grad: 28.905 / stop criter: 0.323 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 16 / bw: 3.078 / grad: 23.724 / stop criter: 28.905 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 16 / bw: 3.078 / grad: 23.724 / stop criter: 28.905 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 17 / bw: 3.046 / grad: -4.997 / stop criter: 23.724 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 17 / bw: 3.046 / grad: -4.997 / stop criter: 23.724 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 18 / bw: 3.052 / grad: 28.048 / stop criter: 4.997 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s] * GD progress: iter: 18 / bw: 3.052 / grad: 28.048 / stop criter: 4.997 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 19 / bw: 3.015 / grad: 0.859 / stop criter: 28.048 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 19 / bw: 3.015 / grad: 0.859 / stop criter: 28.048 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 20 / bw: 3.014 / grad: -39.115 / stop criter: 0.859 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 20 / bw: 3.014 / grad: -39.115 / stop criter: 0.859 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 21 / bw: 3.066 / grad: 30.672 / stop criter: 39.115 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 21 / bw: 3.066 / grad: 30.672 / stop criter: 39.115 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 22 / bw: 3.025 / grad: 29.997 / stop criter: 30.672 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 22 / bw: 3.025 / grad: 29.997 / stop criter: 30.672 :   4%|▎         | 11/300 [00:00&lt;00:02, 100.01it/s]* GD progress: iter: 22 / bw: 3.025 / grad: 29.997 / stop criter: 30.672 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 23 / bw: 2.986 / grad: -30.430 / stop criter: 29.997 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 23 / bw: 2.986 / grad: -30.430 / stop criter: 29.997 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 24 / bw: 3.026 / grad: 25.623 / stop criter: 30.430 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s] * GD progress: iter: 24 / bw: 3.026 / grad: 25.623 / stop criter: 30.430 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 25 / bw: 2.993 / grad: -3.610 / stop criter: 25.623 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 25 / bw: 2.993 / grad: -3.610 / stop criter: 25.623 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 26 / bw: 2.997 / grad: -4.356 / stop criter: 3.610 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s] * GD progress: iter: 26 / bw: 2.997 / grad: -4.356 / stop criter: 3.610 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 27 / bw: 3.003 / grad: -5.057 / stop criter: 4.356 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 27 / bw: 3.003 / grad: -5.057 / stop criter: 4.356 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 28 / bw: 3.009 / grad: -41.575 / stop criter: 5.057 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 28 / bw: 3.009 / grad: -41.575 / stop criter: 5.057 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 29 / bw: 3.062 / grad: -2.358 / stop criter: 41.575 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 29 / bw: 3.062 / grad: -2.358 / stop criter: 41.575 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 30 / bw: 3.065 / grad: -0.162 / stop criter: 2.358 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s] * GD progress: iter: 30 / bw: 3.065 / grad: -0.162 / stop criter: 2.358 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 31 / bw: 3.065 / grad: -8.812 / stop criter: 0.162 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 31 / bw: 3.065 / grad: -8.812 / stop criter: 0.162 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 32 / bw: 3.076 / grad: -10.666 / stop criter: 8.812 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 32 / bw: 3.076 / grad: -10.666 / stop criter: 8.812 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 33 / bw: 3.090 / grad: 0.177 / stop criter: 10.666 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s] * GD progress: iter: 33 / bw: 3.090 / grad: 0.177 / stop criter: 10.666 :   7%|▋         | 22/300 [00:00&lt;00:02, 102.29it/s]* GD progress: iter: 33 / bw: 3.090 / grad: 0.177 / stop criter: 10.666 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 34 / bw: 3.089 / grad: 28.312 / stop criter: 0.177 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 34 / bw: 3.089 / grad: 28.312 / stop criter: 0.177 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 35 / bw: 3.054 / grad: -6.119 / stop criter: 28.312 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 35 / bw: 3.054 / grad: -6.119 / stop criter: 28.312 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 36 / bw: 3.062 / grad: -15.112 / stop criter: 6.119 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 36 / bw: 3.062 / grad: -15.112 / stop criter: 6.119 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 37 / bw: 3.080 / grad: -8.363 / stop criter: 15.112 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 37 / bw: 3.080 / grad: -8.363 / stop criter: 15.112 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 38 / bw: 3.091 / grad: 3.158 / stop criter: 8.363 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]  * GD progress: iter: 38 / bw: 3.091 / grad: 3.158 / stop criter: 8.363 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 39 / bw: 3.087 / grad: 2.412 / stop criter: 3.158 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 39 / bw: 3.087 / grad: 2.412 / stop criter: 3.158 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 40 / bw: 3.084 / grad: -2.519 / stop criter: 2.412 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 40 / bw: 3.084 / grad: -2.519 / stop criter: 2.412 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 41 / bw: 3.087 / grad: -39.742 / stop criter: 2.519 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 41 / bw: 3.087 / grad: -39.742 / stop criter: 2.519 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 42 / bw: 3.135 / grad: -8.270 / stop criter: 39.742 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 42 / bw: 3.135 / grad: -8.270 / stop criter: 39.742 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 43 / bw: 3.145 / grad: -25.263 / stop criter: 8.270 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 43 / bw: 3.145 / grad: -25.263 / stop criter: 8.270 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 44 / bw: 3.176 / grad: 8.485 / stop criter: 25.263 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s] * GD progress: iter: 44 / bw: 3.176 / grad: 8.485 / stop criter: 25.263 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 45 / bw: 3.165 / grad: -20.039 / stop criter: 8.485 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 45 / bw: 3.165 / grad: -20.039 / stop criter: 8.485 :  11%|█         | 33/300 [00:00&lt;00:02, 105.48it/s]* GD progress: iter: 45 / bw: 3.165 / grad: -20.039 / stop criter: 8.485 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 46 / bw: 3.190 / grad: -8.670 / stop criter: 20.039 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 46 / bw: 3.190 / grad: -8.670 / stop criter: 20.039 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 47 / bw: 3.200 / grad: -6.997 / stop criter: 8.670 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s] * GD progress: iter: 47 / bw: 3.200 / grad: -6.997 / stop criter: 8.670 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 48 / bw: 3.208 / grad: -21.076 / stop criter: 6.997 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 48 / bw: 3.208 / grad: -21.076 / stop criter: 6.997 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 49 / bw: 3.233 / grad: -3.583 / stop criter: 21.076 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 49 / bw: 3.233 / grad: -3.583 / stop criter: 21.076 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 50 / bw: 3.237 / grad: -23.114 / stop criter: 3.583 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 50 / bw: 3.237 / grad: -23.114 / stop criter: 3.583 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 51 / bw: 3.265 / grad: -5.918 / stop criter: 23.114 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 51 / bw: 3.265 / grad: -5.918 / stop criter: 23.114 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 52 / bw: 3.272 / grad: -31.179 / stop criter: 5.918 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 52 / bw: 3.272 / grad: -31.179 / stop criter: 5.918 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 53 / bw: 3.309 / grad: -5.204 / stop criter: 31.179 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 53 / bw: 3.309 / grad: -5.204 / stop criter: 31.179 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 54 / bw: 3.315 / grad: 28.047 / stop criter: 5.204 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s] * GD progress: iter: 54 / bw: 3.315 / grad: 28.047 / stop criter: 5.204 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 55 / bw: 3.282 / grad: -25.611 / stop criter: 28.047 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 55 / bw: 3.282 / grad: -25.611 / stop criter: 28.047 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 56 / bw: 3.312 / grad: -14.387 / stop criter: 25.611 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 56 / bw: 3.312 / grad: -14.387 / stop criter: 25.611 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 57 / bw: 3.329 / grad: 10.252 / stop criter: 14.387 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s] * GD progress: iter: 57 / bw: 3.329 / grad: 10.252 / stop criter: 14.387 :  15%|█▌        | 45/300 [00:00&lt;00:02, 104.29it/s]* GD progress: iter: 57 / bw: 3.329 / grad: 10.252 / stop criter: 14.387 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 58 / bw: 3.317 / grad: 18.526 / stop criter: 10.252 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 58 / bw: 3.317 / grad: 18.526 / stop criter: 10.252 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 59 / bw: 3.296 / grad: 2.517 / stop criter: 18.526 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s] * GD progress: iter: 59 / bw: 3.296 / grad: 2.517 / stop criter: 18.526 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 60 / bw: 3.293 / grad: -21.964 / stop criter: 2.517 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 60 / bw: 3.293 / grad: -21.964 / stop criter: 2.517 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 61 / bw: 3.318 / grad: -2.948 / stop criter: 21.964 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 61 / bw: 3.318 / grad: -2.948 / stop criter: 21.964 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 62 / bw: 3.321 / grad: -34.176 / stop criter: 2.948 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 62 / bw: 3.321 / grad: -34.176 / stop criter: 2.948 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 63 / bw: 3.360 / grad: -14.301 / stop criter: 34.176 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 63 / bw: 3.360 / grad: -14.301 / stop criter: 34.176 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 64 / bw: 3.377 / grad: 9.090 / stop criter: 14.301 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]  * GD progress: iter: 64 / bw: 3.377 / grad: 9.090 / stop criter: 14.301 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 65 / bw: 3.366 / grad: -46.398 / stop criter: 9.090 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 65 / bw: 3.366 / grad: -46.398 / stop criter: 9.090 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 66 / bw: 3.419 / grad: 14.528 / stop criter: 46.398 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 66 / bw: 3.419 / grad: 14.528 / stop criter: 46.398 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 67 / bw: 3.403 / grad: 17.132 / stop criter: 14.528 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 67 / bw: 3.403 / grad: 17.132 / stop criter: 14.528 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 68 / bw: 3.384 / grad: 6.730 / stop criter: 17.132 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s] * GD progress: iter: 68 / bw: 3.384 / grad: 6.730 / stop criter: 17.132 :  19%|█▉        | 57/300 [00:00&lt;00:02, 103.65it/s]* GD progress: iter: 68 / bw: 3.384 / grad: 6.730 / stop criter: 17.132 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 69 / bw: 3.376 / grad: 19.486 / stop criter: 6.730 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 69 / bw: 3.376 / grad: 19.486 / stop criter: 6.730 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 70 / bw: 3.354 / grad: 9.439 / stop criter: 19.486 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 70 / bw: 3.354 / grad: 9.439 / stop criter: 19.486 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 71 / bw: 3.344 / grad: -33.204 / stop criter: 9.439 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 71 / bw: 3.344 / grad: -33.204 / stop criter: 9.439 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 72 / bw: 3.381 / grad: 8.229 / stop criter: 33.204 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s] * GD progress: iter: 72 / bw: 3.381 / grad: 8.229 / stop criter: 33.204 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 73 / bw: 3.372 / grad: -32.752 / stop criter: 8.229 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 73 / bw: 3.372 / grad: -32.752 / stop criter: 8.229 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 74 / bw: 3.407 / grad: -6.111 / stop criter: 32.752 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 74 / bw: 3.407 / grad: -6.111 / stop criter: 32.752 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 75 / bw: 3.414 / grad: -8.402 / stop criter: 6.111 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s] * GD progress: iter: 75 / bw: 3.414 / grad: -8.402 / stop criter: 6.111 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 76 / bw: 3.423 / grad: -8.667 / stop criter: 8.402 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 76 / bw: 3.423 / grad: -8.667 / stop criter: 8.402 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 77 / bw: 3.432 / grad: 6.062 / stop criter: 8.667 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s] * GD progress: iter: 77 / bw: 3.432 / grad: 6.062 / stop criter: 8.667 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 78 / bw: 3.426 / grad: -11.075 / stop criter: 6.062 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 78 / bw: 3.426 / grad: -11.075 / stop criter: 6.062 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 79 / bw: 3.438 / grad: -24.418 / stop criter: 11.075 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 79 / bw: 3.438 / grad: -24.418 / stop criter: 11.075 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 80 / bw: 3.463 / grad: 13.203 / stop criter: 24.418 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s] * GD progress: iter: 80 / bw: 3.463 / grad: 13.203 / stop criter: 24.418 :  23%|██▎       | 68/300 [00:00&lt;00:02, 105.45it/s]* GD progress: iter: 80 / bw: 3.463 / grad: 13.203 / stop criter: 24.418 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 81 / bw: 3.449 / grad: 20.319 / stop criter: 13.203 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 81 / bw: 3.449 / grad: 20.319 / stop criter: 13.203 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 82 / bw: 3.428 / grad: -30.161 / stop criter: 20.319 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 82 / bw: 3.428 / grad: -30.161 / stop criter: 20.319 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 83 / bw: 3.460 / grad: -6.248 / stop criter: 30.161 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s] * GD progress: iter: 83 / bw: 3.460 / grad: -6.248 / stop criter: 30.161 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 84 / bw: 3.466 / grad: -10.664 / stop criter: 6.248 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 84 / bw: 3.466 / grad: -10.664 / stop criter: 6.248 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 85 / bw: 3.477 / grad: 9.916 / stop criter: 10.664 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s] * GD progress: iter: 85 / bw: 3.477 / grad: 9.916 / stop criter: 10.664 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 86 / bw: 3.467 / grad: 20.695 / stop criter: 9.916 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 86 / bw: 3.467 / grad: 20.695 / stop criter: 9.916 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 87 / bw: 3.446 / grad: 43.095 / stop criter: 20.695 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 87 / bw: 3.446 / grad: 43.095 / stop criter: 20.695 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 88 / bw: 3.402 / grad: 16.572 / stop criter: 43.095 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 88 / bw: 3.402 / grad: 16.572 / stop criter: 43.095 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 89 / bw: 3.385 / grad: 12.916 / stop criter: 16.572 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 89 / bw: 3.385 / grad: 12.916 / stop criter: 16.572 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 90 / bw: 3.371 / grad: 14.709 / stop criter: 12.916 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 90 / bw: 3.371 / grad: 14.709 / stop criter: 12.916 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 91 / bw: 3.356 / grad: 31.404 / stop criter: 14.709 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 91 / bw: 3.356 / grad: 31.404 / stop criter: 14.709 :  27%|██▋       | 80/300 [00:00&lt;00:02, 104.51it/s]* GD progress: iter: 91 / bw: 3.356 / grad: 31.404 / stop criter: 14.709 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 92 / bw: 3.324 / grad: -3.768 / stop criter: 31.404 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 92 / bw: 3.324 / grad: -3.768 / stop criter: 31.404 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 93 / bw: 3.328 / grad: 20.555 / stop criter: 3.768 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s] * GD progress: iter: 93 / bw: 3.328 / grad: 20.555 / stop criter: 3.768 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 94 / bw: 3.307 / grad: -49.996 / stop criter: 20.555 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 94 / bw: 3.307 / grad: -49.996 / stop criter: 20.555 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 95 / bw: 3.357 / grad: 12.857 / stop criter: 49.996 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s] * GD progress: iter: 95 / bw: 3.357 / grad: 12.857 / stop criter: 49.996 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 96 / bw: 3.345 / grad: -11.207 / stop criter: 12.857 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 96 / bw: 3.345 / grad: -11.207 / stop criter: 12.857 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 97 / bw: 3.356 / grad: 23.186 / stop criter: 11.207 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s] * GD progress: iter: 97 / bw: 3.356 / grad: 23.186 / stop criter: 11.207 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 98 / bw: 3.333 / grad: -5.652 / stop criter: 23.186 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 98 / bw: 3.333 / grad: -5.652 / stop criter: 23.186 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 99 / bw: 3.339 / grad: 36.205 / stop criter: 5.652 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s] * GD progress: iter: 99 / bw: 3.339 / grad: 36.205 / stop criter: 5.652 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 100 / bw: 3.304 / grad: 57.925 / stop criter: 36.205 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 100 / bw: 3.304 / grad: 57.925 / stop criter: 36.205 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 101 / bw: 3.249 / grad: -22.059 / stop criter: 57.925 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 101 / bw: 3.249 / grad: -22.059 / stop criter: 57.925 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 102 / bw: 3.270 / grad: 13.486 / stop criter: 22.059 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s] * GD progress: iter: 102 / bw: 3.270 / grad: 13.486 / stop criter: 22.059 :  30%|███       | 91/300 [00:00&lt;00:01, 105.97it/s]* GD progress: iter: 102 / bw: 3.270 / grad: 13.486 / stop criter: 22.059 :  34%|███▍      | 102/300 [00:00&lt;00:01, 104.50it/s]* GD progress: iter: 103 / bw: 3.258 / grad: 8.508 / stop criter: 13.486 :  34%|███▍      | 102/300 [00:00&lt;00:01, 104.50it/s] * GD progress: iter: 103 / bw: 3.258 / grad: 8.508 / stop criter: 13.486 :  34%|███▍      | 102/300 [00:00&lt;00:01, 104.50it/s]* GD progress: iter: 104 / bw: 3.250 / grad: -45.509 / stop criter: 8.508 :  34%|███▍      | 102/300 [00:00&lt;00:01, 104.50it/s]* GD progress: iter: 104 / bw: 3.250 / grad: -45.509 / stop criter: 8.508 :  34%|███▍      | 102/300 [00:00&lt;00:01, 104.50it/s]* GD progress: iter: 105 / bw: 3.292 / grad: 12.331 / stop criter: 45.509 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 105 / bw: 3.292 / grad: 12.331 / stop criter: 45.509 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 106 / bw: 3.281 / grad: 13.146 / stop criter: 12.331 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 106 / bw: 3.281 / grad: 13.146 / stop criter: 12.331 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 107 / bw: 3.269 / grad: 11.597 / stop criter: 13.146 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 107 / bw: 3.269 / grad: 11.597 / stop criter: 13.146 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 108 / bw: 3.258 / grad: 16.450 / stop criter: 11.597 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 108 / bw: 3.258 / grad: 16.450 / stop criter: 11.597 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 109 / bw: 3.243 / grad: 17.020 / stop criter: 16.450 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 109 / bw: 3.243 / grad: 17.020 / stop criter: 16.450 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 110 / bw: 3.228 / grad: 20.469 / stop criter: 17.020 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 110 / bw: 3.228 / grad: 20.469 / stop criter: 17.020 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 111 / bw: 3.209 / grad: 20.619 / stop criter: 20.469 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 111 / bw: 3.209 / grad: 20.619 / stop criter: 20.469 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 112 / bw: 3.191 / grad: -0.731 / stop criter: 20.619 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 112 / bw: 3.191 / grad: -0.731 / stop criter: 20.619 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 113 / bw: 3.191 / grad: 10.937 / stop criter: 0.731 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s] * GD progress: iter: 113 / bw: 3.191 / grad: 10.937 / stop criter: 0.731 :  34%|███▍      | 102/300 [00:01&lt;00:01, 104.50it/s]* GD progress: iter: 113 / bw: 3.191 / grad: 10.937 / stop criter: 0.731 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 114 / bw: 3.181 / grad: 13.007 / stop criter: 10.937 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 114 / bw: 3.181 / grad: 13.007 / stop criter: 10.937 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 115 / bw: 3.170 / grad: -4.850 / stop criter: 13.007 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 115 / bw: 3.170 / grad: -4.850 / stop criter: 13.007 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 116 / bw: 3.174 / grad: 18.558 / stop criter: 4.850 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s] * GD progress: iter: 116 / bw: 3.174 / grad: 18.558 / stop criter: 4.850 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 117 / bw: 3.158 / grad: 14.681 / stop criter: 18.558 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 117 / bw: 3.158 / grad: 14.681 / stop criter: 18.558 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 118 / bw: 3.145 / grad: 28.390 / stop criter: 14.681 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 118 / bw: 3.145 / grad: 28.390 / stop criter: 14.681 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 119 / bw: 3.120 / grad: -5.251 / stop criter: 28.390 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 119 / bw: 3.120 / grad: -5.251 / stop criter: 28.390 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 120 / bw: 3.125 / grad: -3.583 / stop criter: 5.251 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s] * GD progress: iter: 120 / bw: 3.125 / grad: -3.583 / stop criter: 5.251 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 121 / bw: 3.128 / grad: 30.809 / stop criter: 3.583 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 121 / bw: 3.128 / grad: 30.809 / stop criter: 3.583 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 122 / bw: 3.101 / grad: 1.394 / stop criter: 30.809 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 122 / bw: 3.101 / grad: 1.394 / stop criter: 30.809 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 123 / bw: 3.100 / grad: -11.548 / stop criter: 1.394 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 123 / bw: 3.100 / grad: -11.548 / stop criter: 1.394 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 124 / bw: 3.110 / grad: 54.697 / stop criter: 11.548 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 124 / bw: 3.110 / grad: 54.697 / stop criter: 11.548 :  38%|███▊      | 113/300 [00:01&lt;00:01, 103.89it/s]* GD progress: iter: 124 / bw: 3.110 / grad: 54.697 / stop criter: 11.548 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 125 / bw: 3.064 / grad: 32.108 / stop criter: 54.697 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 125 / bw: 3.064 / grad: 32.108 / stop criter: 54.697 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 126 / bw: 3.037 / grad: -6.650 / stop criter: 32.108 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 126 / bw: 3.037 / grad: -6.650 / stop criter: 32.108 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 127 / bw: 3.043 / grad: -10.907 / stop criter: 6.650 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 127 / bw: 3.043 / grad: -10.907 / stop criter: 6.650 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 128 / bw: 3.052 / grad: -1.024 / stop criter: 10.907 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 128 / bw: 3.052 / grad: -1.024 / stop criter: 10.907 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 129 / bw: 3.052 / grad: -44.380 / stop criter: 1.024 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 129 / bw: 3.052 / grad: -44.380 / stop criter: 1.024 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 130 / bw: 3.089 / grad: 20.802 / stop criter: 44.380 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 130 / bw: 3.089 / grad: 20.802 / stop criter: 44.380 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 131 / bw: 3.072 / grad: -3.944 / stop criter: 20.802 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 131 / bw: 3.072 / grad: -3.944 / stop criter: 20.802 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 132 / bw: 3.075 / grad: -30.437 / stop criter: 3.944 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 132 / bw: 3.075 / grad: -30.437 / stop criter: 3.944 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 133 / bw: 3.100 / grad: -3.580 / stop criter: 30.437 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 133 / bw: 3.100 / grad: -3.580 / stop criter: 30.437 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 134 / bw: 3.103 / grad: 1.697 / stop criter: 3.580 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]  * GD progress: iter: 134 / bw: 3.103 / grad: 1.697 / stop criter: 3.580 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 135 / bw: 3.101 / grad: -0.944 / stop criter: 1.697 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 135 / bw: 3.101 / grad: -0.944 / stop criter: 1.697 :  41%|████▏     | 124/300 [00:01&lt;00:01, 103.40it/s]* GD progress: iter: 135 / bw: 3.101 / grad: -0.944 / stop criter: 1.697 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 136 / bw: 3.102 / grad: 0.979 / stop criter: 0.944 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s] * GD progress: iter: 136 / bw: 3.102 / grad: 0.979 / stop criter: 0.944 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 137 / bw: 3.101 / grad: -7.335 / stop criter: 0.979 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 137 / bw: 3.101 / grad: -7.335 / stop criter: 0.979 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 138 / bw: 3.107 / grad: -4.323 / stop criter: 7.335 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 138 / bw: 3.107 / grad: -4.323 / stop criter: 7.335 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 139 / bw: 3.111 / grad: 1.010 / stop criter: 4.323 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s] * GD progress: iter: 139 / bw: 3.111 / grad: 1.010 / stop criter: 4.323 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 140 / bw: 3.110 / grad: 57.737 / stop criter: 1.010 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 140 / bw: 3.110 / grad: 57.737 / stop criter: 1.010 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 141 / bw: 3.065 / grad: -11.760 / stop criter: 57.737 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 141 / bw: 3.065 / grad: -11.760 / stop criter: 57.737 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 142 / bw: 3.074 / grad: 61.032 / stop criter: 11.760 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s] * GD progress: iter: 142 / bw: 3.074 / grad: 61.032 / stop criter: 11.760 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 143 / bw: 3.028 / grad: 24.830 / stop criter: 61.032 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 143 / bw: 3.028 / grad: 24.830 / stop criter: 61.032 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 144 / bw: 3.009 / grad: -4.566 / stop criter: 24.830 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 144 / bw: 3.009 / grad: -4.566 / stop criter: 24.830 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 145 / bw: 3.012 / grad: -1.758 / stop criter: 4.566 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s] * GD progress: iter: 145 / bw: 3.012 / grad: -1.758 / stop criter: 4.566 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 146 / bw: 3.014 / grad: -8.718 / stop criter: 1.758 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 146 / bw: 3.014 / grad: -8.718 / stop criter: 1.758 :  45%|████▌     | 135/300 [00:01&lt;00:01, 102.56it/s]* GD progress: iter: 146 / bw: 3.014 / grad: -8.718 / stop criter: 1.758 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 147 / bw: 3.020 / grad: 27.930 / stop criter: 8.718 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 147 / bw: 3.020 / grad: 27.930 / stop criter: 8.718 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 148 / bw: 2.999 / grad: 26.889 / stop criter: 27.930 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 148 / bw: 2.999 / grad: 26.889 / stop criter: 27.930 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 149 / bw: 2.979 / grad: 6.072 / stop criter: 26.889 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s] * GD progress: iter: 149 / bw: 2.979 / grad: 6.072 / stop criter: 26.889 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 150 / bw: 2.975 / grad: 26.797 / stop criter: 6.072 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 150 / bw: 2.975 / grad: 26.797 / stop criter: 6.072 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 151 / bw: 2.955 / grad: 25.936 / stop criter: 26.797 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 151 / bw: 2.955 / grad: 25.936 / stop criter: 26.797 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 152 / bw: 2.936 / grad: -10.363 / stop criter: 25.936 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 152 / bw: 2.936 / grad: -10.363 / stop criter: 25.936 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 153 / bw: 2.943 / grad: -33.350 / stop criter: 10.363 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 153 / bw: 2.943 / grad: -33.350 / stop criter: 10.363 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 154 / bw: 2.968 / grad: -6.745 / stop criter: 33.350 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s] * GD progress: iter: 154 / bw: 2.968 / grad: -6.745 / stop criter: 33.350 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 155 / bw: 2.973 / grad: -13.657 / stop criter: 6.745 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 155 / bw: 2.973 / grad: -13.657 / stop criter: 6.745 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 156 / bw: 2.983 / grad: -8.670 / stop criter: 13.657 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 156 / bw: 2.983 / grad: -8.670 / stop criter: 13.657 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 157 / bw: 2.989 / grad: 59.700 / stop criter: 8.670 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s] * GD progress: iter: 157 / bw: 2.989 / grad: 59.700 / stop criter: 8.670 :  49%|████▊     | 146/300 [00:01&lt;00:01, 102.15it/s]* GD progress: iter: 157 / bw: 2.989 / grad: 59.700 / stop criter: 8.670 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 158 / bw: 2.945 / grad: -7.384 / stop criter: 59.700 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 158 / bw: 2.945 / grad: -7.384 / stop criter: 59.700 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 159 / bw: 2.951 / grad: 23.538 / stop criter: 7.384 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s] * GD progress: iter: 159 / bw: 2.951 / grad: 23.538 / stop criter: 7.384 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 160 / bw: 2.934 / grad: -5.513 / stop criter: 23.538 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 160 / bw: 2.934 / grad: -5.513 / stop criter: 23.538 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 161 / bw: 2.938 / grad: -6.826 / stop criter: 5.513 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s] * GD progress: iter: 161 / bw: 2.938 / grad: -6.826 / stop criter: 5.513 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 162 / bw: 2.943 / grad: -3.844 / stop criter: 6.826 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 162 / bw: 2.943 / grad: -3.844 / stop criter: 6.826 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 163 / bw: 2.945 / grad: -0.445 / stop criter: 3.844 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 163 / bw: 2.945 / grad: -0.445 / stop criter: 3.844 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 164 / bw: 2.946 / grad: -14.734 / stop criter: 0.445 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 164 / bw: 2.946 / grad: -14.734 / stop criter: 0.445 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 165 / bw: 2.956 / grad: -7.493 / stop criter: 14.734 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 165 / bw: 2.956 / grad: -7.493 / stop criter: 14.734 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 166 / bw: 2.961 / grad: 57.409 / stop criter: 7.493 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s] * GD progress: iter: 166 / bw: 2.961 / grad: 57.409 / stop criter: 7.493 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 167 / bw: 2.921 / grad: -37.853 / stop criter: 57.409 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 167 / bw: 2.921 / grad: -37.853 / stop criter: 57.409 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 168 / bw: 2.947 / grad: -3.525 / stop criter: 37.853 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s] * GD progress: iter: 168 / bw: 2.947 / grad: -3.525 / stop criter: 37.853 :  52%|█████▏    | 157/300 [00:01&lt;00:01, 102.40it/s]* GD progress: iter: 168 / bw: 2.947 / grad: -3.525 / stop criter: 37.853 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 169 / bw: 2.950 / grad: -6.037 / stop criter: 3.525 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s] * GD progress: iter: 169 / bw: 2.950 / grad: -6.037 / stop criter: 3.525 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 170 / bw: 2.954 / grad: -6.144 / stop criter: 6.037 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 170 / bw: 2.954 / grad: -6.144 / stop criter: 6.037 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 171 / bw: 2.958 / grad: 2.829 / stop criter: 6.144 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s] * GD progress: iter: 171 / bw: 2.958 / grad: 2.829 / stop criter: 6.144 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 172 / bw: 2.956 / grad: -13.166 / stop criter: 2.829 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 172 / bw: 2.956 / grad: -13.166 / stop criter: 2.829 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 173 / bw: 2.965 / grad: -31.567 / stop criter: 13.166 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 173 / bw: 2.965 / grad: -31.567 / stop criter: 13.166 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 174 / bw: 2.987 / grad: -8.668 / stop criter: 31.567 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s] * GD progress: iter: 174 / bw: 2.987 / grad: -8.668 / stop criter: 31.567 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 175 / bw: 2.992 / grad: -5.757 / stop criter: 8.668 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s] * GD progress: iter: 175 / bw: 2.992 / grad: -5.757 / stop criter: 8.668 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 176 / bw: 2.996 / grad: -9.521 / stop criter: 5.757 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 176 / bw: 2.996 / grad: -9.521 / stop criter: 5.757 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 177 / bw: 3.003 / grad: -1.507 / stop criter: 9.521 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 177 / bw: 3.003 / grad: -1.507 / stop criter: 9.521 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 178 / bw: 3.004 / grad: -17.168 / stop criter: 1.507 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 178 / bw: 3.004 / grad: -17.168 / stop criter: 1.507 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 179 / bw: 3.015 / grad: -0.378 / stop criter: 17.168 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 179 / bw: 3.015 / grad: -0.378 / stop criter: 17.168 :  56%|█████▌    | 168/300 [00:01&lt;00:01, 104.53it/s]* GD progress: iter: 179 / bw: 3.015 / grad: -0.378 / stop criter: 17.168 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 180 / bw: 3.016 / grad: 21.006 / stop criter: 0.378 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s] * GD progress: iter: 180 / bw: 3.016 / grad: 21.006 / stop criter: 0.378 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 181 / bw: 3.001 / grad: -14.109 / stop criter: 21.006 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 181 / bw: 3.001 / grad: -14.109 / stop criter: 21.006 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 182 / bw: 3.011 / grad: 51.168 / stop criter: 14.109 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s] * GD progress: iter: 182 / bw: 3.011 / grad: 51.168 / stop criter: 14.109 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 183 / bw: 2.977 / grad: 18.023 / stop criter: 51.168 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 183 / bw: 2.977 / grad: 18.023 / stop criter: 51.168 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 184 / bw: 2.965 / grad: 25.204 / stop criter: 18.023 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 184 / bw: 2.965 / grad: 25.204 / stop criter: 18.023 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 185 / bw: 2.948 / grad: 20.153 / stop criter: 25.204 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 185 / bw: 2.948 / grad: 20.153 / stop criter: 25.204 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 186 / bw: 2.935 / grad: -2.164 / stop criter: 20.153 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 186 / bw: 2.935 / grad: -2.164 / stop criter: 20.153 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 187 / bw: 2.937 / grad: -40.907 / stop criter: 2.164 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 187 / bw: 2.937 / grad: -40.907 / stop criter: 2.164 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 188 / bw: 2.963 / grad: 25.319 / stop criter: 40.907 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 188 / bw: 2.963 / grad: 25.319 / stop criter: 40.907 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 189 / bw: 2.947 / grad: 1.081 / stop criter: 25.319 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s] * GD progress: iter: 189 / bw: 2.947 / grad: 1.081 / stop criter: 25.319 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 190 / bw: 2.946 / grad: -13.199 / stop criter: 1.081 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 190 / bw: 2.946 / grad: -13.199 / stop criter: 1.081 :  60%|█████▉    | 179/300 [00:01&lt;00:01, 101.26it/s]* GD progress: iter: 190 / bw: 2.946 / grad: -13.199 / stop criter: 1.081 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 191 / bw: 2.955 / grad: -5.542 / stop criter: 13.199 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 191 / bw: 2.955 / grad: -5.542 / stop criter: 13.199 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 192 / bw: 2.958 / grad: -39.654 / stop criter: 5.542 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 192 / bw: 2.958 / grad: -39.654 / stop criter: 5.542 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 193 / bw: 2.983 / grad: -3.365 / stop criter: 39.654 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 193 / bw: 2.983 / grad: -3.365 / stop criter: 39.654 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 194 / bw: 2.986 / grad: -8.651 / stop criter: 3.365 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s] * GD progress: iter: 194 / bw: 2.986 / grad: -8.651 / stop criter: 3.365 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 195 / bw: 2.991 / grad: 3.881 / stop criter: 8.651 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s] * GD progress: iter: 195 / bw: 2.991 / grad: 3.881 / stop criter: 8.651 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 196 / bw: 2.989 / grad: -1.296 / stop criter: 3.881 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 196 / bw: 2.989 / grad: -1.296 / stop criter: 3.881 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 197 / bw: 2.989 / grad: -33.287 / stop criter: 1.296 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 197 / bw: 2.989 / grad: -33.287 / stop criter: 1.296 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 198 / bw: 3.010 / grad: -45.906 / stop criter: 33.287 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 198 / bw: 3.010 / grad: -45.906 / stop criter: 33.287 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 199 / bw: 3.039 / grad: 54.619 / stop criter: 45.906 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s] * GD progress: iter: 199 / bw: 3.039 / grad: 54.619 / stop criter: 45.906 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 200 / bw: 3.005 / grad: -0.089 / stop criter: 54.619 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 200 / bw: 3.005 / grad: -0.089 / stop criter: 54.619 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 201 / bw: 3.005 / grad: -8.624 / stop criter: 0.089 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s] * GD progress: iter: 201 / bw: 3.005 / grad: -8.624 / stop criter: 0.089 :  63%|██████▎   | 190/300 [00:01&lt;00:01, 100.61it/s]* GD progress: iter: 201 / bw: 3.005 / grad: -8.624 / stop criter: 0.089 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 202 / bw: 3.010 / grad: -6.350 / stop criter: 8.624 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 202 / bw: 3.010 / grad: -6.350 / stop criter: 8.624 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 203 / bw: 3.014 / grad: 26.278 / stop criter: 6.350 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 203 / bw: 3.014 / grad: 26.278 / stop criter: 6.350 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 204 / bw: 2.998 / grad: 24.569 / stop criter: 26.278 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 204 / bw: 2.998 / grad: 24.569 / stop criter: 26.278 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 205 / bw: 2.983 / grad: 25.277 / stop criter: 24.569 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 205 / bw: 2.983 / grad: 25.277 / stop criter: 24.569 :  67%|██████▋   | 201/300 [00:01&lt;00:00, 101.36it/s]* GD progress: iter: 206 / bw: 2.968 / grad: 20.817 / stop criter: 25.277 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 206 / bw: 2.968 / grad: 20.817 / stop criter: 25.277 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 207 / bw: 2.955 / grad: 24.554 / stop criter: 20.817 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 207 / bw: 2.955 / grad: 24.554 / stop criter: 20.817 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 208 / bw: 2.940 / grad: 19.109 / stop criter: 24.554 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 208 / bw: 2.940 / grad: 19.109 / stop criter: 24.554 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 209 / bw: 2.929 / grad: -15.845 / stop criter: 19.109 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 209 / bw: 2.929 / grad: -15.845 / stop criter: 19.109 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 210 / bw: 2.938 / grad: -5.915 / stop criter: 15.845 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s] * GD progress: iter: 210 / bw: 2.938 / grad: -5.915 / stop criter: 15.845 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 211 / bw: 2.942 / grad: -2.419 / stop criter: 5.915 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s] * GD progress: iter: 211 / bw: 2.942 / grad: -2.419 / stop criter: 5.915 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 212 / bw: 2.943 / grad: -10.641 / stop criter: 2.419 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 212 / bw: 2.943 / grad: -10.641 / stop criter: 2.419 :  67%|██████▋   | 201/300 [00:02&lt;00:00, 101.36it/s]* GD progress: iter: 212 / bw: 2.943 / grad: -10.641 / stop criter: 2.419 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 213 / bw: 2.950 / grad: 48.857 / stop criter: 10.641 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 213 / bw: 2.950 / grad: 48.857 / stop criter: 10.641 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 214 / bw: 2.920 / grad: -5.771 / stop criter: 48.857 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 214 / bw: 2.920 / grad: -5.771 / stop criter: 48.857 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 215 / bw: 2.924 / grad: 20.448 / stop criter: 5.771 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s] * GD progress: iter: 215 / bw: 2.924 / grad: 20.448 / stop criter: 5.771 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 216 / bw: 2.912 / grad: -7.204 / stop criter: 20.448 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 216 / bw: 2.912 / grad: -7.204 / stop criter: 20.448 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 217 / bw: 2.916 / grad: -2.864 / stop criter: 7.204 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s] * GD progress: iter: 217 / bw: 2.916 / grad: -2.864 / stop criter: 7.204 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 218 / bw: 2.918 / grad: 28.412 / stop criter: 2.864 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 218 / bw: 2.918 / grad: 28.412 / stop criter: 2.864 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 219 / bw: 2.901 / grad: -7.242 / stop criter: 28.412 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 219 / bw: 2.901 / grad: -7.242 / stop criter: 28.412 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 220 / bw: 2.905 / grad: -3.832 / stop criter: 7.242 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s] * GD progress: iter: 220 / bw: 2.905 / grad: -3.832 / stop criter: 7.242 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 221 / bw: 2.907 / grad: 0.274 / stop criter: 3.832 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s] * GD progress: iter: 221 / bw: 2.907 / grad: 0.274 / stop criter: 3.832 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 222 / bw: 2.907 / grad: 21.556 / stop criter: 0.274 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 222 / bw: 2.907 / grad: 21.556 / stop criter: 0.274 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 223 / bw: 2.895 / grad: -3.513 / stop criter: 21.556 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 223 / bw: 2.895 / grad: -3.513 / stop criter: 21.556 :  71%|███████   | 212/300 [00:02&lt;00:00, 101.29it/s]* GD progress: iter: 223 / bw: 2.895 / grad: -3.513 / stop criter: 21.556 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 224 / bw: 2.897 / grad: -12.907 / stop criter: 3.513 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 224 / bw: 2.897 / grad: -12.907 / stop criter: 3.513 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 225 / bw: 2.904 / grad: 24.020 / stop criter: 12.907 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 225 / bw: 2.904 / grad: 24.020 / stop criter: 12.907 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 226 / bw: 2.891 / grad: 1.648 / stop criter: 24.020 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s] * GD progress: iter: 226 / bw: 2.891 / grad: 1.648 / stop criter: 24.020 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 227 / bw: 2.890 / grad: -8.996 / stop criter: 1.648 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 227 / bw: 2.890 / grad: -8.996 / stop criter: 1.648 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 228 / bw: 2.895 / grad: 21.248 / stop criter: 8.996 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 228 / bw: 2.895 / grad: 21.248 / stop criter: 8.996 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 229 / bw: 2.884 / grad: -15.855 / stop criter: 21.248 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 229 / bw: 2.884 / grad: -15.855 / stop criter: 21.248 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 230 / bw: 2.892 / grad: -6.036 / stop criter: 15.855 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s] * GD progress: iter: 230 / bw: 2.892 / grad: -6.036 / stop criter: 15.855 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 231 / bw: 2.895 / grad: 16.630 / stop criter: 6.036 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s] * GD progress: iter: 231 / bw: 2.895 / grad: 16.630 / stop criter: 6.036 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 232 / bw: 2.886 / grad: 22.213 / stop criter: 16.630 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 232 / bw: 2.886 / grad: 22.213 / stop criter: 16.630 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 233 / bw: 2.875 / grad: -10.361 / stop criter: 22.213 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 233 / bw: 2.875 / grad: -10.361 / stop criter: 22.213 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 234 / bw: 2.880 / grad: -7.821 / stop criter: 10.361 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s] * GD progress: iter: 234 / bw: 2.880 / grad: -7.821 / stop criter: 10.361 :  74%|███████▍  | 223/300 [00:02&lt;00:00, 101.72it/s]* GD progress: iter: 234 / bw: 2.880 / grad: -7.821 / stop criter: 10.361 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s] * GD progress: iter: 235 / bw: 2.884 / grad: 17.664 / stop criter: 7.821 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s] * GD progress: iter: 235 / bw: 2.884 / grad: 17.664 / stop criter: 7.821 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 236 / bw: 2.875 / grad: -5.709 / stop criter: 17.664 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 236 / bw: 2.875 / grad: -5.709 / stop criter: 17.664 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 237 / bw: 2.878 / grad: 79.396 / stop criter: 5.709 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s] * GD progress: iter: 237 / bw: 2.878 / grad: 79.396 / stop criter: 5.709 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 238 / bw: 2.837 / grad: -1.211 / stop criter: 79.396 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 238 / bw: 2.837 / grad: -1.211 / stop criter: 79.396 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 239 / bw: 2.838 / grad: -5.508 / stop criter: 1.211 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s] * GD progress: iter: 239 / bw: 2.838 / grad: -5.508 / stop criter: 1.211 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 240 / bw: 2.841 / grad: -5.462 / stop criter: 5.508 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 240 / bw: 2.841 / grad: -5.462 / stop criter: 5.508 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 241 / bw: 2.843 / grad: 31.827 / stop criter: 5.462 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 241 / bw: 2.843 / grad: 31.827 / stop criter: 5.462 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 242 / bw: 2.828 / grad: -9.849 / stop criter: 31.827 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 242 / bw: 2.828 / grad: -9.849 / stop criter: 31.827 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 243 / bw: 2.832 / grad: -4.160 / stop criter: 9.849 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s] * GD progress: iter: 243 / bw: 2.832 / grad: -4.160 / stop criter: 9.849 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 244 / bw: 2.834 / grad: -21.822 / stop criter: 4.160 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 244 / bw: 2.834 / grad: -21.822 / stop criter: 4.160 :  78%|███████▊  | 234/300 [00:02&lt;00:00, 99.55it/s]* GD progress: iter: 244 / bw: 2.834 / grad: -21.822 / stop criter: 4.160 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 245 / bw: 2.845 / grad: -5.941 / stop criter: 21.822 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 245 / bw: 2.845 / grad: -5.941 / stop criter: 21.822 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 246 / bw: 2.848 / grad: 5.675 / stop criter: 5.941 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]  * GD progress: iter: 246 / bw: 2.848 / grad: 5.675 / stop criter: 5.941 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 247 / bw: 2.845 / grad: -8.252 / stop criter: 5.675 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 247 / bw: 2.845 / grad: -8.252 / stop criter: 5.675 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 248 / bw: 2.849 / grad: -8.240 / stop criter: 8.252 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 248 / bw: 2.849 / grad: -8.240 / stop criter: 8.252 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 249 / bw: 2.853 / grad: -7.004 / stop criter: 8.240 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 249 / bw: 2.853 / grad: -7.004 / stop criter: 8.240 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 250 / bw: 2.857 / grad: -1.720 / stop criter: 7.004 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 250 / bw: 2.857 / grad: -1.720 / stop criter: 7.004 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 251 / bw: 2.857 / grad: 21.885 / stop criter: 1.720 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 251 / bw: 2.857 / grad: 21.885 / stop criter: 1.720 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 252 / bw: 2.847 / grad: 25.218 / stop criter: 21.885 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 252 / bw: 2.847 / grad: 25.218 / stop criter: 21.885 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 253 / bw: 2.835 / grad: 26.650 / stop criter: 25.218 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 253 / bw: 2.835 / grad: 26.650 / stop criter: 25.218 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 254 / bw: 2.822 / grad: -0.594 / stop criter: 26.650 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 254 / bw: 2.822 / grad: -0.594 / stop criter: 26.650 :  81%|████████▏ | 244/300 [00:02&lt;00:00, 99.48it/s]* GD progress: iter: 254 / bw: 2.822 / grad: -0.594 / stop criter: 26.650 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 255 / bw: 2.823 / grad: -3.485 / stop criter: 0.594 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s] * GD progress: iter: 255 / bw: 2.823 / grad: -3.485 / stop criter: 0.594 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 256 / bw: 2.824 / grad: -29.493 / stop criter: 3.485 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 256 / bw: 2.824 / grad: -29.493 / stop criter: 3.485 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 257 / bw: 2.838 / grad: -1.870 / stop criter: 29.493 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 257 / bw: 2.838 / grad: -1.870 / stop criter: 29.493 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 258 / bw: 2.839 / grad: -9.513 / stop criter: 1.870 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s] * GD progress: iter: 258 / bw: 2.839 / grad: -9.513 / stop criter: 1.870 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 259 / bw: 2.843 / grad: 49.963 / stop criter: 9.513 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 259 / bw: 2.843 / grad: 49.963 / stop criter: 9.513 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 260 / bw: 2.820 / grad: -33.763 / stop criter: 49.963 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 260 / bw: 2.820 / grad: -33.763 / stop criter: 49.963 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 261 / bw: 2.836 / grad: -3.710 / stop criter: 33.763 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s] * GD progress: iter: 261 / bw: 2.836 / grad: -3.710 / stop criter: 33.763 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 262 / bw: 2.837 / grad: -0.937 / stop criter: 3.710 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s] * GD progress: iter: 262 / bw: 2.837 / grad: -0.937 / stop criter: 3.710 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 263 / bw: 2.838 / grad: -8.156 / stop criter: 0.937 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 263 / bw: 2.838 / grad: -8.156 / stop criter: 0.937 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 264 / bw: 2.842 / grad: -8.937 / stop criter: 8.156 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 264 / bw: 2.842 / grad: -8.937 / stop criter: 8.156 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 265 / bw: 2.846 / grad: -63.562 / stop criter: 8.937 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 265 / bw: 2.846 / grad: -63.562 / stop criter: 8.937 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 266 / bw: 2.875 / grad: -19.040 / stop criter: 63.562 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 266 / bw: 2.875 / grad: -19.040 / stop criter: 63.562 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 267 / bw: 2.884 / grad: -4.291 / stop criter: 19.040 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s] * GD progress: iter: 267 / bw: 2.884 / grad: -4.291 / stop criter: 19.040 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 268 / bw: 2.886 / grad: 19.363 / stop criter: 4.291 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s] * GD progress: iter: 268 / bw: 2.886 / grad: 19.363 / stop criter: 4.291 :  85%|████████▍ | 254/300 [00:02&lt;00:00, 99.60it/s]* GD progress: iter: 268 / bw: 2.886 / grad: 19.363 / stop criter: 4.291 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 269 / bw: 2.877 / grad: -3.558 / stop criter: 19.363 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 269 / bw: 2.877 / grad: -3.558 / stop criter: 19.363 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 270 / bw: 2.879 / grad: -11.110 / stop criter: 3.558 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 270 / bw: 2.879 / grad: -11.110 / stop criter: 3.558 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 271 / bw: 2.884 / grad: -8.926 / stop criter: 11.110 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 271 / bw: 2.884 / grad: -8.926 / stop criter: 11.110 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 272 / bw: 2.888 / grad: -4.872 / stop criter: 8.926 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s] * GD progress: iter: 272 / bw: 2.888 / grad: -4.872 / stop criter: 8.926 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 273 / bw: 2.890 / grad: -2.997 / stop criter: 4.872 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 273 / bw: 2.890 / grad: -2.997 / stop criter: 4.872 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 274 / bw: 2.891 / grad: -3.376 / stop criter: 2.997 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 274 / bw: 2.891 / grad: -3.376 / stop criter: 2.997 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 275 / bw: 2.893 / grad: -5.353 / stop criter: 3.376 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 275 / bw: 2.893 / grad: -5.353 / stop criter: 3.376 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 276 / bw: 2.895 / grad: 56.448 / stop criter: 5.353 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 276 / bw: 2.895 / grad: 56.448 / stop criter: 5.353 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 277 / bw: 2.870 / grad: 23.717 / stop criter: 56.448 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 277 / bw: 2.870 / grad: 23.717 / stop criter: 56.448 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 278 / bw: 2.859 / grad: -5.234 / stop criter: 23.717 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 278 / bw: 2.859 / grad: -5.234 / stop criter: 23.717 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 279 / bw: 2.861 / grad: -13.604 / stop criter: 5.234 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 279 / bw: 2.861 / grad: -13.604 / stop criter: 5.234 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 280 / bw: 2.867 / grad: -2.976 / stop criter: 13.604 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 280 / bw: 2.867 / grad: -2.976 / stop criter: 13.604 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 281 / bw: 2.869 / grad: -1.777 / stop criter: 2.976 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s] * GD progress: iter: 281 / bw: 2.869 / grad: -1.777 / stop criter: 2.976 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 282 / bw: 2.869 / grad: 23.642 / stop criter: 1.777 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 282 / bw: 2.869 / grad: 23.642 / stop criter: 1.777 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 283 / bw: 2.859 / grad: 50.537 / stop criter: 23.642 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 283 / bw: 2.859 / grad: 50.537 / stop criter: 23.642 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 284 / bw: 2.837 / grad: 8.132 / stop criter: 50.537 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s] * GD progress: iter: 284 / bw: 2.837 / grad: 8.132 / stop criter: 50.537 :  89%|████████▉ | 268/300 [00:02&lt;00:00, 110.99it/s]* GD progress: iter: 284 / bw: 2.837 / grad: 8.132 / stop criter: 50.537 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 285 / bw: 2.833 / grad: -8.142 / stop criter: 8.132 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 285 / bw: 2.833 / grad: -8.142 / stop criter: 8.132 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 286 / bw: 2.837 / grad: 16.118 / stop criter: 8.142 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 286 / bw: 2.837 / grad: 16.118 / stop criter: 8.142 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 287 / bw: 2.830 / grad: -9.630 / stop criter: 16.118 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 287 / bw: 2.830 / grad: -9.630 / stop criter: 16.118 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 288 / bw: 2.834 / grad: -33.427 / stop criter: 9.630 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 288 / bw: 2.834 / grad: -33.427 / stop criter: 9.630 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 289 / bw: 2.848 / grad: 18.917 / stop criter: 33.427 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 289 / bw: 2.848 / grad: 18.917 / stop criter: 33.427 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 290 / bw: 2.840 / grad: -6.932 / stop criter: 18.917 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 290 / bw: 2.840 / grad: -6.932 / stop criter: 18.917 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 291 / bw: 2.843 / grad: -32.365 / stop criter: 6.932 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 291 / bw: 2.843 / grad: -32.365 / stop criter: 6.932 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 292 / bw: 2.856 / grad: -7.011 / stop criter: 32.365 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 292 / bw: 2.856 / grad: -7.011 / stop criter: 32.365 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 293 / bw: 2.859 / grad: 1.471 / stop criter: 7.011 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]  * GD progress: iter: 293 / bw: 2.859 / grad: 1.471 / stop criter: 7.011 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 294 / bw: 2.859 / grad: -34.528 / stop criter: 1.471 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 294 / bw: 2.859 / grad: -34.528 / stop criter: 1.471 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 295 / bw: 2.873 / grad: -7.385 / stop criter: 34.528 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 295 / bw: 2.873 / grad: -7.385 / stop criter: 34.528 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 296 / bw: 2.876 / grad: 19.798 / stop criter: 7.385 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s] * GD progress: iter: 296 / bw: 2.876 / grad: 19.798 / stop criter: 7.385 :  95%|█████████▍| 284/300 [00:02&lt;00:00, 119.42it/s]* GD progress: iter: 296 / bw: 2.876 / grad: 19.798 / stop criter: 7.385 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 297 / bw: 2.868 / grad: -4.752 / stop criter: 19.798 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 297 / bw: 2.868 / grad: -4.752 / stop criter: 19.798 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 298 / bw: 2.870 / grad: -2.388 / stop criter: 4.752 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s] * GD progress: iter: 298 / bw: 2.870 / grad: -2.388 / stop criter: 4.752 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 299 / bw: 2.871 / grad: -4.667 / stop criter: 2.388 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 299 / bw: 2.871 / grad: -4.667 / stop criter: 2.388 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 300 / bw: 2.873 / grad: -5.809 / stop criter: 4.667 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 300 / bw: 2.873 / grad: -5.809 / stop criter: 4.667 :  99%|█████████▊| 296/300 [00:02&lt;00:00, 114.50it/s]* GD progress: iter: 300 / bw: 2.873 / grad: -5.809 / stop criter: 4.667 : 100%|██████████| 300/300 [00:02&lt;00:00, 105.27it/s]</code></pre>
</div>
</div>
<p>Now, let’s compare it to the previous example.</p>
<div id="2317602b" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(gc2_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gc2_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :2.8727792285382594</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="2e23d927-2275-4f19-a6f9-6281758080d9" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2e23d927-2275-4f19-a6f9-6281758080d9")) {                    Plotly.newPlot(                        "2e23d927-2275-4f19-a6f9-6281758080d9",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299],"y":[3.01,3.01,3.01,3.01,3.01,3.022945170256259,3.083446601001147,3.131173281663697,3.1392343745853855,3.1589070896713847,3.175932235567793,3.136307295395715,3.145452855702721,3.1168471081191145,3.117293830324428,3.0777248765669185,3.0455729119722204,3.052345315581666,3.0147138183671642,3.013572344579621,3.0655273272236037,3.0251945331006462,2.9861436996565676,3.025758531721873,2.9927346978616276,2.9973409321919418,3.002843118580375,3.009231010759725,3.0617470446745285,3.0647257977924625,3.06493099622945,3.076061802801405,3.08953535467016,3.0893111734754375,3.0539058992402146,3.0615579979227734,3.080267594203958,3.0906207630184976,3.0867113490749083,3.083755213093269,3.086843219709543,3.135065659318121,3.145099949185651,3.175754369821207,3.1654589126683668,3.1895306367521643,3.1998411499322605,3.20816203309938,3.2332264626368894,3.237487583712525,3.2649760848378637,3.27201463194523,3.3090937370078235,3.315282356599248,3.281927182226323,3.3120808863903743,3.3288497027821107,3.3168999517864597,3.295521837639179,3.292617182637664,3.3179619508250617,3.321329667415719,3.360372174594361,3.376709284154834,3.3663253892853615,3.4187998682896876,3.4025337438216736,3.3835434054861975,3.376083062882336,3.354484139982409,3.3440209254974715,3.3808258952613652,3.3717959927123404,3.407377395628799,3.413950080521717,3.4229866317873077,3.432308792012123,3.4257892182643075,3.4375820338695404,3.4633217962434935,3.4494039788610706,3.428199487301635,3.4596755838487327,3.4661303795017484,3.4771481607192714,3.466903688675818,3.4457359012369952,3.4016574470802285,3.384706838495932,3.3714960485187717,3.3564514359956856,3.3243305084276766,3.3281840726304788,3.3073706200113193,3.357490021412895,3.344730455784591,3.3557418415334856,3.3331888117166257,3.338631409460566,3.3041157885475907,3.249446007101925,3.2702655822097,3.2576643937108543,3.2497946716705295,3.2918918042310334,3.28059960554879,3.2686810789039322,3.258167341684787,3.2432536257693902,3.2278231541702955,3.2092653292099365,3.1905721057623633,3.1912350234779714,3.1814188464755375,3.1698611434793014,3.1741711164130635,3.1578460204695635,3.1450608708882823,3.120336467093968,3.124909213939986,3.127998261839274,3.1014355560521656,3.1002456816535355,3.110102253282546,3.0638819177659657,3.0370209967344564,3.0425843863907485,3.0516179780256323,3.0524663162584953,3.089221925188297,3.071993809066712,3.075227697037657,3.0999338520333155,3.102839813403858,3.1014626427895964,3.1022211978778977,3.10144254074511,3.10721942952366,3.1105903996950937,3.109802764082422,3.0652331057947175,3.0743109186563617,3.027668842483016,3.0088829940442943,3.012337341045266,3.013654457594225,3.0201844170412535,2.999264567540485,2.9793255116330055,2.9748228876749105,2.95495251075137,2.9357198980692236,2.943404442214483,2.9678869119935247,2.97283844075527,2.9828644391479635,2.9892289727131125,2.945402283920549,2.950769094414562,2.9338333328252815,2.937760362030251,2.9425740176146413,2.945284676325083,2.9455981682545325,2.955988316893192,2.961272602971033,2.9207884620232165,2.9472149535850405,2.949651184261836,2.953823439046606,2.9580698167257093,2.9561145152994146,2.9651231904094275,2.986506748865945,2.992378234973723,2.9962776897065924,3.002727139331221,3.003748108757233,3.015377862961142,3.015633623152586,3.001404105031618,3.0108660174382953,2.9768948087062257,2.96504897407964,2.9484832461567696,2.935236979659769,2.9366594997216713,2.963278203208375,2.9468031260209697,2.946106904235609,2.9546094283702544,2.958143863674723,2.983433372166206,2.9855791278576675,2.9910966367306946,2.988621418305325,2.9894398833478486,3.0102463396081514,3.038940771452536,3.0048003581566536,3.004855309168426,3.0101386904045246,3.014028873488752,2.997930348540418,2.9830290920556424,2.967698444521613,2.9550728945171585,2.9401808127412052,2.928590983016431,2.9382008371497252,2.9417527024067183,2.943205198750316,2.9495945167513478,2.9202589703865423,2.9236896590966235,2.911656030536772,2.9158528295652624,2.917504875617099,2.9011174797499466,2.905252729929854,2.9074190515663267,2.907264255401578,2.895200358723685,2.8971666444055018,2.9043180101372084,2.8910099249021597,2.890106100612988,2.8950403163977385,2.8835023557551924,2.892025784885114,2.8952382658931333,2.886387538864802,2.8746836545825456,2.8801426400185908,2.8842221721695034,2.875008398929058,2.8779565728110055,2.837365846224632,2.837978588897916,2.8407386908433945,2.843475662609125,2.827527909889003,2.8324135326152784,2.834456490022054,2.8451732557975618,2.8480908287260185,2.8453038588403885,2.8493159562404826,2.8532821369211496,2.8566534161290327,2.857481443404837,2.8469476883621567,2.8349311714127046,2.822232082418798,2.822515181995394,2.824159008946215,2.8380724821700687,2.8389547981831798,2.843442741343703,2.8198725444280512,2.83564086571051,2.837356136802345,2.837789237419759,2.841560090373611,2.845692133845675,2.875080693559267,2.8838840523330123,2.8858679300351624,2.8769151421980426,2.878543787840004,2.883578189039658,2.8876232008877882,2.8898307928950944,2.8911891260814495,2.8927191893586537,2.8951447836769404,2.869564612012856,2.8589245517612576,2.8612725834657846,2.867314745958059,2.86863645763724,2.8694257373141028,2.858925461175668,2.8367042149808532,2.8331287732975046,2.8367089396973855,2.8296926483333515,2.833842515639424,2.8481036350875826,2.8400328375370036,2.842960840279334,2.8564943905035824,2.859426219916899,2.8588112291296217,2.8731046744534265,2.8761313030045375,2.8680175965015806,2.8699454391787595,2.87090446859565,2.8727792285382594],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,299],"y":[2.8727792285382594,2.8727792285382594],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.5745558457076518,1.3003105981804755,2.026065350653299,2.7518201031261222,3.477574855598946,4.203329608071769,4.929084360544593,5.654839113017416,6.38059386549024,7.1063486179630635,7.8321033704358864,8.55785812290871,9.283612875381534,10.009367627854358,10.73512238032718,11.460877132800004,12.186631885272828,12.912386637745652,13.638141390218475,14.363896142691297],"y":[13.87609880995737,7.718134296319683,6.851237748791658,6.484075253534715,6.290028491863971,6.170693985548236,6.094370845723081,6.047671160747123,6.0225021398025484,6.013186697718078,6.015557948657351,6.026608345778003,6.0441133509983,6.066454706739668,6.092359512037891,6.12090487980473,6.1513287912549455,6.183072083124163,6.215705301971978,6.248872558003788],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[2.8727792285382594],"y":[6.443822369481974],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,2.8727792285382594,2.8727792285382594],"y":[6.443822369481974,6.443822369481974,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2e23d927-2275-4f19-a6f9-6281758080d9');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Compare MSE and MAPE.</p>
<div id="cb9796ce" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span> gc2_fit.predict(X_test1)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test1, y_pred2))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test1, y_pred2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2185872702257307
162.5682850501545</code></pre>
</div>
</div>
<p>Compare <code>qq-plot</code>.</p>
<div id="bd8568db" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gc2_fit.draw_learning_curve(y_test<span class="op">=</span>y_test1, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="6ee48954-3c4a-49d5-a4f1-3581e41e911b" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6ee48954-3c4a-49d5-a4f1-3581e41e911b")) {                    Plotly.newPlot(                        "6ee48954-3c4a-49d5-a4f1-3581e41e911b",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[161.98453107884856,-19.642349269977295,-70.95866830925688,-513.4305734686125,376.28901860417153,246.37746561050812,-75.07386286610365,27.72851717198693,-377.5871701553596,257.07760738495716,-122.96653785645215,-65.16082651128357,141.64132959359938,124.29738166400664,5.777095381823217,-65.51830572682393,403.2697855473508,-205.21462081728262,-221.0733944186946,-26.232642594438584,14.306469272282222,-153.5254858037562,92.90687105481358,285.58784629402896,525.2414942043629,16.509009147223722,-205.32244172993717,-298.4582437257728,135.7522949692444,-50.55476158988831,35.21179579116764,100.2896775329707,82.57257416156118,12.923643858857465,64.78011763663359,11.886937752259612,78.79930716473848,425.6330049917283,-135.95283500593598,25.959455879977053,-205.75379843342523,-275.6566410232009,225.4827531553518,-216.09980989650035,-205.66955748340908,-102.88128419077319,116.48203868407265,-11.504643614922662,122.58350765922881,-41.181802332417504,-156.0997066428271,-76.98647827237602,-82.98144886670083,-303.2444073598339,125.39946333906936,-127.01372084128863,-233.4358178876751,88.79478528614386,-34.33650706970383,-125.99490390797388,135.46365296759188,84.8710272249636,-254.58320040146964,124.54588867759023,437.6212007426331,198.2666838237279,-43.16534770264567,74.18975464544599,-341.0698854299217,-239.5683818314627,45.82237301412757,328.9108084029359,-208.21958575944205,173.31161311069033,-21.442500465320492,200.0771504324218,421.55442398488293,-261.6311935113137,12.967447585826198,33.53833683216276,-50.908480961671,18.08366414004453,60.663718323761465,-39.682930587251754,7.5178003339962,-69.40539209827006,115.83025936861547,-248.0245187928838,170.47123403723793,-4.066582640436843,59.587021557586155,264.31498566520236,48.187123408443796,145.1459043210139,-72.14870832027417,288.0066106822105,263.694922356605,-97.64295266659886,149.85627359446102,-134.81475933503916,178.0613249966957,-104.13411744700642,214.12866198603467,71.43398163596123,120.80615968520347,-272.38870145379155,-126.8592297533438,-109.84920381071603,-92.291147798096,125.802168120044,-332.2062983548123,67.95417598465178,-320.3353362207183,-191.92508445746128,0.5011367769558759,-66.14042040825652,327.40014437953505,6.3488855238395026,43.7184397456342,-319.51767955786244,-7.120286864731714,-7.83864221220574,-190.79404676414376,-125.8008346580403,-420.44062057917563,232.61435721767617,-95.86700296119362,-58.55134609477088,169.45450213474956,76.12337300469821,-278.24301894768047,325.98457969646995,-165.95845711207895,-28.916090963966994,47.94255936775441,70.5790446903269,-228.06969066419651,42.28385226762858,186.39042722720137,-55.651214565932975,43.62148420219755,-199.38296762087543,487.04348332171236,39.63426037055296,-153.07435358723149,-66.93890019801692,296.09717314247933,10.257325753486073,-62.59988906676405,14.985251916691658,409.778429138855,324.7711799846804,125.09633015031004,69.17591007178402,-100.24249587537116,314.83982590228356,-153.0633083326136,192.08695969655204,-123.47610082698444,-25.51945987839035,-245.9124716033357,109.30525591506718,-15.39677629540945,-105.68664132821335,110.32664881080979,-110.09287602692817,-99.6464403435494,78.76746939563996,103.64712185842356,250.29547755996856,323.55735622697983,-28.673121228135038,-204.13842273349525,-53.1643012948656,-122.13006971839224,134.1244588761993,-93.74922598810781,-98.99125019110352,542.9754049177257,256.96999988233813,31.988684382285054,-168.95495991536737,-127.71446802629504,404.14922599578654,-232.65480640197248,-26.534330438614006,-24.776003333978327,78.78529812693371,74.35365552751122,210.11141784727945,-225.73711205625978,19.960375538724243,62.08908938811858,60.3372094515358,110.25224027969907,-223.4856107768001,-174.1810081234299,53.903445955362166,-108.06101177605987,217.7362579175546],"xaxis":"x","y":[161.98453107884856,-19.642349269977295,-70.95866830925688,-513.4305734686125,376.28901860417153,246.37746561050812,-75.07386286610365,27.72851717198693,-377.5871701553596,257.07760738495716,-122.96653785645215,-65.16082651128357,141.64132959359938,124.29738166400664,5.777095381823217,-65.51830572682393,403.2697855473508,-205.21462081728262,-221.0733944186946,-26.232642594438584,14.306469272282222,-153.5254858037562,92.90687105481358,285.58784629402896,525.2414942043629,16.509009147223722,-205.32244172993717,-298.4582437257728,135.7522949692444,-50.55476158988831,35.21179579116764,100.2896775329707,82.57257416156118,12.923643858857465,64.78011763663359,11.886937752259612,78.79930716473848,425.6330049917283,-135.95283500593598,25.959455879977053,-205.75379843342523,-275.6566410232009,225.4827531553518,-216.09980989650035,-205.66955748340908,-102.88128419077319,116.48203868407265,-11.504643614922662,122.58350765922881,-41.181802332417504,-156.0997066428271,-76.98647827237602,-82.98144886670083,-303.2444073598339,125.39946333906936,-127.01372084128863,-233.4358178876751,88.79478528614386,-34.33650706970383,-125.99490390797388,135.46365296759188,84.8710272249636,-254.58320040146964,124.54588867759023,437.6212007426331,198.2666838237279,-43.16534770264567,74.18975464544599,-341.0698854299217,-239.5683818314627,45.82237301412757,328.9108084029359,-208.21958575944205,173.31161311069033,-21.442500465320492,200.0771504324218,421.55442398488293,-261.6311935113137,12.967447585826198,33.53833683216276,-50.908480961671,18.08366414004453,60.663718323761465,-39.682930587251754,7.5178003339962,-69.40539209827006,115.83025936861547,-248.0245187928838,170.47123403723793,-4.066582640436843,59.587021557586155,264.31498566520236,48.187123408443796,145.1459043210139,-72.14870832027417,288.0066106822105,263.694922356605,-97.64295266659886,149.85627359446102,-134.81475933503916,178.0613249966957,-104.13411744700642,214.12866198603467,71.43398163596123,120.80615968520347,-272.38870145379155,-126.8592297533438,-109.84920381071603,-92.291147798096,125.802168120044,-332.2062983548123,67.95417598465178,-320.3353362207183,-191.92508445746128,0.5011367769558759,-66.14042040825652,327.40014437953505,6.3488855238395026,43.7184397456342,-319.51767955786244,-7.120286864731714,-7.83864221220574,-190.79404676414376,-125.8008346580403,-420.44062057917563,232.61435721767617,-95.86700296119362,-58.55134609477088,169.45450213474956,76.12337300469821,-278.24301894768047,325.98457969646995,-165.95845711207895,-28.916090963966994,47.94255936775441,70.5790446903269,-228.06969066419651,42.28385226762858,186.39042722720137,-55.651214565932975,43.62148420219755,-199.38296762087543,487.04348332171236,39.63426037055296,-153.07435358723149,-66.93890019801692,296.09717314247933,10.257325753486073,-62.59988906676405,14.985251916691658,409.778429138855,324.7711799846804,125.09633015031004,69.17591007178402,-100.24249587537116,314.83982590228356,-153.0633083326136,192.08695969655204,-123.47610082698444,-25.51945987839035,-245.9124716033357,109.30525591506718,-15.39677629540945,-105.68664132821335,110.32664881080979,-110.09287602692817,-99.6464403435494,78.76746939563996,103.64712185842356,250.29547755996856,323.55735622697983,-28.673121228135038,-204.13842273349525,-53.1643012948656,-122.13006971839224,134.1244588761993,-93.74922598810781,-98.99125019110352,542.9754049177257,256.96999988233813,31.988684382285054,-168.95495991536737,-127.71446802629504,404.14922599578654,-232.65480640197248,-26.534330438614006,-24.776003333978327,78.78529812693371,74.35365552751122,210.11141784727945,-225.73711205625978,19.960375538724243,62.08908938811858,60.3372094515358,110.25224027969907,-223.4856107768001,-174.1810081234299,53.903445955362166,-108.06101177605987,217.7362579175546],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[159.49381300843734,-20.623728834716392,-79.05326053705492,-551.9833807238812,350.13289026378567,235.47059272627413,-75.0672757320648,22.969384259250738,-376.4738060673261,259.68351880015854,-137.0899010468694,-66.52792208175038,143.06063646639004,111.3199768688201,7.359309742502911,-51.23259269635921,378.3920518201331,-213.9653618406352,-212.22934718490976,-32.33544989853848,14.914398443185249,-150.35181709252691,76.69499655947125,280.75373871123395,582.5915933068883,19.4970579290061,-225.5768426520497,-283.59551971987906,123.18975507701688,-51.985495464450494,49.24983747379586,98.8786505702238,63.9708962080274,16.7605931973072,54.061456948378556,14.197199640315246,86.07055143155014,404.44925297331844,-136.69905410800254,18.869867399458577,-197.88687514485235,-280.0619718830853,227.11424739691267,-205.5163433515207,-199.3780096884191,-96.31390335266012,110.59741399167211,-16.21501199847403,121.77980293211176,-30.072537939681638,-152.9688117588619,-72.89702753319696,-84.79945980426302,-274.36515930692656,130.80462505903705,-125.24139835284356,-226.64416421651785,93.12832085723069,-18.645300318358824,-116.48930737302301,141.45065848134206,80.80726508405505,-246.9728879816242,116.24959611983991,419.09761785799066,204.79741087130995,-42.56460459588699,67.54393242553759,-331.67027451558334,-218.91379738219513,53.244860383730455,320.2990563694569,-202.82524395013093,170.19605172231496,-12.652786102861345,223.87077119345386,405.75195381096034,-252.40964571652714,0.04337249934907702,31.789326678676012,-41.39339580834785,27.69187846397086,77.92837015020531,-15.876091935110102,-19.732187826592654,-68.6326529159941,108.09741944659369,-231.80288126745188,174.6909483842056,-2.094306187573304,55.47862311942054,243.62180509625787,46.108883339813445,155.34538330790622,-67.0150468875971,282.26424620328555,259.7717778539281,-93.65150994929687,140.30238970828594,-142.7071658190931,162.8433452635136,-111.33663042791281,198.6536993769621,75.7817012646042,107.2043160438123,-268.36239813855013,-116.18180240930975,-110.9586567917938,-89.57253959677158,142.8938927296639,-322.84837268762783,68.53831694643526,-307.5667610574528,-195.7016427874631,-7.171643868478241,-83.90654888004832,303.6636230590543,11.475018360593701,48.483680428549526,-317.19160856114894,12.888187322538755,-3.4403409114929056,-185.32423157308972,-131.15507068232537,-397.57142521468813,217.48674084120128,-93.36859619684932,-62.17432638740494,160.14487554829992,90.50750509925948,-265.24399759525653,258.1420017716562,-163.1365719364644,-18.48725120743561,36.23009640548687,58.01250533909591,-239.39394473495963,42.3762434629147,189.2459417173409,-23.400585987594795,52.470377965274395,-214.67825867142403,475.561389744625,34.31192267842064,-168.59692237864547,-72.08280232142026,289.9995792300956,10.854176709364703,-62.313572603840264,17.547858587070774,403.2979491945335,314.9837316169028,118.51136777578628,71.6314086216278,-102.1739340316,318.26173708295863,-143.05259873616131,193.31501232865605,-116.111758347301,-7.99044484414305,-263.13698533347997,99.47241578318408,-2.473149533457585,-97.09556828164685,113.16455526089307,-114.18457619702437,-100.70583319792392,59.758609903883915,98.99451163184517,257.8258407848402,311.00250846396864,-33.409796833693164,-194.4868873050177,-58.05149038471771,-107.83042011461062,133.2894782141223,-93.892916653531,-109.61866927859558,530.2164286998508,240.55314715458428,35.87007388100194,-162.19234366802038,-127.31121885740414,412.896477260943,-220.10144126090287,-14.797032978181045,-27.106077701724722,68.06637255666868,49.10971555364673,203.74714913246873,-220.90331760152205,22.186355906405577,62.37966435345529,77.81602989714585,105.21366088379533,-210.94189193566928,-169.61067420304977,54.653420721604185,-96.8843561155461,204.58297455399057],"xaxis":"x","y":[161.98453107884856,-19.642349269977295,-70.95866830925688,-513.4305734686125,376.28901860417153,246.37746561050812,-75.07386286610365,27.72851717198693,-377.5871701553596,257.07760738495716,-122.96653785645215,-65.16082651128357,141.64132959359938,124.29738166400664,5.777095381823217,-65.51830572682393,403.2697855473508,-205.21462081728262,-221.0733944186946,-26.232642594438584,14.306469272282222,-153.5254858037562,92.90687105481358,285.58784629402896,525.2414942043629,16.509009147223722,-205.32244172993717,-298.4582437257728,135.7522949692444,-50.55476158988831,35.21179579116764,100.2896775329707,82.57257416156118,12.923643858857465,64.78011763663359,11.886937752259612,78.79930716473848,425.6330049917283,-135.95283500593598,25.959455879977053,-205.75379843342523,-275.6566410232009,225.4827531553518,-216.09980989650035,-205.66955748340908,-102.88128419077319,116.48203868407265,-11.504643614922662,122.58350765922881,-41.181802332417504,-156.0997066428271,-76.98647827237602,-82.98144886670083,-303.2444073598339,125.39946333906936,-127.01372084128863,-233.4358178876751,88.79478528614386,-34.33650706970383,-125.99490390797388,135.46365296759188,84.8710272249636,-254.58320040146964,124.54588867759023,437.6212007426331,198.2666838237279,-43.16534770264567,74.18975464544599,-341.0698854299217,-239.5683818314627,45.82237301412757,328.9108084029359,-208.21958575944205,173.31161311069033,-21.442500465320492,200.0771504324218,421.55442398488293,-261.6311935113137,12.967447585826198,33.53833683216276,-50.908480961671,18.08366414004453,60.663718323761465,-39.682930587251754,7.5178003339962,-69.40539209827006,115.83025936861547,-248.0245187928838,170.47123403723793,-4.066582640436843,59.587021557586155,264.31498566520236,48.187123408443796,145.1459043210139,-72.14870832027417,288.0066106822105,263.694922356605,-97.64295266659886,149.85627359446102,-134.81475933503916,178.0613249966957,-104.13411744700642,214.12866198603467,71.43398163596123,120.80615968520347,-272.38870145379155,-126.8592297533438,-109.84920381071603,-92.291147798096,125.802168120044,-332.2062983548123,67.95417598465178,-320.3353362207183,-191.92508445746128,0.5011367769558759,-66.14042040825652,327.40014437953505,6.3488855238395026,43.7184397456342,-319.51767955786244,-7.120286864731714,-7.83864221220574,-190.79404676414376,-125.8008346580403,-420.44062057917563,232.61435721767617,-95.86700296119362,-58.55134609477088,169.45450213474956,76.12337300469821,-278.24301894768047,325.98457969646995,-165.95845711207895,-28.916090963966994,47.94255936775441,70.5790446903269,-228.06969066419651,42.28385226762858,186.39042722720137,-55.651214565932975,43.62148420219755,-199.38296762087543,487.04348332171236,39.63426037055296,-153.07435358723149,-66.93890019801692,296.09717314247933,10.257325753486073,-62.59988906676405,14.985251916691658,409.778429138855,324.7711799846804,125.09633015031004,69.17591007178402,-100.24249587537116,314.83982590228356,-153.0633083326136,192.08695969655204,-123.47610082698444,-25.51945987839035,-245.9124716033357,109.30525591506718,-15.39677629540945,-105.68664132821335,110.32664881080979,-110.09287602692817,-99.6464403435494,78.76746939563996,103.64712185842356,250.29547755996856,323.55735622697983,-28.673121228135038,-204.13842273349525,-53.1643012948656,-122.13006971839224,134.1244588761993,-93.74922598810781,-98.99125019110352,542.9754049177257,256.96999988233813,31.988684382285054,-168.95495991536737,-127.71446802629504,404.14922599578654,-232.65480640197248,-26.534330438614006,-24.776003333978327,78.78529812693371,74.35365552751122,210.11141784727945,-225.73711205625978,19.960375538724243,62.08908938811858,60.3372094515358,110.25224027969907,-223.4856107768001,-174.1810081234299,53.903445955362166,-108.06101177605987,217.7362579175546],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6ee48954-3c4a-49d5-a4f1-3581e41e911b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<hr>
</section>
</section>
<section id="gradientcobra-on-real-dataset" class="level3">
<h3 class="anchored" data-anchor-id="gradientcobra-on-real-dataset"><code>GradientCOBRA</code> on real dataset</h3>
<p>We look at the <a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California</a> housing dataset from <code>sklearn.datasets</code> module. To illustrate the idea, we only work with the first <span class="math inline">\(1000\)</span> observations.</p>
<div id="b5c68c1c" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_california_housing</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> fetch_california_housing()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>X_real, y_real <span class="op">=</span> data[<span class="st">'data'</span>], data[<span class="st">'target'</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>X_train_real, X_test_real, y_train_real, y_test_real <span class="op">=</span> train_test_split(X_real[:<span class="dv">1000</span>,:], y_real[:<span class="dv">1000</span>], test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'shape: x_train = </span><span class="sc">{}</span><span class="st"> , x_train = </span><span class="sc">{}</span><span class="st"> , y_train = </span><span class="sc">{}</span><span class="st"> , y_test = </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(X_train_real.shape, X_test_real.shape, y_train_real.shape, y_test_real.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: x_train = (800, 8) , x_train = (200, 8) , y_train = (800,) , y_test = (200,)</code></pre>
</div>
</div>
<p>We gave some random parameters to the method as follows.</p>
<div id="e11bee80" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gc_real <span class="op">=</span> GradientCOBRA(opt_method<span class="op">=</span><span class="st">"grad"</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                        learning_rate<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                        estimator_list<span class="op">=</span>[<span class="st">'random_forest'</span>, <span class="st">'knn'</span>, <span class="st">'ridge'</span>, <span class="st">'lasso'</span>],</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                        estimator_params<span class="op">=</span>{</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'random_forest'</span> : {<span class="st">'n_estimators'</span>: <span class="dv">300</span>},</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'knn'</span> : {<span class="st">'n_neighbors'</span> : <span class="dv">10</span>}</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>gc_real_fit <span class="op">=</span> gc_real.fit(X_train_real, y_train_real)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: 0.016 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 2.990 / grad: 0.016 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 2.990 / grad: 0.011 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 2.990 / grad: 0.011 / stop criter: 0.016 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 2.984 / grad: 0.002 / stop criter: 0.011 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 2.984 / grad: 0.002 / stop criter: 0.011 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.982 / grad: 0.027 / stop criter: 0.002 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.982 / grad: 0.027 / stop criter: 0.002 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.982 / grad: 0.027 / stop criter: 0.002 :   2%|▏         | 7/300 [00:00&lt;00:03, 76.99it/s]</code></pre>
</div>
</div>
<p>Now, let’s look at the obtained bandwidth and the optimization result.</p>
<div id="755c8b33" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal bandwidth: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(gc_real_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>gc_real_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal bandwidth: 2.965913414265725</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="f69989c3-2718-4fbb-9f63-8e1bdbdc4a5f" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f69989c3-2718-4fbb-9f63-8e1bdbdc4a5f")) {                    Plotly.newPlot(                        "f69989c3-2718-4fbb-9f63-8e1bdbdc4a5f",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6],"y":[2.99,2.99,2.99,2.99,2.99,2.9835390156248125,2.982299394790625],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,6],"y":[2.982299394790625,2.982299394790625],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.593182682853145,1.3424660717202754,2.0917494605874056,2.8410328494545363,3.590316238321667,4.3395996271887975,5.088883016055927,5.838166404923058,6.587449793790189,7.336733182657319,8.08601657152445,8.83529996039158,9.58458334925871,10.33386673812584,11.08315012699297,11.832433515860101,12.581716904727232,13.331000293594363,14.080283682461493,14.829567071328624],"y":[0.22619497418626128,0.1986609945293417,0.19343817766992671,0.1927733543960312,0.1936039086300248,0.19509420078097997,0.19695368126845952,0.1990438649127061,0.20126954710240103,0.2035506231551555,0.20582019349246208,0.20802866168888542,0.21014533804359506,0.21215627176297294,0.21405978031824455,0.2158618515465868,0.217572136106659,0.2192014853179584,0.2207602768921384,0.2222578910540493],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[2.965913414265725],"y":[0.19284283797554633],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,2.965913414265725,2.965913414265725],"y":[0.19284283797554633,0.19284283797554633,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f69989c3-2718-4fbb-9f63-8e1bdbdc4a5f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We look at the numerical and graphical performance.</p>
<div id="d78a2ae3" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>y_pred_real <span class="op">=</span> gc_real_fit.predict(X_test_real)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test_real, y_pred_real))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test_real, y_pred_real))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>gc_real_fit.draw_learning_curve(y_test<span class="op">=</span>y_test_real, fig_type<span class="op">=</span><span class="st">'qq'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1788263339928227
0.2356169878883068</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="8189dcd6-d206-44a4-b505-feb89ee84e0f" class="plotly-graph-div" style="height:650px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8189dcd6-d206-44a4-b505-feb89ee84e0f")) {                    Plotly.newPlot(                        "8189dcd6-d206-44a4-b505-feb89ee84e0f",                        [{"hovertemplate":"y_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","line":{"color":"red","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0.834,2.138,1.823,0.948,1.926,1.133,3.418,1.837,0.808,1.775,1.295,1.906,1.555,2.026,2.711,4.563,1.673,1.86,0.871,2.256,2.345,3.573,1.269,2.596,1.872,1.817,2.185,2.0,1.799,1.856,2.108,3.898,2.057,1.926,3.44,1.576,2.36,0.95,2.917,1.042,3.5,1.089,1.582,2.917,2.195,0.914,2.713,1.554,2.359,1.888,1.216,2.102,2.875,2.418,2.27,0.784,1.375,2.419,1.393,3.333,3.357,1.7,1.095,2.213,0.821,0.923,1.728,4.5,4.153,1.72,0.72,2.698,1.996,1.375,1.597,2.231,2.213,1.827,3.413,2.952,1.039,2.067,2.094,1.079,1.76,4.511,2.825,2.469,3.115,4.833,1.438,1.25,0.828,3.298,1.644,2.735,2.738,3.769,2.969,2.239,3.71,2.431,2.208,2.56,2.535,2.134,2.534,1.286,1.629,1.653,1.607,3.918,2.325,2.611,2.644,3.712,2.356,3.673,3.714,1.479,2.525,2.729,1.128,0.975,1.799,2.422,1.649,2.41,1.599,1.388,3.326,3.33,2.157,2.785,0.807,2.241,2.341,1.582,2.75,1.716,2.536,2.293,2.895,1.567,2.688,1.22,2.19,2.415,3.35,3.686,2.129,1.291,2.989,2.065,2.281,1.833,0.761,1.947,1.987,3.063,0.982,1.325,1.02,1.952,1.643,1.784,0.997,1.932,1.671,1.417,2.489,0.938,1.37,1.875,2.18,0.75,0.797,1.439,1.914,1.809,3.156,3.5,1.094,0.975,1.789,2.292,2.279,2.297,1.514,2.695,2.25,1.775,3.667,1.911,1.161,1.871,3.5,1.817,1.973,1.375],"xaxis":"x","y":[0.834,2.138,1.823,0.948,1.926,1.133,3.418,1.837,0.808,1.775,1.295,1.906,1.555,2.026,2.711,4.563,1.673,1.86,0.871,2.256,2.345,3.573,1.269,2.596,1.872,1.817,2.185,2.0,1.799,1.856,2.108,3.898,2.057,1.926,3.44,1.576,2.36,0.95,2.917,1.042,3.5,1.089,1.582,2.917,2.195,0.914,2.713,1.554,2.359,1.888,1.216,2.102,2.875,2.418,2.27,0.784,1.375,2.419,1.393,3.333,3.357,1.7,1.095,2.213,0.821,0.923,1.728,4.5,4.153,1.72,0.72,2.698,1.996,1.375,1.597,2.231,2.213,1.827,3.413,2.952,1.039,2.067,2.094,1.079,1.76,4.511,2.825,2.469,3.115,4.833,1.438,1.25,0.828,3.298,1.644,2.735,2.738,3.769,2.969,2.239,3.71,2.431,2.208,2.56,2.535,2.134,2.534,1.286,1.629,1.653,1.607,3.918,2.325,2.611,2.644,3.712,2.356,3.673,3.714,1.479,2.525,2.729,1.128,0.975,1.799,2.422,1.649,2.41,1.599,1.388,3.326,3.33,2.157,2.785,0.807,2.241,2.341,1.582,2.75,1.716,2.536,2.293,2.895,1.567,2.688,1.22,2.19,2.415,3.35,3.686,2.129,1.291,2.989,2.065,2.281,1.833,0.761,1.947,1.987,3.063,0.982,1.325,1.02,1.952,1.643,1.784,0.997,1.932,1.671,1.417,2.489,0.938,1.37,1.875,2.18,0.75,0.797,1.439,1.914,1.809,3.156,3.5,1.094,0.975,1.789,2.292,2.279,2.297,1.514,2.695,2.25,1.775,3.667,1.911,1.161,1.871,3.5,1.817,1.973,1.375],"yaxis":"y","type":"scatter"},{"hovertemplate":"y_pred=%{x}\u003cbr\u003ey_test=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[1.2985052930827554,1.8044910534885317,1.7523645130811947,1.095450559121846,1.892833087142388,1.105553162024185,3.2495383304966703,1.9972924668134369,1.962316420733159,1.9634320150909315,1.6678465473005215,2.0540582710281416,1.6140945137946974,1.918725368976816,2.765893791007021,2.8034646547850763,1.3801623776910088,2.1330187848314295,1.0132474443433717,2.0295689995563153,2.2047459370784463,3.8495158987522733,1.7493438390903002,2.9035883233106414,2.004353908883908,2.4118948856289255,1.926482566034553,1.931269693374975,1.8724669631167679,1.8028447052262908,1.8940495609120491,3.42797778591662,1.9826366569250453,1.9538908036734564,3.229736313493142,1.460458577527182,2.0044446394828945,1.4693788247146762,2.1958003548424623,1.1083296586082503,1.912006543652416,1.2459178809775333,1.8576392206717762,2.49613671612734,2.6571194482065885,1.0493705169307177,1.864683832332313,1.3446715232922621,1.8648944061455737,2.2208860649696556,1.542552055213677,1.8829009527850677,1.5016564479547156,2.1788737543001417,2.3573383867294706,1.1130316643431526,1.7502337652207156,2.058736460537738,1.9580576081445797,3.562695016503638,2.0010139168756877,1.7406991529989022,2.123633931003883,2.2150617384095685,1.1511609316763876,1.07528534165377,1.4508305488235667,2.547993271730548,3.096541420122665,1.8291772709465108,1.050326159787103,2.8768801104140023,2.052261304249787,1.8653699398466603,1.8065421595057412,2.4126254001409912,2.225595616650532,1.6864787474503196,2.9313867169524515,3.607465482269208,1.261380871722104,2.24091445842947,1.9792432609338495,1.403864758612854,1.9227507949326446,4.003429325991799,2.821613973545078,2.564673345400428,3.3834337359236426,3.0106426369462773,1.413841154244255,1.4048090385901877,1.464324535807713,3.738939603978643,2.2318246574808005,2.8634653019950917,2.6745242905298907,3.1257686226409573,3.2320631110495226,2.287831466754047,3.2768727694764417,2.252655273767067,1.8893313402330096,2.1480661184598673,2.8040735064355276,2.109907106518927,2.702510472765365,1.1376238341702094,1.6552776076500684,1.8939281007872841,1.8605257967424451,3.3832533458436176,1.9615982336694862,2.4653495788158453,2.5367298526587034,3.2191566038628703,2.260721964514955,3.8859499362770897,2.1924471835659607,1.5769559536093543,2.8367094136769095,2.243471950379677,1.3622318795491535,1.1304200912685733,1.7943350169255279,1.9521492830318683,1.7854859331337207,1.8280600565010472,1.4982791511303957,1.5286852693745265,3.2256566720841926,2.9897974676977728,1.9904256562333227,2.820409513981136,1.696855617508703,2.261914512348187,2.269842617591671,1.8280953351760927,2.9458176430212193,1.9202362526014278,1.8178764372147418,2.608398545587522,2.0387836574057916,1.8001256516963506,1.6083374519289613,1.4193657059114417,1.6853229375988081,2.4861812670285706,3.0110173781104863,3.5885342735296115,2.072015406453049,1.2219836931239072,2.5620328414493465,2.452649451258752,1.7263428339363645,1.7927831477675609,1.591955863311199,1.913164833742787,2.1690428180646335,3.1876142564287977,1.0525030057287061,1.1753821362544175,1.0683497298237608,1.8030135709187447,2.2060291989480527,1.911670221294338,1.441630068426305,1.7895121478375668,1.7645936355615492,1.7490107941367252,2.8372577264287093,1.637837585526747,1.0790689414194683,1.5112493253345347,1.974253329808289,1.0780789005179967,1.1362896062488599,1.822217723950858,2.2223971840928187,1.8492560065729977,2.5129621812813516,1.7104341049624312,1.8292361102602834,1.3153751143564156,1.8372520339208043,2.1319138293212023,2.3723938670501044,2.1861401992696337,2.0594900320662743,2.228879558857064,2.0795814687986436,1.3833361436379326,3.5046822982715753,2.256463335820868,1.8785696304048423,1.9036189646828332,3.809853868869881,1.9179978799319521,1.9120948630254269,1.297733869244723],"xaxis":"x","y":[0.834,2.138,1.823,0.948,1.926,1.133,3.418,1.837,0.808,1.775,1.295,1.906,1.555,2.026,2.711,4.563,1.673,1.86,0.871,2.256,2.345,3.573,1.269,2.596,1.872,1.817,2.185,2.0,1.799,1.856,2.108,3.898,2.057,1.926,3.44,1.576,2.36,0.95,2.917,1.042,3.5,1.089,1.582,2.917,2.195,0.914,2.713,1.554,2.359,1.888,1.216,2.102,2.875,2.418,2.27,0.784,1.375,2.419,1.393,3.333,3.357,1.7,1.095,2.213,0.821,0.923,1.728,4.5,4.153,1.72,0.72,2.698,1.996,1.375,1.597,2.231,2.213,1.827,3.413,2.952,1.039,2.067,2.094,1.079,1.76,4.511,2.825,2.469,3.115,4.833,1.438,1.25,0.828,3.298,1.644,2.735,2.738,3.769,2.969,2.239,3.71,2.431,2.208,2.56,2.535,2.134,2.534,1.286,1.629,1.653,1.607,3.918,2.325,2.611,2.644,3.712,2.356,3.673,3.714,1.479,2.525,2.729,1.128,0.975,1.799,2.422,1.649,2.41,1.599,1.388,3.326,3.33,2.157,2.785,0.807,2.241,2.341,1.582,2.75,1.716,2.536,2.293,2.895,1.567,2.688,1.22,2.19,2.415,3.35,3.686,2.129,1.291,2.989,2.065,2.281,1.833,0.761,1.947,1.987,3.063,0.982,1.325,1.02,1.952,1.643,1.784,0.997,1.932,1.671,1.417,2.489,0.938,1.37,1.875,2.18,0.75,0.797,1.439,1.914,1.809,3.156,3.5,1.094,0.975,1.789,2.292,2.279,2.297,1.514,2.695,2.25,1.775,3.667,1.911,1.161,1.871,3.5,1.817,1.973,1.375],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"QQplot of predicted and actual target","x":0.5,"y":0.925},"width":700,"height":650,"xaxis":{"title":{"text":"Prediction"}},"yaxis":{"title":{"text":"Actual target"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8189dcd6-d206-44a4-b505-feb89ee84e0f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="a-comparison-with-adaboost" class="level3">
<h3 class="anchored" data-anchor-id="a-comparison-with-adaboost">A comparison with <code>Adaboost</code></h3>
<p>We campare the fitted method on <code>California</code> data with Adaboost method.</p>
<div id="b32990be" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> AdaBoostRegressor</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ada <span class="op">=</span> AdaBoostRegressor(n_estimators<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ada_fit <span class="op">=</span> ada.fit(X_train_real, y_train_real)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ada_pred <span class="op">=</span> ada_fit.predict(X_test_real)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test_real, ada_pred))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test_real, ada_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.28230461901894716
0.31522759465126454</code></pre>
</div>
</div>
<hr>
</section>
<section id="pretrained-basic-estimators" class="level3">
<h3 class="anchored" data-anchor-id="pretrained-basic-estimators">Pretrained basic estimators</h3>
<p>An interesting application of consensual aggregation methods is having pretrained estimators from some source, then applying them to other testing data (not necessarily from the same source, having the same inputs is enough). The only requirement is the predictability of the basic estimators on new the observations, and only the predicted features are used in the aggregation. Here, we build pretrained estimators including <code>XGBoost</code> then aggregate it to some <code>sklearn</code> basic estimators.</p>
<p>We first split the training data into two parts: <span class="math inline">\(X_k\)</span> for building basic estimators, and <span class="math inline">\(X_\ell\)</span> for aggregation. We use the constructed estimators to predict the test data and only those predictions are used in the final predictions.</p>
<div id="3afde253" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># X_k and X_l split</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>id_k <span class="op">=</span> np.random.permutation(<span class="bu">range</span>(<span class="bu">len</span>(y_train_real)))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span><span class="bu">int</span>(<span class="fl">.5</span> <span class="op">*</span> <span class="bu">len</span>(y_train_real))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>X_k, X_l, y_k, y_l <span class="op">=</span> X_train_real[id_k[:k],:], X_train_real[id_k[k:],:], y_train_real[id_k[:k]], y_train_real[id_k[k:]]</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Building basic estiators</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>rf_real <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">300</span>).fit(X_k, y_k)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>lm_real <span class="op">=</span> LinearRegression().fit(X_k, y_k)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>knn_real <span class="op">=</span> KNeighborsRegressor(n_neighbors<span class="op">=</span><span class="dv">10</span>).fit(X_k, y_k)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>tr_real <span class="op">=</span> DecisionTreeRegressor(min_samples_leaf<span class="op">=</span><span class="dv">5</span>).fit(X_k, y_k)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># External XGBoost estiator</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>xgb <span class="op">=</span> xgboost.XGBRegressor(n_estimators <span class="op">=</span> <span class="dv">500</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>xgb_real <span class="op">=</span> xgb.fit(X_k, y_k)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># All pretrained estimators</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>basic_estimators <span class="op">=</span> (rf_real, lm_real, knn_real, tr_real, xgb_real)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted features on X_l for aggregation</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>pred_feature_l <span class="op">=</span> np.column_stack([est.predict(X_l) <span class="cf">for</span> est <span class="kw">in</span> basic_estimators])</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted features on Testing data</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>pred_feature_test <span class="op">=</span> np.column_stack([est.predict(X_test_real) <span class="cf">for</span> est <span class="kw">in</span> basic_estimators])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To fit the aggregation method on predicted features (NOT the input data), we have to set argument <code>as_predictions = True</code>. This tells the <code>fit</code> method not to build any basic estimators on the given input (which is already the predictions), and the optimization method is performed directly on <span class="math inline">\(X\)</span>.</p>
<div id="c44ff735" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>gc3_fit <span class="op">=</span> GradientCOBRA(learning_rate<span class="op">=</span><span class="fl">0.01</span>, opt_method<span class="op">=</span><span class="st">"grad"</span>).fit(X<span class="op">=</span>pred_feature_l,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                              y<span class="op">=</span>y_l,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                              as_predictions<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>* GD progress: iter: 1 / bw: 3.000 / grad: 0.019 / stop criter: 1.000 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 1 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 2 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 3 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 4 / bw: 2.990 / grad: 0.019 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 2.990 / grad: 0.021 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 5 / bw: 2.990 / grad: 0.021 / stop criter: 0.019 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 2.979 / grad: -0.010 / stop criter: 0.021 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 6 / bw: 2.979 / grad: -0.010 / stop criter: 0.021 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 7 / bw: 2.984 / grad: 0.002 / stop criter: 0.010 :   0%|          | 0/300 [00:00&lt;?, ?it/s] * GD progress: iter: 7 / bw: 2.984 / grad: 0.002 / stop criter: 0.010 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.983 / grad: 0.041 / stop criter: 0.002 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.983 / grad: 0.041 / stop criter: 0.002 :   0%|          | 0/300 [00:00&lt;?, ?it/s]* GD progress: iter: 8 / bw: 2.983 / grad: 0.041 / stop criter: 0.002 :   3%|▎         | 8/300 [00:00&lt;00:03, 86.43it/s]</code></pre>
</div>
</div>
<p>We look at the optimization algorithm performance.</p>
<div id="d560c0e3" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated bandwidth :"</span> <span class="op">+</span> <span class="bu">str</span>(gc3_fit.optimization_outputs[<span class="st">'opt_bandwidth'</span>]))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>gc3_fit.draw_learning_curve()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated bandwidth :2.962236440290544</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>                            <div id="91aad938-3e43-4a90-b985-f53200f4f253" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("91aad938-3e43-4a90-b985-f53200f4f253")) {                    Plotly.newPlot(                        "91aad938-3e43-4a90-b985-f53200f4f253",                        [{"mode":"lines","name":"Loss","showlegend":false,"x":[0,1,2,3,4,5,6,7],"y":[2.99,2.99,2.99,2.99,2.99,2.978725391443573,2.984208780615296,2.9831861695004234],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red","dash":"dash"},"mode":"lines","name":"Optimal point","showlegend":false,"x":[0,7],"y":[2.9831861695004234,2.9831861695004234],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"blue"},"mode":"lines","name":"Loss","showlegend":false,"x":[0.5924472880581088,1.340801757184141,2.0891562263101733,2.8375106954362055,3.5858651645622377,4.33421963368827,5.082574102814302,5.830928571940334,6.5792830410663665,7.327637510192399,8.075991979318431,8.824346448444464,9.572700917570495,10.321055386696527,11.06940985582256,11.817764324948593,12.566118794074624,13.314473263200655,14.062827732326689,14.81118220145272],"y":[0.2226904829931728,0.19274206628415855,0.1871635258523974,0.18548786733239955,0.18510611486958287,0.1853309333527897,0.18590040396971702,0.18668834937834403,0.18762129695040158,0.1886485905756794,0.18973151397632126,0.19083988152194659,0.19195106051363858,0.19304915617861815,0.1941240370496776,0.1951702436363902,0.19618570880576686,0.19717093845487932,0.1981280834929004,0.19906030028986502],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"red","size":8},"mode":"markers","name":"Optimal point","showlegend":false,"x":[2.962236440290544],"y":[0.18536244901549165],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"red","dash":"dash"},"mode":"lines","showlegend":false,"x":[0.0,2.962236440290544,2.962236440290544],"y":[0.18536244901549165,0.18536244901549165,0.0],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Iteration"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Bandwidth"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Bandwidth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"Error"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Bandwidth at each gradient descent step","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Error vs bandwidth","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"width":1000,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('91aad938-3e43-4a90-b985-f53200f4f253');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Now, let’s look at the result.</p>
<div id="5d79fe4e" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pred_add <span class="op">=</span> gc3_fit.predict(pred_feature_test)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_absolute_percentage_error(y_test_real, pred_add))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test_real, pred_add))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1527194278509763
0.1909836867420075</code></pre>
</div>
</div>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><p><a href="https://jdssv.org/index.php/jdssv/article/view/70">S. Has (2023). A Gradient COBRA: A kernel-based consensual aggregation for regression. Journal of Data Science, Statistics, and Visualisation, 3(2).</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.jmva.2015.04.007">G. Biau, A. Fischer, B. Guedj and J. D. Malley (2016), COBRA: A combined regression strategy, Journal of Multivariate Analysis.</a></p></li>
<li><p><a href="https://www.kaggle.com/datasets/camnugent/california-housing-prices">California Housing Prices</a></p></li>
</ul>
<section id="read-also" class="level3">
<h3 class="anchored" data-anchor-id="read-also">Read also:</h3>
<ul>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/superlearner.html">SuperLearner</a></p></li>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/MixCOBRARegressor.html">MixCOBRARegressor</a></p></li>
<li><p><a href="https://hassothea.github.io/files/CodesPhD/kernelsmoother.html">KernelSmoother</a></p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>